writePropertyInternal(...) delegates to writeInternal by looking up the property's entity metadata. This is perfectly fine as long as the property type and value match. In case the value type is a subtype of the declared property type we rather should use the entity metadata of the value type.