The code posted in the forum looks correct, looks like we are not handling embedded objects correctly for the update case.