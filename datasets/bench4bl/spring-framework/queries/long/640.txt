According to ejb-2.1 specification ejb bean is simply discarded when it throws system exception. This means that ejbRemove will not be called when beans directly transits to "non-existent" state within ejb container.
Unfortunately unloadBeanFactory() is called in ejbRemove() which creates unreliable mechanism for unloading bean factories, because reference counting employed in singleton bean factory will not work correctly.
Possible solution is to choose WeakReference for automatic release of bean factories used in ejb.