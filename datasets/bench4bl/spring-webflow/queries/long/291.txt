A new flow execution key is being incorrectly generated on each flow execution "refresh" operation (triggerable by a flow execution redirect, a browser refresh button click, and possibly even a partial page refresh if the FlowPhaseListener was involved). With a continuation-based repository (the default), this leads to a new continuation snapshot being taken and added. This causes the ContinuationNotFoundException once the number of refresh operations exceeded the maximum number of continuations allowed per conversation (30).
Easily reproducedy by setting max-continuations to "1" and doing a single browser refresh click immediately after launching a flow.
The fix means the same key should used throughout any number of refreshes of the same view, which is the correct behavior. A new key is only assigned after processing a navigation event, which allows a new snapshot to be taken to support going back to the previous view. This revised logic in FlowPhaseListener would be consistent with the logic in FlowExecutorImpl, which is used by the other environments Spring Web Flow runs in.
