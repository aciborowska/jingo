I wrote my custom FlowExecutionListener overriding method stateEntering. If I throw StateEnterVetoException this way:
throw new EnterStateVetoException(context.getFlowExecutionCo ntext().getCurrentState(), nextState, "!!!");
and context.getFlowExecutionContext().getCurrentState( ) = null (when state under evaluation is the start state of a flow for example)
I get a NPE:
java.lang.NullPointerException
org.springframework.webflow.execution.FlowSessionI mpl.writeExternal(FlowSessionImpl.java:170)
java.io.ObjectOutputStream.writeExternalData(Objec tOutputStream.java:1304)
java.io.ObjectOutputStream.writeOrdinaryObject(Obj ectOutputStream.java:1282)
java.io.ObjectOutputStream.writeObject0(ObjectOutp utStream.java:1073)
java.io.ObjectOutputStream.writeArray(ObjectOutput Stream.java:1245)
java.io.ObjectOutputStream.writeObject0(ObjectOutp utStream.java:1069)
java.io.ObjectOutputStream.defaultWriteFields(Obje ctOutputStream.java:1369)
java.io.ObjectOutputStream.defaultWriteObject(Obje ctOutputStream.java:380)
java.util.Vector.writeObject(Vector.java:1018)
sun.reflect.NativeMethodAccessorImpl.invoke0(Nativ e Method)
sun.reflect.NativeMethodAccessorImpl.invoke(Native MethodAccessorImpl.java:39)
sun.reflect.DelegatingMethodAccessorImpl.invoke(De legatingMethodAccessorImpl.java:25)
java.lang.reflect.Method.invoke(Method.java:585)
java.io.ObjectStreamClass.invokeWriteObject(Object StreamClass.java:890)
java.io.ObjectOutputStream.writeSerialData(ObjectO utputStream.java:1333)
java.io.ObjectOutputStream.writeOrdinaryObject(Obj ectOutputStream.java:1284)
java.io.ObjectOutputStream.writeObject0(ObjectOutp utStream.java:1073)
java.io.ObjectOutputStream.writeObject(ObjectOutpu tStream.java:291)
org.springframework.webflow.execution.FlowExecutio nImpl.writeExternal(FlowExecutionImpl.java:551)
java.io.ObjectOutputStream.writeExternalData(Objec tOutputStream.java:1304)
java.io.ObjectOutputStream.writeOrdinaryObject(Obj ectOutputStream.java:1282)
java.io.ObjectOutputStream.writeObject0(ObjectOutp utStream.java:1073)
java.io.ObjectOutputStream.writeObject(ObjectOutpu tStream.java:291)
org.springframework.webflow.execution.FlowExecutio nContinuation.<init>(FlowExecutionContinuation.jav a:74)
org.springframework.webflow.execution.Continuation DataStoreFlowExecutionStorage.setFlowExecution(Con tinuationDataStoreFlowExecutionStorage.java:104)
org.springframework.webflow.execution.DataStoreFlo wExecutionStorage.save(DataStoreFlowExecutionStora ge.java:112)
org.springframework.webflow.execution.FlowExecutio nManager.saveFlowExecution(FlowExecutionManager.ja va:771)
org.springframework.webflow.execution.FlowExecutio nManager.manageStorage(FlowExecutionManager.java:8 32)
org.springframework.webflow.execution.FlowExecutio nManager.onEvent(FlowExecutionManager.java:589)
org.springframework.webflow.mvc.FlowController.han dleRequestInternal(FlowController.java:143)
org.springframework.web.servlet.mvc.AbstractContro ller.handleRequest(AbstractController.java:139)
org.springframework.web.servlet.mvc.SimpleControll erHandlerAdapter.handle(SimpleControllerHandlerAda pter.java:44)
org.springframework.web.servlet.DispatcherServlet. doDispatch(DispatcherServlet.java:717)
org.springframework.web.servlet.DispatcherServlet. doService(DispatcherServlet.java:658)
org.springframework.web.servlet.FrameworkServlet.p rocessRequest(FrameworkServlet.java:392)
org.springframework.web.servlet.FrameworkServlet.d oGet(FrameworkServlet.java:347)
javax.servlet.http.HttpServlet.service(HttpServlet .java:689)
javax.servlet.http.HttpServlet.service(HttpServlet .java:802)