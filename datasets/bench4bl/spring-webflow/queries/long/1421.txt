dojo.require is executed asynchronously. Code that depends on the required module should run inside dojo.addOnLoad() or should have dojo.addOnLoad invoked immediately after it as shown here http://docs.dojocampus.org/dojo/require#id5. Alternatively the dojo.require could be moved further up to the ElementDecoration constructor.