NPE happens if no scope is provided in request filtered by SocialAuthenticationFilter, because it attempts to encode the incoming scope parameter (which is null). Only attempt to add scope parameter if scope parameter is given. Also, only attempt to put default scope if default scope is set.