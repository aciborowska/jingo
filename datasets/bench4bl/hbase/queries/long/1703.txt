We noticed a bug whereby the value in a hbase ICV'ed counter was lower, and the bug turned out to be that during a flush, the ICV will grab the KeyValue from 'memcache' and reuse the timestamp... if we grab the KeyValue from the snapshot we end up with 2 key values, one in memcache, one in a hfile, both with the same timestamp, but one with a lower value than the other.
The fix is to not reuse timestamps if they come out of the snapshot.