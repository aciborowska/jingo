The existing code is not just messy but also contains a subtle bug of visibility due to missing synchronization between threads.
The root of the evil is that ZooKeeper uses a silly anti-pattern, starting a thread within its constructor, and in practice all the developers are not allowed to use ZooKeeper correctly without tedious code.