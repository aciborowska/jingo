The script is case sensitive and fails when case of a host name being unloaded does not match with a case of a region server name returned by HBase API. 
This doc clarifies IETF rules on case insensitivities in DNS:
https://www.ietf.org/rfc/rfc4343.txt