Metthod flushCommits clears the write buffer in a finally clause.
When using the write buffer, if the call to processBatchOfRows done in flushCommits throws an exception, the write buffer will be cleared thus potentially leading to loss of data on the client side.