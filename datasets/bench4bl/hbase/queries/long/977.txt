While looking at another issue, I tripped over a weird HStoreKey Comparator bug.  The bug would throw us to wrong side during our binary search and we'd return null for a key in a mapfile even though the wanted key is present.
It happens when we do our trick with the BeforeThisHStoreKey in mapfiles; i.e. return the key before this one but NOT this one.