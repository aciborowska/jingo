The scanner used for compaction doesn't limit the number of columns retrieved when doing a compaction. If a row exists with tens of millions of rows it can fill all available memory and crash the region server. 
It would be better if the scanner could page through the columns of wide rows when performing a compaction. 