TableMap and TableReduce should be generic, and TableOutputCollector should be no more.