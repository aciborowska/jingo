There is a race condition in TestTableMapReduce, TestTableIndex and TestTableJoinMapReduce that sometimes causes the tests to fail when they verify the results. If the scanner is opened before all the writes to the table complete, the results will not be seen by the scanner because it snapshots the memcache as of the time it is instantiated.