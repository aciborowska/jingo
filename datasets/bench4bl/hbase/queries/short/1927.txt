Scanners not closed properly in certain circumstances (memory leak)