convenience functions in Scan and the thrift API along with a few other bug fixes