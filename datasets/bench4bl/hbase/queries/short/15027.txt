Refactor the way the CompactedHFileDischarger threads are created