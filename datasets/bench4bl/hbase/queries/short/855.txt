compaction can return less versions then we should in some cases