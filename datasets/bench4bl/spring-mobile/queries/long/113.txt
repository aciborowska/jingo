The formatPath(String path) method in the AbstractSitePathUrlFactory class doesn't handle an empty path (empty String) correctly. It will return "//" (two slashes), instead of just one.
The error seems to be on line 197, where it should check if formattedPath ends with a slash, instead of path.