At times SecurityContextChannelInterceptor may be invoked in a Thread that already contains a SecurityContext on the SecurityContextHolder (i.e. xhr_stream). Currently, SecurityContextChannelInterceptor always clears the SecurityContextHolder.
Instead, the SecurityContextHolder should be restored to the original value (or cleared if it was empty).