Apparently when injecting custom UserDetailsService is still using the default one. It authenticates with custom in first place and then with default. This last authentication could be big trouble if the database structure would be altered. 