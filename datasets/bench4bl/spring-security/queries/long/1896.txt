The org.springframework.security:spring-security-core:3.1.0.RELEASE Maven artifact contains the org.springframework.security.crypto package and also defines a compile time dependency to the org.springframework.security:spring-security-cryto:3.1.0.RELEASE Maven artifact which also contains the org.springframework.security.crypto package. As a result, the classpath contains the org.springframework.security.crypto classes twice. The dependency from org.springframework.security:spring-security-core to org.springframework.security:spring-security-cryto should either be removed or the scope should be set to optional.