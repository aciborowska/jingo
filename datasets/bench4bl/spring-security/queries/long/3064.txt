In the class DefaultOAuth2RequestFactory, the method checkUserScopes is comparing client scopes against client authorities, and i think that would be more reasonable comparing against user's authorities instead.   