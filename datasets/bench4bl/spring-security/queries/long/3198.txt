The public method getRemoteUser tries to return auth.getPrincipal().toString() but there is no guarantee that the principal which is an arbitrary implementation will acttually return the remote user. The assumption that it does is wrong. Since Authentication implements Principal, it would be the safest bet to return auth.getName() which is by interface guaranteed to be a proper name.