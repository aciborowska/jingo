TokenBasedRememberMeServices attempts to obtain the user's password from the Authentication object, after it has been erased by the ProviderManager, meaning that remember-me won't work. It will probably need to load it from the UserDetailsService when the password isn't directly available.