Pre-authentication fails when using check for principal change and using non String principals