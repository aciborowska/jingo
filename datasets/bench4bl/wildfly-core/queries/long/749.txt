getProcessType(ServerEnvironment serverEnvironment) is missing SELF_CONTAINED, so will return ProcessType.EMBEDDED in this case.