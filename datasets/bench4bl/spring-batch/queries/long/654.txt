When the commit operation fails in an ItemOrientedStep, the writing of the Spring Batch metadata fails (trying to write the rollback information). 
When trying to commit the transaction, SB has already set the information it's about to persist in the StepExecutionContext. Then, in another transaction, SB wants to store that a rollback ocurred. Nevertheless, SB hasn't read the current persisted state from the database, so it still has the Version it read when trying to commit. That's why we think it fails.
Furthermore, even if it succeeded, the persisted information wouldn't be accurate, because, as I've pointed out, the StepExecutionContext hasn't been reset.