map daos need to be truly transactional for correct restart