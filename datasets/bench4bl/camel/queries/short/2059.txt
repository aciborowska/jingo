Creating a transacted pipeline with custom error handling is difficult