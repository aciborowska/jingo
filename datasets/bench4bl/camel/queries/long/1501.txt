In case some mail servers throws exception for isConnected test. We should better cater for that with a try .. catch and re connect in case of exception.