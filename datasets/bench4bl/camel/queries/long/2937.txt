Since the stream could be System.out or System.err, the producer does not close the stream ever. It should close all streams with the noted exceptions.