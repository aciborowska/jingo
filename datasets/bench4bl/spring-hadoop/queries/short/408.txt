DatasetTemplate doesn't close writer if exception is thrown