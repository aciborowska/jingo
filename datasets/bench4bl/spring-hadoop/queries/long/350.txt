We should always get accurate partitioning by a bucket size. With java a simple modulo doesn't work with negative values so this needs to be adjusted accordingly.