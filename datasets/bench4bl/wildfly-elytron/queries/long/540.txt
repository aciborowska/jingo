In method isSamePrincipal(final Principal principal) of org.wildfly.security.auth.server.ServerAuthenticationContext.NameAssignedState null value can be assigned to variable name. It can result to NPE when null value is passed to following isSameName method. Check whether name is not null should be added before isSameName(name) calling.