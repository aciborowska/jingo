There are a number of uses of String(byte[]) which assume the platform default charset is ASCII-derived.  These need to be changed to specify StandardCharsets.UTF_8 as the second method argument.