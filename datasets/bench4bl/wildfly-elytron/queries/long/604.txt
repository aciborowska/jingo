Preserve order the way the JDK does: query the factories one by one.