Correct behaviour of this method relied on the broken behaviour of "shuffle".
With a fixed "shuffle", the "nextSample()" unit test caught the bug in this method.