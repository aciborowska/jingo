In "LeastSquaresFactory.java" at line 487, a cast is performed that will fail when the "model" argument is not instantiated with the "model" method (defined at line 278).
A fix could consist in the methods defined in (currently internal, line 291) class "LocalMultivariateJacobianFunction" becoming part of the public API, in an extension of the "MultivariateJacobianFunction" interface.
The contructor of "LocalLeastSquaresProblem" (at line 371) should then throw an exception if lazy evaluation is requested but the "model" does not implement the appropriate interface.