[math] Improve performance, flexibility of discovery impl