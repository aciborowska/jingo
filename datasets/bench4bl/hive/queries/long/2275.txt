HIVE-2219 applied an incorrect patch that fails unit tests.  This patch reverts those changes and adds the intended changes to improve the efficiency of dropping multiple partitions.