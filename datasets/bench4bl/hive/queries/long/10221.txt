HIVE-10172 fixes the performance regression, while the SearchArgument implementation should not be tied to the specifics of the format.
The only source of incompatibility seems to be the explicit casting for Integer columns to Long.