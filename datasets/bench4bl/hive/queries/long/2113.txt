In Driver.execute(), if exception is thrown in prehooks, the execution jumps to the exception handling logic and skips the step of ctx.restoreOriginalTracker(). As a result, the next query will be executed as local mode no matter input size since the job tracker setting is not reverted.