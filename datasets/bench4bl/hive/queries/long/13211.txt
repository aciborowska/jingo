There are multiple subtly different paths in Hive.get(...) methods. Some close the old db on refresh, some don't. Some check if the client is compatible with config, some don't. Also there were some parameters (don't register functions, disallow embedded metastore) that were added recently.
Need to make this stuff go thru one path.