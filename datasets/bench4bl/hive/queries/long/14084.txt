HIVE-13985 backport for branch-1 caused regression reverting some changes from HIVE-11928 (protobuf message size exceeding 64MB when reading footer and metadata)