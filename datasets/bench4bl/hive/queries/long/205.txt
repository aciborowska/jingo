a query like "SELECT * FROM (SELECT 'a' from table UNION ALL SELECT 'b' from table) c" will fail, because the 2 sub queries of "UNION" will be executed inside the same mapper (because the input is the same) towards the same destination table, and the 2 file sink operators will have the same output file name.
We need to append the file sink operator id to the file name to make it unique.