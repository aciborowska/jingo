Currently, we rely on denied partitions to get partition data. If a partitioned table does not have any partition, it will fail.
Therefore, get the partition metadata from the table object in that case.