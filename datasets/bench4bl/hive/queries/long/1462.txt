HIVE-1403 fixes the issue of timing out issue when closing too many files but it doesn't cover the case that files are under different directories. For the case of dynamic partitioning, it is usually the case so that we still get time-out.