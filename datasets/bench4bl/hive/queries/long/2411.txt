When metastore server is launching it first calls new HMSHandler() even before it has done a login. That results in createDefaultDB() gets called which then results in getFileSystem() calls which tries to create a connection to NN and then it fails since NN cannot authenticate metastore.