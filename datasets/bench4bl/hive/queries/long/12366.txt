Currently there is a gap between the time locks acquisition and the first heartbeat being sent out. Normally the gap is negligible, but when it's big it will cause query fail since the locks are timed out by the time the heartbeat is sent.
Need to remove this gap.