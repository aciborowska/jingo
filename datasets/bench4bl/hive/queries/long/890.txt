This is particularly highlighted when running hive out of svn against cloudera's install of hadoop, which puts the libraries in a funky place.
The attached patch queries hadoop to find out what it's version is, instead of asking the libraries what version they have in their string.