Currently calcite optimization rules rely on (Hive)SemiJoin to represent semi join node, whereas Stats estimate use leftSemiJoin field of Join to estimate stats. As a result semi-join specific stats calculation logic is never hit since at plan generation time HiveSemiJoin is created and leftSemiJoin field of Join is never set.