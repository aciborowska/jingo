When a query is cancelled either via Beeline (Ctrl-C) or API call TCLIService.Client.CancelOperation, SQLOperation.cancel is invoked in a different thread from that running the query to close/destroy its encapsulated Driver object. Both SQLOperation and Driver are not thread-safe which could sometimes result in Runtime exceptions like NPE. The errors from the running query are not handled properly therefore probably causing some stuffs (files, locks etc) not being cleaned after the query termination.