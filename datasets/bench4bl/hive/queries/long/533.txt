in the following query, all predicates except the rand() is pushed down where in rand() is applied after filter which should not be the case.
select a.* from srcpart a where rand(1) < 0.1 and a.ds = '2008-04-08' and not(key > 50 or key < 10) and a.hr like '%2';