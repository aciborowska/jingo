The Hive Server's getSchema() function will return a schema with zero fields when executing an "Explain..." query. A quick fix might be to set the default schema to be exactly one column of type string.