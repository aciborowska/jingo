Optimize join + gby into semijoin