Map side aggregation is extremely slow