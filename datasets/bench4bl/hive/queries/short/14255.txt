Backport part of HIVE-12950 to fix "Can not create Path from an emtpy string" exception