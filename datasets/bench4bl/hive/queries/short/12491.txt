Improve ndv heuristic for functions