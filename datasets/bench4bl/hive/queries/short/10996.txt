Aggregation / Projection over Multi-Join Inner Query producing incorrect results