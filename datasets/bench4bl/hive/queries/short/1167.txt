Use TreeMap instead of Property to make explain extended deterministic