View with union type and UDF to `cast` the struct is broken