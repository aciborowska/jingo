sampling in a subquery is broken