Left join query plan outputs  wrong column when using subquery