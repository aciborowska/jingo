Map-side aggregate with DISTINCT generates bad intermediate table