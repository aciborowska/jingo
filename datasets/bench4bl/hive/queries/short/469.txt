empty files are not handled properly 