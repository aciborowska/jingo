fix sampling in subquery for real