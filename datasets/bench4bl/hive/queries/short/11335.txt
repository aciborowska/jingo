Multi-Join Inner Query producing incorrect results