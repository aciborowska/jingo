Add test coverage for external table data loss issue