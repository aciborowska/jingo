outer join gets some duplicate rows in some scenarios