Fix connection leak in ORC RecordReader and refactor for unit testing