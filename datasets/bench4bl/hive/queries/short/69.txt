genMapRedTasks does not use the tree walker and uses implicit state which makes it difficult to enhance