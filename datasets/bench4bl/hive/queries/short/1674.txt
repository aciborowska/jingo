count(*) returns wrong result when a mapper returns empty results