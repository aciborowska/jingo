If  a client is not registered for auth code grant type it should fail early (as things stand a client_credentials client is able to get the auth code, and only the token acquisition fails).