There should probably be a custom AuthenticationFailureHandler to process failed authentication attempts and render out the correct responses. It should likely use HttpMessageConverters in some way so that both JSON and XML responses will work.