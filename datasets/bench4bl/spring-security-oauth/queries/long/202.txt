Password encoders cause problems with untrusted clients.  Basically you get a 500 error when you would like a 401 or 403.  We can fix it by allowing user sto inject a PasswordEncoder into the ClientDetailsUserDetailsService.