Count query with group by returns wrong result