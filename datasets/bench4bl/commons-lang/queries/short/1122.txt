Inconsistent behavior of swap for malformed inputs