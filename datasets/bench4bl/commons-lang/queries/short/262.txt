Use of enum prevents a classloader from being garbage collected resuling in out of memory exceptions.