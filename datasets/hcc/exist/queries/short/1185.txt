ClassCastException with Partial Function Application