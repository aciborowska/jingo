Type arguments not correct with class hierarchy