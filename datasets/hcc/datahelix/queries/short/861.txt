Partitioning not working when ran in random mode