TableFunctionCollector should handle the life cycle of ScalarFunction