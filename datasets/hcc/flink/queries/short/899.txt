Fix data sources and data sinks with splits #766