UNNEST causes cyclic type checking exception