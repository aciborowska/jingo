Protect initializeState() and open() by the same lock.