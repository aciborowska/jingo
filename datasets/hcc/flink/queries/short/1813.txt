Barrier broadcast sometimes causes illegal state exception in source RecordWriter