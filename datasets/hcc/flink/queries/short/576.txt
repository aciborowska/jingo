Fixes for ReduceFunction and some clean-up (new JavaAPI)