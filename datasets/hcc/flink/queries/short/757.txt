Multiple Aggregations producing wrong result