Access to pendingFilesPerCheckpoint should be synchronized