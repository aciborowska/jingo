Streaming sql with nested GROUP BY got wrong results