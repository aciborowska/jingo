Support NOT patterns with preceding OPTIONALS