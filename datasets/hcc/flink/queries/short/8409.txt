Race condition in KafkaConsumerThread leads to potential NPE