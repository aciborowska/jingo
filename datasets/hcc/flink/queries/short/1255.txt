Problems with generic types in Scala API