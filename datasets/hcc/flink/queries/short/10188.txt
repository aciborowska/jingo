Solve nondeterministic functions problem for retraction