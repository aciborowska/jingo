Files.list has the unfortunate property that is has to be explicitly closed to cleanup the underlying DirectoryStream. This is not done automatically by collectors.

Several tests don't close the stream.