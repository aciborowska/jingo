We should use UserCodeClassLoaderÂ when new a RuntimeUDFContext.

i.e., Change the code from


this.classLoader = getClass().getClassLoader();

new RuntimeUDFContext(taskInfo, classLoader, executionConfig, cachedFiles, accumulators, metrics)


to


new RuntimeUDFContext(taskInfo, Thread.currentThread().getContextClassLoader, executionConfig, cachedFiles, accumulators, metrics)


in CollectionExecutor.

FYI. This is a problem reported from the user mailing list.