If DynamoDBStreamsSchema is used as the deserializer for FlinkDynamoDBStreamsConsumer, an exception occurs during deserialization of a record. The stack trace is attached.

 

This is a blocker for using DynamoDBStreamsSchema, but can be worked around by implementing a custom deserializer. The issue appears to be due to the usage of vanilla ObjectMapper:

 


private static final ObjectMapper MAPPER = new ObjectMapper();


When it should be using the appropriate mix-ins offered by the dynamodb stream adapter library:


private static final ObjectMapper MAPPER = new RecordObjectMapper();


This appears to resolve the issue, I tested by using my own deserializer implementation.

 