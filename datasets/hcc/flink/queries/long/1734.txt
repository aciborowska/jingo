For a simple Gelly job running in a 3GB heap only ~130 MB are allocated to the internal hash table. This causes to job to fail while loading the input data for even moderately sized problems. For smaller heaps the fraction allocated becomes even smaller.

The code and data to reproduce this behavior were posted on the user mailing list:
http://apache-flink-incubator-user-mailing-list-archive.2336050.n4.nabble.com/RuntimeException-Gelly-API-Memory-ran-out-Compaction-failed-td866.html