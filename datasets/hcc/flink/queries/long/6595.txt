We found out that the group windows cannot be applied with nested queries out-of-the-box:


SELECT * FROM (
  (SELECT ...)
UNION ALL)
  (SELECT ...)
) GROUP BY foo, TUMBLE(proctime, ...)



Flink complains about proctime is undefined.