In FileInputFormat::decorateInputStream (flink.api.common.io), if the inputStream gets wrapped by an InputStreamFSInputWrapper, it will never get closed. FileInputFormat does call close() on its stream, but the wrapper does not implement close() to forward this call to the wrapped stream. This leads to a resource leak which can eventually exhaust the maximum number of open file handles allowed if processing a lot of input files.