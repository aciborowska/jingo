The below code will throw exception in cluster mode , but not in local mode or when checkpoint disabled.

 


package com.test

import org.apache.flink.streaming.api.scala._
import org.apache.flink.table.api.EnvironmentSettings
import org.apache.flink.table.api.scala.{StreamTableEnvironment, _}
import org.apache.flink.types.Row

case class Test(int:Int)
object Main {
  def main(args: Array[String]) {
    val env = StreamExecutionEnvironment.getExecutionEnvironment
      .enableCheckpointing(32 * 1000)

    val settings = EnvironmentSettings.newInstance()
      .useBlinkPlanner()
      .inStreamingMode().build()
    val tableEnv = StreamTableEnvironment.create(env, settings)

    tableEnv.createTemporaryView("test", env.fromCollection(List(Test(1))))
    val deviceSchemaTable = tableEnv.from("test")
    deviceSchemaTable.toRetractStream[Row]
        .print()
  env.execute("test")
 }
}


 

 