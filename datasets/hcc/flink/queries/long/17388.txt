val tableA = tableEnv.sqlQuery("select custom_func(a) as a, custom_func(b) as b from tableS")

tableEnv.registerTable("tableA", tableA)

val tableB = tableEnv.sqlQuery("select ROW(a, b) as body from tableA")

tableEnv.registerTable("tableB", tableB)

val tableC = tableEnv.sqlQuery("select body.a, body.b from tableB")

In this logic, the custom_func is executed four times

tableC === select Row(custom_func(a) as a, custom_func(b) as b).a, Row(custom_func(a) as a, custom_func(b) as b).b from tableS