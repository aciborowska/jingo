Query:


SELECT *
FROM Ticker
MATCH_RECOGNIZE (
  PARTITION BY symbol, price
  ORDER BY proctime
  MEASURES
    A.symbol AS symbol,
    A.price AS price
  PATTERN (A)
  DEFINE
    A AS symbol = 'a'
) AS T



throws a cryptic exception from the code generation stack that the output arity is wrong. We should add early validation and throw a meaningful exception. 

I've also created a calcite ticket to fix it on calcite's side: CALCITE-2747