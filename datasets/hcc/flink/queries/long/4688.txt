When optimizing a plan with many operators (more than 250), the optimizer gets stuck for hours.

A user reported this problem on the user@f.a.o list [1] and provided stacktraces taken at different points in time (shortly after submission, 32 minutes and 76 minutes after submission) (see attachments).

The stacktraces show deeply recursive hasDamOnPathDownTo() calls. Maybe it is possible to improve the performance by caching the results?

[1] http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Complex-batch-workflow-needs-too-much-time-to-create-executionPlan-tp8596.html