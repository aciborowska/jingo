The following program reproduces the issue.


    Configuration configuration = GlobalConfiguration.loadConfiguration();
    configuration.set(DeploymentOptions.TARGET, RemoteExecutor.NAME);
    StreamExecutionEnvironment streamEnv = new StreamExecutionEnvironment(configuration);

    DataStream dataStream = streamEnv.fromCollection(Arrays.asList(1,2,3));
    dataStream.writeAsText("hdfs://localhost:8020/tmp/output");

    streamEnv.execute();


The job will fail with the follow error, even though the output path doesn't exist before job submission:

org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.fs.FileAlreadyExistsException): /tmp/output already exists as a directory

