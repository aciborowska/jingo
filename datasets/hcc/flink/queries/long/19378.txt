Steps to reproduce:

Shell A: 
1. export HADOOP_CLASSPATH
2. start YARN session

Shell B
(unset HADOOP_CLASSPATH if it is set automatically)
3. start a Flink job using ./bin/flink run.

It will fail with Connection refused: localhost/127.0.0.1:8081.
Expected behavior: connect to YARN cluster using YARN properties file.

Workaround: set HADOOP_CLASSPATH, then the client will find the properties file.