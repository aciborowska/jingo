I am trying to read some ORC data from HDFS as given the example here: https://ci.apache.org/projects/flink/flink-docs-release-1.10/api/java/org/apache/flink/orc/OrcTableSource.html

When I try to do this, the job crashes with NullPointerException:


 


Caused by: java.lang.NullPointerException at org.apache.flink.orc.shim.OrcShimV200.computeProjectionMask(OrcShimV200.java:188) at org.apache.flink.orc.shim.OrcShimV200.createRecordReader(OrcShimV200.java:120) 

 

I have attached a minimal version of code which can reproduce the issue. The same piece of code (and more complex) runs fine on flink 1.8.2

I have tried to look what is causing it and it seems that the NullPointerException happens on this line: [https://github.com/apache/flink/blob/release-1.10/flink-formats/flink-orc/src/main/java/org/apache/flink/orc/shim/OrcShimV200.java#L188

]