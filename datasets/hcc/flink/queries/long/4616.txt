Kafka consumers stores in state only kafka offsets and doesn't store last emmited watermarks, this may go to wrong state when checkpoint is restored:

Let's say our watermark is (timestamp - 10) and in case we have the following messages queue results will be different after checkpoint restore and during normal processing:

A(ts = 30)
B(ts = 35)
------ checkpoint goes here
C(ts=15) â€“ this one should be filtered by next time window
D(ts=60)