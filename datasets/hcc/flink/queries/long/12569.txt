I was reading through the release notes of Flink 1.8.0 and found out that we are no more releasing binaries for specific version of hadoop (https://issues.apache.org/jira/browse/FLINK-11266).

Because of these changes the docker build script for job cluster docker image is failing when supplied CLI arguments for specific version of flink, hadoop, and scala (because no such file exists on the remote location "https://archive.apache.org/dist/flink/flink-${FLINK_VERSION}/${FLINK_DIST_FILE_NAME}").

Following is the location of source : https://github.com/apache/flink/tree/release-1.8/flink-container/docker

Following is the failure I received 


Step 11/16 : RUN set -x && ln -s $FLINK_INSTALL_PATH/flink-* $FLINK_HOME && ln -s $FLINK_INSTALL_PATH/job.jar $FLINK_LIB_DIR && addgroup -S flink && adduser -D -S -H -G flink -h $FLINK_HOME flink && chown -R flink:flink $FLINK_INSTALL_PATH/flink-* && chown -h flink:flink $FLINK_HOME
---> Running in b28403d5820b
+ ln -s /opt/flink-1.8.0-bin-hadoop28-scala_2.11.tgz /opt/flink
+ ln -s /opt/job.jar /opt/flink/lib
ln: /opt/flink/lib: Not a directory
The command '/bin/sh -c set -x && ln -s $FLINK_INSTALL_PATH/flink-* $FLINK_HOME && ln -s $FLINK_INSTALL_PATH/job.jar $FLINK_LIB_DIR && addgroup -S flink && adduser -D -S -H -G flink -h $FLINK_HOME flink && chown -R flink:flink $FLINK_INSTALL_PATH/flink-* && chown -h flink:flink $FLINK_HOME' returned a non-zero code: 1


Following was the command passed :


./build.sh --job-jar <path to the jar> --from-release --flink-version 1.8.0 --hadoop-version 2.8 --scala-version 2.11 --image-name flink-custom-image:0.0.0



 

I think we should change the script and update the readme file to reflect the changes done via FLINK-11266.

 

NOTE:

	I am not sure if the Jira component I have selected is correct or not.



 