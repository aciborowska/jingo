The DelimitedInputFormat can drops bytes when using input splits that have a length of -1 (for reading the whole file).  It looks like this is a simple bug in handing the delimiter on buffer boundaries where the logic is inconsistent for different split types.

Attached is a possible patch with fix and test.

 