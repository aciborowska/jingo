Here is related code:

    switch (strategy) {
    case PARTITION_CUSTOM:
      extractedKeys = new Object[1];
    case FORWARD:
    case PARTITION_HASH:


Looks like a break is missing following assignment to extractedKeys