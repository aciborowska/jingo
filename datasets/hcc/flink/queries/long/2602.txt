I have seen that Gelly occasionally uses ExecutionEnvironment.getExecutionEnvironment() to obtain en execution environment.

That easily leads to problems as it creates new execution environments in many cases. For example if the original execution environment was created via ExecutionEnvironment.createRemoteEnvironment(...), it will inevitably give you a wrong execution environment.

If new sources need to be created, they should be created with the execution environment of the other data sets in the computation, for example via vertexDataSet.getExecutionEnvironment().fromElementx(a, b, c).