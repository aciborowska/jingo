The Flip-6 code has a race condition when offering slots to a JobManager which directly deploys tasks to the offered slots. In such a situation it is possible that the deploy call overtakes the acknowledge message for the slot offering. As a result, the slots are not marked yet as active and the deployment will fail.

I propose to fix this problem by first activating all offered slots before sending the slot offer message to the JobManager. Consequently, we'll deactivate and free slots which haven't been accepted by the JobManager once we've received the offering acknowledge message.