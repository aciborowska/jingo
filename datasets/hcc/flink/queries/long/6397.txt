The MultipleProgramsTestBase sets a new TestEnvironment as a context environment but never explicitly unsets it, which can result subsequent tests categorically failing.

The CustomDistributionITCase doesn't unset the context either; and some streaming test that i haven't quite nailed down yet.