The DataSetJoinRule sets the join type to JoinType.INNER, meaning that outer joins are incorrectly translated to inner joins. The match method of the rule should check the join type and fail to produce a valid plan if it's not an inner join.