The execution of batch jobs can fail because in some cases we cannot retrieve the partition state. The problem seems to be that we use referential equality in JobMaster.java:619 when requesting the state of a finished result partition. This, of course, always fails with a PartitionProducerDisposedException because we should use the proper equals method for the comparison of the ResultPartitionID.