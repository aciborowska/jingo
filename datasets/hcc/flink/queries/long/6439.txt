
    FileInputStream in = new FileInputStream(path);
    DataInputStream dis = new DataInputStream(in);


None of the in / dis is closed upon return from the method.

In writeStateHandle(), OutputStream should be closed in finally block.