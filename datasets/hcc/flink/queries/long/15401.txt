There is a upsert sink my_sink with schema (a int, cnt int).

SQL:


INSERT INTO my_sink SELECT a, count(*) from my_source group by a;

will work.

But:


INSERT INTO my_sink SELECT b, count(*) from my_source group by b;


will fail. Because the name "b" not match "a".

Now, we just pass field names from plan toÂ setKeyFields. We need pass field names from sink.