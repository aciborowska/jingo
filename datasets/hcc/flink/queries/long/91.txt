I got the following exception during my work on the tlabs usecases.

I'm not sure if this fix is a suitable solution. Since the original plan is quite large, it is not very easy for me to reproduce the bug in a dedicated test case.

    Exception in thread "main" java.lang.NullPointerException
    	at java.util.ArrayList.addAll(ArrayList.java:559)
    	at eu.stratosphere.pact.compiler.plan.SinkJoiner.computeUnclosedBranchStack(SinkJoiner.java:81)
    	at eu.stratosphere.pact.compiler.PactCompiler$BranchesVisitor.postVisit(PactCompiler.java:1233)
    	at eu.stratosphere.pact.compiler.PactCompiler$BranchesVisitor.postVisit(PactCompiler.java:1)
    	at eu.stratosphere.pact.compiler.plan.TwoInputNode.accept(TwoInputNode.java:809)
    	at eu.stratosphere.pact.compiler.plan.TwoInputNode.accept(TwoInputNode.java:807)
    	at eu.stratosphere.pact.compiler.PactCompiler.compile(PactCompiler.java:703)
    	at eu.stratosphere.pact.compiler.PactCompiler.compile(PactCompiler.java:547)
    	at eu.stratosphere.pact.client.LocalExecutor.executePlan(LocalExecutor.java:79)

This PR also contains a little change to show an meaningful exception if a null-input is given into a contract.


---------------- Imported from GitHub ----------------
Url: https://github.com/stratosphere/stratosphere/pull/91
Created by: rmetzger
Labels: bug, 
Created at: Thu Sep 12 16:48:01 CEST 2013
State: closed