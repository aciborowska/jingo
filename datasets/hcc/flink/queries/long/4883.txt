Currently, user can create and use UDFs in Scala like this:


object FlatMapper extends RichCoFlatMapFunction[Long, String, (Long, String)] {
...
}



However, this leads to problems as the UDF is now a singleton that Flink could use across several operator instances, which leads to job failures. We should detect and prevent the usage of singleton UDFs.