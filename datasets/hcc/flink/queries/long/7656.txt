The contract that Flink provides to usercode is that that the usercode classloader is the context classloader whenever usercode is called.

In OutputFormatVertex usercode is called in the initializeOnMaster() and finalizeOnMaster() methods but the context classloader is not set to the usercode classloader.