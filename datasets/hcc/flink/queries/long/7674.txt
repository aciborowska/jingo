If the ContinuousFileMonitoringFunction is closed before run is called (because initialization fails), we get a NullPointerException, because checkpointLock has not been set.


synchronized (checkpointLock) {
  globalModificationTime = Long.MAX_VALUE;
  isRunning = false;
}



This results in a follow up error log:

2017-09-23 10:25:04,096 ERROR org.apache.flink.streaming.runtime.tasks.StreamTask           - Error during disposal of stream operator.
java.lang.NullPointerException
	at org.apache.flink.streaming.api.functions.source.ContinuousFileMonitoringFunction.close(ContinuousFileMonitoringFunction.java:337)
	at org.apache.flink.api.common.functions.util.FunctionUtils.closeFunction(FunctionUtils.java:43)
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.dispose(AbstractUdfStreamOperator.java:126)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.disposeAllOperators(StreamTask.java:429)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:334)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:702)
	at java.lang.Thread.run(Thread.java:748)

