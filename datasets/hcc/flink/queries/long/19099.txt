when taksmanager be killed ,my job consume some message , but the offset in not commit,

then restart it ,my job consume kafka message repeat,  I used checkpoint  and set 5 seconds ,

I think this is a very common problem，how to solve this problem？