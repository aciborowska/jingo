Flink elasticsearch connector leaking threads and classloaders thereof.  This results in OOM Metaspace when ES sink fails and restarted many times. 

This issue is visible in Flink 1.10 but not in 1.11 because Flink 1.11 does not create new class loaders in case of recoveries (FLINK-16408)

 

Reproduction:

	Start a job with ES sink in a Flink 1.10 cluster, without starting the ES cluster.



 

 