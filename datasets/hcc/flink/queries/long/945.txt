It seems that the iteration tail is sometimes releasing the memory prematurely, causing still working operations to fail.


java.lang.NullPointerException
	at eu.stratosphere.core.memory.MemorySegment.put(MemorySegment.java:186)
	at eu.stratosphere.nephele.services.memorymanager.AbstractPagedOutputView.writeByte(AbstractPagedOutputView.java:214)
	at eu.stratosphere.nephele.services.memorymanager.AbstractPagedOutputView.write(AbstractPagedOutputView.java:167)
	at eu.stratosphere.types.Record.serialize(Record.java:1208)
	at eu.stratosphere.api.java.typeutils.runtime.record.RecordSerializer.serialize(RecordSerializer.java:79)
	at eu.stratosphere.api.java.typeutils.runtime.record.RecordSerializer.serialize(RecordSerializer.java:27)
	at eu.stratosphere.pact.runtime.iterative.io.WorksetUpdateOutputCollector.collect(WorksetUpdateOutputCollector.java:52)
	at eu.stratosphere.test.recordJobs.kmeans.KMeansBroadcast$RecomputeClusterCenter.reduce(KMeansBroadcast.java:255)
	at eu.stratosphere.pact.runtime.task.GroupReduceDriver.run(GroupReduceDriver.java:103)
	at eu.stratosphere.pact.runtime.task.RegularPactTask.run(RegularPactTask.java:505)
	at eu.stratosphere.pact.runtime.iterative.task.AbstractIterativePactTask.run(AbstractIterativePactTask.java:132)
	at eu.stratosphere.pact.runtime.iterative.task.IterationTailPactTask.run(IterationTailPactTask.java:100)
	at eu.stratosphere.pact.runtime.task.RegularPactTask.invoke(RegularPactTask.java:370)
	at eu.stratosphere.nephele.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:284)
	at java.lang.Thread.run(Thread.java:744)

