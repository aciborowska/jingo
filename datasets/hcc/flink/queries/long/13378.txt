There some problem in SingleValueAggFunction:

1.The comment in the method is "value = count == 0 ? exception : operand(0)", but actually it need to be "value = count > 0 ? exception : operand(0)" according to the code and logic.

2.The throwException expression should call(THROW_EXCEPTION, literal(msg), typeLiteral(type)).

And there are some bugs to support it in blink-planner:

1.RexNodeConverter lack converter for THROW_EXCEPTION

2.PlannerExpressions lack expr to support type inference for THROW_EXCEPTION