This mailing list discussion explains the issue in detail: http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Custom-TimestampExtractor-and-FlinkKafkaConsumer082-td3488.html

As a workaround for now, the Kafka source can emit a final watermark for sources not producing any data.