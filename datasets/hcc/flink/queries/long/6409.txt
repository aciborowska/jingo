Calcite has a bug and cannot resolve the time fields of auxiliary group functions correctly. A discussion can be found in CALCITE-1761.

Right now this issue only affects our batch SQL API, but it is a blocker for FLINK-5884.