
    DataOutputBuffer dob = new DataOutputBuffer();
    credentials.writeTokenStorageToStream(dob);


dob should be closed upon returning from the method.


YarnApplicationMasterRunner#createTaskManagerContext() has similar issue.