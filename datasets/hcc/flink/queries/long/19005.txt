Hi !

Im running a 1.11.1 flink cluster, where I execute batch jobs made with DataSet API.

I submit these jobs every day to calculate daily data.

In every execution, cluster's used metaspace increase by 7MB and its never released.

This ends up with an OutOfMemoryError caused by Metaspace every 15 days and i need to restart the cluster to clean the metaspace

taskmanager.memory.jvm-metaspace.size is set to 512mb

Any idea of what could be causing this metaspace grow and why is it not released ?

 

================================================
=== Summary ======================================
================================================

Case 1, reported by Guillermo Sánchez:

	Flink 1.11.1
	Java 11
	Maximum Metaspace size set to 512mb
	Custom Batch job, submitted daily
	Requires restart every 15 days after an OOM



 Case 2, reported by Echo Lee:

	Flink 1.11.0
	Java 11
	G1GC
	WordCount Batch job, submitted every second / every 5 minutes
	eventually fails TaskExecutor with OOM



Case 3, reported by ShenDa

	Flink 1.11.0
	Java 11
	WordCount Batch job, submitted every 5 seconds
	growing Metaspace, eventually OOM
 

