
              try {
                if (throwable != null) {
                  completed.put(requestId, throwable);
                } else {
                  completed.put(requestId, path);
                }
              } finally {
                inProgress.remove(jobId);
              }


The call to inProgress.remove(jobId) should be protected by lock object.