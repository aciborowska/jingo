Currently Environment.merge() function looks like below: 

 


final Environment mergedEnv = new Environment();

// merge tables
final Map<String, TableDescriptor> tables = new HashMap<>(env1.getTables());
mergedEnv.getTables().putAll(env2.getTables());
mergedEnv.tables = tables;



and no-arg constructor for Environment defaults tables to Collections.emptyMap().
This basically results in calling putAll on EmptyMap which defaults to AbstractMap which always throws UnsuppoertedOperationException.

 