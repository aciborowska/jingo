The CassandraWriteAheadSink verifies that all writes send to cassandra have been applied by counting how many were sent and how many callbacks were activated. Once all writes were sent the sink enters into a loop that is only exited once both counts are equal.

Thus, should cassandra crash after all writes were sent, without having acknowledged all writes, the sink will deadlock in the loop.