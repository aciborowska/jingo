The DataStream.write() methods rely on the FileSinkFunctionByMillis class, which has a logic for flushing records, even though the underlying stream is never flushed. This is misleading for users as files are not written as they would expect it.

The code was initial written with FileOutputFormats in mind, but the types were not set correctly. This PR opened the write() method to any output format: https://github.com/apache/flink/pull/706/files