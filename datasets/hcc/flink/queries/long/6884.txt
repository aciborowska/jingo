When a TableSource#getReturnType differs from the actual input type the exception is thrown in code generation step with an exception that is hard to track back:


org.apache.flink.table.codegen.CodeGenException: Arity of result type does not match number of expressions.
	at org.apache.flink.table.codegen.CodeGenerator.generateResultExpression(CodeGenerator.scala:940)
	at org.apache.flink.table.codegen.CodeGenerator.generateConverterResultExpression(CodeGenerator.scala:883)
	at org.apache.flink.table.plan.nodes.CommonScan$class.generatedConversionFunction(CommonScan.scala:57)
	at org.apache.flink.table.plan.nodes.datastream.StreamTableSourceScan.generatedConversionFunction(StreamTableSourceScan.scala:35)
	at org.apache.flink.table.plan.nodes.datastream.StreamScan$class.convertToInternalRow(StreamScan.scala:48)
	at org.apache.flink.table.plan.nodes.datastream.StreamTableSourceScan.convertToInternalRow(StreamTableSourceScan.scala:35)
	at org.apache.flink.table.plan.nodes.datastream.StreamTableSourceScan.translateToPlan(StreamTableSourceScan.scala:107)



It would be nice if more meaningful exception was thrown earlier.