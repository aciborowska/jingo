The java8 documentation (https://ci.apache.org/projects/flink/flink-docs-master/apis/java8.html) has samples, one of them included below:


DataSet<String> input = env.fromElements(1, 2, 3);

// collector type must be declared
input.flatMap((Integer number, Collector<String> out) -> {
    for(int i = 0; i < number; i++) {
        out.collect("a");
    }
})
// returns "a", "a", "aa", "a", "aa" , "aaa"
.print();



I tried the sample and I think there are two issues with it (unless I have missed anything):
1. The DataSet should be DataSet<Integer> and not DataSet<String>
2. There should probably be a StringBuffer that, in the flatMap function, is used to  append "a" in the for loop and output (using out.collect(buffer.toString()) it rather than just out.collect("a");.  Currently, this produces only "a" each time rather than   "a", "a", "aa", "a", "aa" , "aaa" as shown the comments.