a job  have two sql 
 source is kafka 
 sink is redis  or other sink 

Asql 


//代码占位符
select 
  reqIp as factorContenta, 
  count(*) as eCount, 
  60 * 60 as expire 
from 
  kafka_source 
where 
  uri is not null 
group by 
  hop( 
    rowtime, 
    interval '2' second, 
    interval '60' minute 
  ), 
  reqIp 


Bsql 


//代码占位符
select 
        uid as factorContentb, 
  count(*) as eCount, 
  60 * 60 as expire 
from 
  kafka_source 
where 
  uri is not null 
group by 
  hop( 
    rowtime, 
    interval '2' second, 
    interval '60' minute 
  ), 
  uid 


now only start Asql  stop Bsql    sink  have key   656.19.173.34 

then stop Asql and savepoint hdfs   now  del key 656.19.173.34( if sink is 
 kafka Don't delete) 

start Bsql  from savepoint 
 you will find sink have key   656.19.173.34 and 6630519 all exist 

Bsql fetch Asql savepoint result 

i think sql uids not the only one 

 

my test data is 


//代码占位符
{ 
   "reqIp" : "656.19.173.34", 
   "rowtime" : 1537950912546, 
   "uid" : 6630519, 
   "uri" : "/web" 
} 

