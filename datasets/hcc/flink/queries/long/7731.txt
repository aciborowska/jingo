I have an operator that consists of:

CoGroup Datastream -> GlobalWindow -> CustomTrigger -> Apply function

The custom trigger fires and purges the elements after it has received the expected number of elements (or when a timeout fires) from one of the streams and the apply function merges the elements with the ones received from the other stream. It appears that the state of the operator grows continuously so it seems it never gets completely cleaned.

There is a discussion in http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Clean-GlobalWidnow-state-td15613.html that suggests that it may be a bug.

This job reproduces the issue: https://github.com/GerardGarcia/flink-global-window-growing-state