While cast Date to Long in Table API, the generated code throw comile error. Looks like:

Caused by: org.codehaus.commons.compiler.CompileException: Line 33, Column 23: Expression "result$5" is not an rvalue
	at org.codehaus.janino.UnitCompiler.compileError(UnitCompiler.java:10062)
	at org.codehaus.janino.UnitCompiler.toRvalueOrCompileException(UnitCompiler.java:5960)
	at org.codehaus.janino.UnitCompiler.compileContext2(UnitCompiler.java:3172)
	at org.codehaus.janino.UnitCompiler.access$5400(UnitCompiler.java:182)

