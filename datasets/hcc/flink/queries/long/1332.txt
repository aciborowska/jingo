We are writing some code for a student homework that reads two broadcast sets in the open method of a RichMapFunction.

We are seeing inconsistent behavior, sometimes the code works, sometimes it deadlocks, sometimes it crashes with an OutOfMemoryError...