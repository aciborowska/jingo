The NestedMapsStateTable initializes the internal state array with a wrong size which leads to a waste of memory. We should initialize the array with the number of key groups of the assigned range instead of the max parallelism.