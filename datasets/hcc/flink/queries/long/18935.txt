The CompletedOperationCache accepts new operations after closeAsync has been called. This is problematic because the returned termination future of closeAsync won't include these new operations. I think it would be better to fail with an IllegalStateException when one tries to enqueue a new operation after the CompletedOperationCache has been shut down.