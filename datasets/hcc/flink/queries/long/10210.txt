Currenty org.apache.flink.table.calcite.RelTimeIndicatorConverter#visit(LogicalCorrelate) supports only the cases if right side is LogicalTableFunctionScan. That is not always the case. For example in case of org.apache.flink.table.api.stream.table.CorrelateTest#testFilter the LogicalFilter node is being pushed down to the right side of LogicalCorrelate.

 

CC Timo Walther