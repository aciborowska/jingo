FlinkKafkaProducer010 doesn't implement CheckpointedFunction interface. This means, when it's used like a "regular sink function" (option a from the java doc) it will not flush the data on "snapshotState"  as it is supposed to.