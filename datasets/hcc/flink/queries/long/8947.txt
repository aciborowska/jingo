The issue is same as FLINK-5753

I am using Event time and have used watermark interval. Still, I have observed the timeout executes only after the next event

if: first event appears, second event not appear in the stream 
and no new events appear in a stream, timeout handler is not executed.

Expected result: timeout handler should be executed in case if there are no new events in a stream

 

My code snippet:

DataStream<String> dataStream = env.socketTextStream("localhost", 1212);

dataStream.getExecutionConfig().setAutoWatermarkInterval(100L);

dataStream = dataStream.assignTimestampsAndWatermarks(new BoundedOutOfOrdernessTimestampExtractor<JSONObject>(
 Time.seconds(0)) {

private static final long serialVersionUID = 4969170359023055566L;

@Override
 public long extractTimestamp(JSONObject event) 
{
 return System.currentTimeMillis();
 }
 });