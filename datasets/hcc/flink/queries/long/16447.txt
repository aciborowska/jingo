CompressWriterFactory has a CompressionCodec that is not serializable..

this make that StreamingFileSink fails to with non serializable field.

Â 

extending codec and implementing serializable solves the problem, but its odd