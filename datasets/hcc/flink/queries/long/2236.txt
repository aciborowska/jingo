The RowSerializer was recently updated to allow it to handle null values. This changes the binary layout of the serialised data. CaseClassComparator, which is used for comparison, is not aware of this new layout and therefore fails. The problem only occurs when a key is long enough to exceed the normalised-key length, that's why the tests fail to notice the bug.

I think the solution is to modify all Tuple-like serializers/comparators (TupleComparatorBase, CaseClassComparator, TupleSerializer, CaseClassSerializer, RowSerializer) to handle null-values, thus bringing the binary format in sync again.