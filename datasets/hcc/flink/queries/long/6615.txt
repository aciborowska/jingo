Steps to reproduce:
1) Stop task manager gracefully (kill -6 )
2) In the logs:

2017-05-17 13:35:50,147 INFO  org.apache.zookeeper.ClientCnxn                               - EventThread shut down [main-EventThread]
2017-05-17 13:35:50,200 ERROR org.apache.flink.runtime.io.disk.iomanager.IOManager          - IOManager failed to properly clean up temp file directory: /mnt/flink/tmp/flink-io-66f1d0ec-8976-41bf-9575-f80b181b0e47 [flink-akka.actor.default-dispatcher-2]
java.nio.file.DirectoryNotEmptyException: /mnt/flink/tmp/flink-io-66f1d0ec-8976-41bf-9575-f80b181b0e47
	at sun.nio.fs.UnixFileSystemProvider.implDelete(UnixFileSystemProvider.java:242)
	at sun.nio.fs.AbstractFileSystemProvider.delete(AbstractFileSystemProvider.java:103)
	at java.nio.file.Files.delete(Files.java:1126)
	at org.apache.flink.util.FileUtils.deleteDirectory(FileUtils.java:154)
	at org.apache.flink.runtime.io.disk.iomanager.IOManager.shutdown(IOManager.java:109)
	at org.apache.flink.runtime.io.disk.iomanager.IOManagerAsync.shutdown(IOManagerAsync.java:185)
	at org.apache.flink.runtime.taskmanager.TaskManager.postStop(TaskManager.scala:241)
	at akka.actor.Actor$class.aroundPostStop(Actor.scala:477)



Expected:

	on shutdown delete non-empty directory anyway.



Notes:

	after process terminated, I've checked "/mnt/flink/tmp/flink-io-66f1d0ec-8976-41bf-9575-f80b181b0e47" directory and didn't find anything there. So it looks like timing issue.

