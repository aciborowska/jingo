In Temporal Table Join, We don't support using  UDF in tempral table join key. For we can't analyze LookupKeys  when call is an expression. When users use like this, the program run normally,  and the result will be wrong. So we should add validation to prevent it.

The SQL as following:


INSERT INTO A
SELECT B.amount, B.currency, C.amount, C.product 
FROM B join C FOR SYSTEM_TIME AS OF B.proctime 
on B.amount = cancat(C.amount, 'r') and C.product = '1'

