Some TypeSerializers are not thread safe (for example KryoSerializer) we have to duplicate() them when using concurrently, as happens when performing a RocksDB snapshot.