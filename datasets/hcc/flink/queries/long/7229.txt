I have a 6-node Flink cluster where one contains jobmanager and the others have only taskmanagers. All taskmanagers have the following config :

state.backend: rocksdb
state.backend.rocksdb.checkpointdir: file:///opt/flink/data/local-checkpoints
state.backend.fs.checkpointdir: file:///opt/flink/data/local-checkpoints
state.checkpoints.dir: file:///opt/flink/data/glusterfs/external-checkpoints
state.checkpoints.num-retained: 3

And both checkpoints and external-checkpoints are enabled in the application.  

After running the application for a while, I can see that Flink do retains metadata for 3 checkpoints in external-checkpoints. However, for the local-checkpoint, only one node(with jobmanager) retains 3 checkpoints and the others don't delete old checkpoints. This causes the issue when the other nodes are junked with checkpoints and I have to manually clean them up.