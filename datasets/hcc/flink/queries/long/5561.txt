DataInputDeserializer#available seems to assume that the position points to the last read byte but instead it points to the next byte. Therefore, it returns a value which is 1 smaller than the correct one.