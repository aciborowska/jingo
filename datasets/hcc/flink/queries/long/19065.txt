Join operation with AutoGeneratedUID disabled leads to 


java.lang.IllegalStateException: Auto generated UIDs have been disabled but no UID or hash has been assigned to operator Map



code to reproduce


class JoinSpec extends AnyFlatSpec with Matchers with Serializable {
  it should "be able to join streams" in {
    val env = StreamExecutionEnvironment.getExecutionEnvironment
    env.getConfig.disableAutoGeneratedUIDs()

    val a = env.fromCollection(List("1", "2", "3")).name("a").uid("source-uid")
    val b = env.fromCollection(List("1", "2", "3")).name("b").uid("source-uid2")
    val c = a
      .join(b)
      .where(identity)
      .equalTo(identity)
      .window(TumblingProcessingTimeWindows.of(Time.seconds(30)))((a, b) => a+b)
      .uid("joined").name("joined")

    c.addSink(s => println(s))
      .name("ab")
      .uid("ab")

    println(env.getExecutionPlan)
    env.execute
    succeed
  }
}

