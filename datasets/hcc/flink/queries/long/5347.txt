
    public void write(DataOutputView out) throws IOException {
      out.writeUTF(getName());
      DataOutputViewStream dos = new DataOutputViewStream(out);
      InstantiationUtil.serializeObject(dos, getStateSerializer());
    }


dos should be closed upon return from the method.