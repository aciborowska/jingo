There is an attempt to enrich the exception with outputTag#getId, but outputTag is null, and a NullPointerException is thrown. Looking at the attempted message enrichment the code seems to assume a ClassCastException can only stem from SideOutput type mismatches. This may have been the norm before, but changes to classloader delegation in 1.4 have given rise to multiple ClassLoader conflicts (at least for us), and they all seem to end up here.