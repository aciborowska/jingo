Getting the execution plan via the ExecutionEnvironment causes the sinks to be cleared, effectively resulting in the situation that it is impossible to first obtain the execution plan, and then execute it. Passing false to https://github.com/apache/flink/blob/master/flink-clients/src/main/java/org/apache/flink/client/program/ContextEnvironment.java#L68 should fix this.