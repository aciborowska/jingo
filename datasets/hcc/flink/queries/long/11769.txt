As raised in this thread. The estimateDataTypesSize method in FlinkRelNode causes NPE for a Multiset<Map<String, String>> field type. Maybe the keyType or the valueType is empty in that case.