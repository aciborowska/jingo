The JobMasterTest#testRequestNextInputSplitWithDataSourceFailover relies on how many files you have in your working directory. This assumption is quite brittle. Instead we should explicitly instantiate an InputSplitAssigner with a defined number of input splits. 

Moreover, we should make the assertions more explicit: Input split comparisons should not rely solely on the length of the input split data.

Maybe it is also not necessary to capture the full TaskDeploymentDescriptor because we could already know the producer's and consumer's JobVertexID when we create the JobGraph.