Currently when using TwoPhaseCommitSinkFunction, if there is some intermittent failure in "beginTransaction", not only the snapshot that triggered this call fail, but also any subsequent write requests will fail also, rendering such sink unusable until application restart.

This issue is in code that hasn't been released yet.