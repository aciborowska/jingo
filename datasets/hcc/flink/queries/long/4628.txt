InputFormat\s runs through two configuration phases in the JobManager.

1. initializeOnMaster which runs the configure() method on the InputFormat
2. createInputSplits when the ExecutionJobVertex is created

In 1 we set the user class loader as the context class loader of the executing thread.

In 2 we only have the system class loader available. If any classes need to be loaded then, we have a problem. Some InputFormats rely on code which lazily load classes at different points in time.

In particular, this is a problem with the HBase TableInputFormat in the latest master.

We should make the user class loader available when creating input splits.