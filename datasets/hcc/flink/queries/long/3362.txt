Here is related code:

      long allocatedBytes = numChunks * chunkSize;

The evaluation of numChunks * chunkSize is done using 32-bit arithmetic.
This may result in overflow since the expected type of expression is long.