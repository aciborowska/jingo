when I register a stream to  table , and use proctime. if not use cast function to change the field (proctime) , it will be some errors . 

my scene is ,when i continues use query, i must be register a new proctime, the field proctime cannt be inherited。

for example:

tableEnvironment.registerDataStream("test_table1", row, "requestNo,deptName,pdmNo,overFlag,createDate,proctime.proctime");

when i add proctime in test_table1, and then use

Table resTable = tableEnvironment.sqlQuery("select * from test_table1")

the field prctime cannt be a timeattr field

 

errors:

Caused by: java.lang.ClassCastException: java.time.LocalDateTime cannot be cast to java.lang.LongCaused by: java.lang.ClassCastException: java.time.LocalDateTime cannot be cast to java.lang.Long at org.apache.flink.api.common.typeutils.base.LongSerializer.copy(LongSerializer.java:32) at org.apache.flink.api.java.typeutils.runtime.RowSerializer.copy(RowSerializer.java:93) at org.apache.flink.api.java.typeutils.runtime.RowSerializer.copy(RowSerializer.java:44) at org.apache.flink.streaming.runtime.tasks.OperatorChain$CopyingChainingOutput.pushToOperator(OperatorChain.java:635) ... 51 more

 