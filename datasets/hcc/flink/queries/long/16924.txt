Now in the latest code of flink master branch, we encountered unexpected npe exception as the picture like attachments. 
It seems that I can reproduce this problem  by creating tableEnv and doing some operations in main thread and then calling sqlQuery or sqlUpdate in another async thread.