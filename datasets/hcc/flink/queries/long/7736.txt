lgtm.com has identified a number of issues giving scope for improvement in the code: https://lgtm.com/projects/g/apache/flink/alerts/?mode=list
This issue is to address some of the simpler ones. Some of these are quite clear bugs such as off-by-one errors. Others are areas where the code might be made clearer, such as use of a variable name which shadows another variable.