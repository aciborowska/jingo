We introduced lazy execution of queries in FLINK-13088. But maybe we should revisit it because if we have a sequence of statements like this:



tEnv.sqlUpdate("CREATE TABLE test (...) with (path = '/tmp1')");
tEnv.sqlUpdate("INSERT INTO test SELECT ...");
tEnv.sqlUpdate("DROP TABLE test");
tEnv.sqlUpdate("CREATE TABLE test (...) with (path = '/tmp2')");

tEnv.execute();




If we execute the create statements eagerly and the queries lazily we will end up with wrong results.