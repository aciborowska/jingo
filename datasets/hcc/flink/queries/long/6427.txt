This is from a discussion on the user mailing lists: https://lists.apache.org/thread.html/917dbbbd7c8f48b33e7b470fa9ed382df61cf43cb5deb46becebf4b5@%3Cuser.flink.apache.org%3E

A possible solution is to add this to StreamWriterBase.hflushOrSync():

if (os.getWrappedStream() instanceof DFSOutputStream) {
    ((DFSOutputStream) os.getWrappedStream()).hsync(EnumSet.of(HdfsDataOutputStream.SyncFlag.UPDATE_LENGTH));
}

