While using heap-based timers, we are seeing occasional timer loss after restoring program from savepoint, especially when using a remote savepoint storage (s3). 

After some investigation, the issue seems to be related to this line in deserialization. When trying to check the VERSIONED_IDENTIFIER, the input stream may not guarantee filling the byte array, causing timers to be dropped for the affected key group.

Should keep reading until expected number of bytes are actually read or if end of the stream has been reached. 