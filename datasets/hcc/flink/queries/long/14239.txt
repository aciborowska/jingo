For Source, the max watermark is emitted in StreamSource#run currently. If some records are also output in close of RichSourceFunction, then the max watermark will reach the downstream operator before these records.