Because JDBCTableSourceSinkFactory.createStreamTableSink() create JDBCUpsertTableSink. But BatchExecSink can not work with UpsertStreamTableSink.



  override protected def translateToPlanInternal(
      planner: BatchPlanner): Transformation[Any] = {
    val resultTransformation = sink match {
      case _: RetractStreamTableSink[T] | _: UpsertStreamTableSink[T] =>
        throw new TableException("RetractStreamTableSink and UpsertStreamTableSink is not" +
          " supported in Batch environment.")



DDL like:
CREATE TABLE USER_RESULT(
NAME VARCHAR,
CITY VARCHAR,
SCORE BIGINT
) WITH (
'connector.type' = 'jdbc',
'connector.url' = '',
'connector.table' = '',
'connector.driver' = 'com.mysql.cj.jdbc.Driver',
'connector.username' = 'root',
'connector.password' = '',
'connector.write.flush.interval' = '1s')