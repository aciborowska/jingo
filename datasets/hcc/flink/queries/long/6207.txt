TypeSerializer are used for copy-on-write and the parallel snapshots in the CopyOnWriteStateTable. For stateful serializers, this can lead to race conditions. Snapshots need to duplicate the serializers before using them.