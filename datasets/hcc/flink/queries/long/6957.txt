Running the example (with the fix for FLINK-6956 applied) gives the following exception:


Table program cannot be compiled. This is a bug. Please file an issue.
        org.apache.flink.table.codegen.Compiler$class.compile(Compiler.scala:36)
        org.apache.flink.table.runtime.MapRunner.compile(MapRunner.scala:28)
        org.apache.flink.table.runtime.MapRunner.open(MapRunner.scala:42)
        org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:36)
        org.apache.flink.api.common.operators.base.MapOperatorBase.executeOnCollections(MapOperatorBase.java:64)
        org.apache.flink.api.common.operators.CollectionExecutor.executeUnaryOperator(CollectionExecutor.java:250)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:148)
        org.apache.flink.api.common.operators.CollectionExecutor.executeUnaryOperator(CollectionExecutor.java:228)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:148)
        org.apache.flink.api.common.operators.CollectionExecutor.executeUnaryOperator(CollectionExecutor.java:228)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:148)
        org.apache.flink.api.common.operators.CollectionExecutor.executeUnaryOperator(CollectionExecutor.java:228)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:148)
        org.apache.flink.api.common.operators.CollectionExecutor.executeUnaryOperator(CollectionExecutor.java:228)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:148)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:130)
        org.apache.flink.api.common.operators.CollectionExecutor.executeDataSink(CollectionExecutor.java:181)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:157)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:130)
        org.apache.flink.api.common.operators.CollectionExecutor.execute(CollectionExecutor.java:114)
        org.apache.flink.api.java.CollectionEnvironment.execute(CollectionEnvironment.java:35)
        org.apache.flink.api.java.ExecutionEnvironment.execute(ExecutionEnvironment.java:926)
        org.apache.flink.api.java.DataSet.collect(DataSet.java:410)
        org.apache.flink.api.java.DataSet.print(DataSet.java:1605)
        org.apache.flink.table.examples.java.WordCountTable.main(WordCountTable.java:58)


