when we write streaming data to filesystem, and select the 'partition time' , we can not commit the partition when write finished.

 



LocalDateTime partTime = extractor.extract(
      partitionKeys, extractPartitionValues(new Path(partition)));
if (watermark > toMills(partTime) + commitDelay) {
   needCommit.add(partition);
   iter.remove();
}


when we set a not UTC zone, and submit the partition, the method 'toMills' will get the UTC mills ，for example ，in UTC/GMT+08:00 ，the watermark will less than the toMills , so we can not commit the partition forever.

if we use a local time , not utc , it will be ok in UTC zone and other zone.

 