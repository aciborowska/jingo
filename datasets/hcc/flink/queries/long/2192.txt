I observed a fail of ComplexIntegrationTest.complexIntegrationTest1 on a local build (OS X, Java 8) due to incorrectly computed results.


Tests run: 7, Failures: 1, Errors: 1, Skipped: 1, Time elapsed: 9.997 sec <<< FAILURE! - in org.apache.flink.streaming.api.complex.ComplexIntegrationTest
complexIntegrationTest1(org.apache.flink.streaming.api.complex.ComplexIntegrationTest)  Time elapsed: 1.104 sec  <<< ERROR!
org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
	at org.apache.flink.runtime.jobmanager.JobManager$$anonfun$receiveWithLogMessages$1.applyOrElse(JobManager.scala:315)
	at scala.runtime.AbstractPartialFunction$mcVL$sp.apply$mcVL$sp(AbstractPartialFunction.scala:33)
	at scala.runtime.AbstractPartialFunction$mcVL$sp.apply(AbstractPartialFunction.scala:33)
	at scala.runtime.AbstractPartialFunction$mcVL$sp.apply(AbstractPartialFunction.scala:25)
	at org.apache.flink.runtime.testingUtils.TestingJobManager$$anonfun$receiveTestingMessages$1.applyOrElse(TestingJobManager.scala:160)
	at scala.PartialFunction$OrElse.apply(PartialFunction.scala:162)
	at org.apache.flink.runtime.ActorLogMessages$$anon$1.apply(ActorLogMessages.scala:36)
	at org.apache.flink.runtime.ActorLogMessages$$anon$1.apply(ActorLogMessages.scala:29)
	at scala.PartialFunction$class.applyOrElse(PartialFunction.scala:118)
	at org.apache.flink.runtime.ActorLogMessages$$anon$1.applyOrElse(ActorLogMessages.scala:29)
	at akka.actor.Actor$class.aroundReceive(Actor.scala:465)
	at org.apache.flink.runtime.jobmanager.JobManager.aroundReceive(JobManager.scala:94)
	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:516)
	at akka.actor.ActorCell.invoke(ActorCell.scala:487)
	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:254)
	at akka.dispatch.Mailbox.run(Mailbox.scala:221)
	at akka.dispatch.Mailbox.exec(Mailbox.scala:231)
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
Caused by: java.lang.NullPointerException: null
	at org.apache.flink.core.fs.local.LocalFileSystem.delete(LocalFileSystem.java:206)
	at org.apache.flink.core.fs.local.LocalFileSystem.delete(LocalFileSystem.java:189)
	at org.apache.flink.core.fs.FileSystem.initOutPathLocalFS(FileSystem.java:581)
	at org.apache.flink.api.common.io.FileOutputFormat.open(FileOutputFormat.java:233)
	at org.apache.flink.api.java.io.TextOutputFormat.open(TextOutputFormat.java:77)
	at org.apache.flink.streaming.api.functions.sink.FileSinkFunction.open(FileSinkFunction.java:58)
	at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:33)
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.open(AbstractUdfStreamOperator.java:56)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.openOperator(StreamTask.java:161)
	at org.apache.flink.streaming.runtime.tasks.OneInputStreamTask.invoke(OneInputStreamTask.java:97)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:559)
	at java.lang.Thread.run(Thread.java:745)

complexIntegrationTest1(org.apache.flink.streaming.api.complex.ComplexIntegrationTest)  Time elapsed: 1.104 sec  <<< FAILURE!
java.lang.AssertionError: Different number of lines in expected and obtained result. expected:<9> but was:<1>
	at org.junit.Assert.fail(Assert.java:88)
	at org.junit.Assert.failNotEquals(Assert.java:743)
	at org.junit.Assert.assertEquals(Assert.java:118)
	at org.junit.Assert.assertEquals(Assert.java:555)
	at org.apache.flink.test.util.TestBaseUtils.compareResultsByLinesInMemory(TestBaseUtils.java:270)
	at org.apache.flink.test.util.TestBaseUtils.compareResultsByLinesInMemory(TestBaseUtils.java:256)
	at org.apache.flink.streaming.api.complex.ComplexIntegrationTest.after(ComplexIntegrationTest.java:91)

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 6.399 sec - in org.apache.flink.streaming.runtime.tasks.SourceStreamTaskTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 8.773 sec - in org.apache.flink.streaming.runtime.io.BarrierBufferIOTest

Results :

Failed tests: 
  ComplexIntegrationTest.after:91->TestBaseUtils.compareResultsByLinesInMemory:256->TestBaseUtils.compareResultsByLinesInMemory:270 Different number of lines in expected and obtained result. expected:<9> but was:<1>

