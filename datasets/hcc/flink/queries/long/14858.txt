In class org.apache.flink.table.sqlexec.SqlToOperationConverter  


public static Optional<Operation> convert(
      FlinkPlannerImpl flinkPlanner,
      CatalogManager catalogManager,
      SqlNode sqlNode) {
   // validate the query
   final SqlNode validated = flinkPlanner.validate(sqlNode);
   SqlToOperationConverter converter = new SqlToOperationConverter(flinkPlanner, catalogManager);
   if (validated instanceof SqlCreateTable) {
      return Optional.of(converter.convertCreateTable((SqlCreateTable) validated));
   } if (validated instanceof SqlDropTable) {  // this should be "else if" not the "if"
      return Optional.of(converter.convertDropTable((SqlDropTable) validated));
   } else if (validated instanceof RichSqlInsert) {
      SqlNodeList targetColumnList = ((RichSqlInsert) validated).getTargetColumnList();
      if (targetColumnList != null && targetColumnList.size() != 0) {
         throw new ValidationException("Partial inserts are not supported");
      }
      return Optional.of(converter.convertSqlInsert((RichSqlInsert) validated));
   } else if (validated.getKind().belongsTo(SqlKind.QUERY)) {
      return Optional.of(converter.convertSqlQuery(validated));
   } else {
      return Optional.empty();
   }
}

 