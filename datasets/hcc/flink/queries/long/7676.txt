The following check in ContinuousFileMonitoringFunction fails when running against a file in Google Cloud Storage:

Path p = new Path(path);
FileSystem fileSystem = FileSystem.get(p.toUri());
if (fileSystem.exists(p)) {
   throw new FileNotFoundException("The provided file path " + path + " does not exist.");
}



I suspect this has something to do with consistency guarantees provided by GCS. I'm wondering if it's better to fail lazily at a later stage (e.g. when opening the stream and it doesn't work). 

After removing this check, everything works as expected. I can also run a batch WordCount job against the same file.