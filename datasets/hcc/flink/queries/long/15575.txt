Instead of shading "org.apache.httpcomponents" (this package does not exist) the azure filesystem should shade "org.apache.http". 

This e.g. causes problems when the azure filesystem and elasticsearch6 connector are both on the classpath.