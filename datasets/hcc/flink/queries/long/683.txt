Currently, the type extractor does not check whether the input type(s) of functions and the TypeInformation of the input data sets match. It would be good to check that, in order to catch cases where programmers omit the generics on the data set and can compile programs where the input type does not fit.

The code below should not result in a successful test.

```
public void testFunctionDependingOnInputWithTupleInputWithTypeMismatch() {
	IdentityMapper2<Boolean> function = new IdentityMapper2<Boolean>();

	TypeInformation<Tuple2<Boolean, String>> inputType = new TupleTypeInfo<Tuple2<Boolean, String>>(BasicTypeInfo.BOOLEAN_TYPE_INFO,
			BasicTypeInfo.INT_TYPE_INFO);

	TypeInformation<?> ti = TypeExtractor.getMapReturnTypes(function, inputType);

	Assert.assertTrue(ti.isBasicType());
	Assert.assertEquals(BasicTypeInfo.BOOLEAN_TYPE_INFO, ti);
}

public class IdentityMapper2<T> extends MapFunction<Tuple2<T, String>, T> {
	private static final long serialVersionUID = 1L;

	@Override
	public T map(Tuple2<T, String> value) throws Exception 
{
		return null;
	}
}
```

---------------- Imported from GitHub ----------------
Url: https://github.com/stratosphere/stratosphere/issues/683
Created by: StephanEwen
Labels: java api, 
Milestone: Release 0.5
Assignee: twalthr
Created at: Mon Apr 14 01:00:29 CEST 2014
State: closed