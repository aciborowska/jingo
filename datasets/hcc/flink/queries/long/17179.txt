Read data from kafka and set row time attribute in connector descriptor like this:

fsTableEnv.connect(new Kafka()
 .version("universal")
 .topic("stg_rljghxx_damo")
 .property()

...
 ).withFormat(new Json()
 .schema(Types.ROW(new String[]{"FaceID", "faceQuality","ShotTime"},
 new TypeInformation[]{Types.STRING(),Types.FLOAT(), Types.INT()})))
 .withSchema(new Schema()
 .field("FaceID", Types.STRING())
 .field("faceQuality",Types.FLOAT())
 .field("ShotTime", Types.INT()).rowtime(new Rowtime().timestampsFromField("ShotTime")))
 .createTemporaryTable("my_table");

 

And then use field of ShotTime as event time in  window like this:

Table result = table.window(Session.withGap("2.minutes").on("ShotTime").as("w")).groupBy("w, ..")
 .select(..);

And throws an error:



And When use DDL in sql,

it works.