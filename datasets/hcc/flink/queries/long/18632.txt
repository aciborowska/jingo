I use tuple type and pojo type to test retract stream, the test data is same and when i use 

toRetractStream(Table table, Class<T> clazz) api, the retract msg become to insert msg from sink conversion. I found the SinkCodeGenerator object did not give a row kind to afterIndexModify variable, so the delete msg become insert msg when it comes into processElement function generator by SinkCodeGenerator.

At last i add line of code like the pic in attachment and it works, so is it a bug? 

 

 

 