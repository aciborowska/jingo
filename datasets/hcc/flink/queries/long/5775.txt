When the job is submitted to a local Flink cluster (started using 'start-local.sh'), the exception below is produced.

It might be worth pointing out that the job reads from a local file (using StreamExecutionEnvironment.readFile()).


Caused by: java.lang.NullPointerException
        at org.apache.flink.core.fs.Path.normalizePath(Path.java:258)
        at org.apache.flink.core.fs.Path.<init>(Path.java:144)
        at org.apache.flink.core.fs.local.LocalFileSystem.pathToFile(LocalFileSystem.java:138)
        at org.apache.flink.core.fs.local.LocalFileSystem.getFileStatus(LocalFileSystem.java:97)
        at org.apache.flink.core.fs.FileSystem.exists(FileSystem.java:464)
        at org.apache.flink.core.fs.SafetyNetWrapperFileSystem.exists(SafetyNetWrapperFileSystem.java:99)
        at org.apache.flink.streaming.api.functions.source.ContinuousFileMonitoringFunction.run(ContinuousFileMonitoringFunction.java:191)
        at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:78)
        at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:55)
        at org.apache.flink.streaming.runtime.tasks.SourceStreamTask.run(SourceStreamTask.java:56)
        at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:272)
        at org.apache.flink.runtime.taskmanager.Task.run(Task.java:655)
        at java.lang.Thread.run(Thread.java:745)

