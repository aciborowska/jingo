I tried to reimplement the Java version of the ComputeEdgeDegree example as a Scala Pact program.
The job requires to return multiple records from a reducer (one per input record). However, currently the Scala reducer can only return a single record. I tried to solve this issue by returning a Scala list from the Reducer that contains all emitted records and to flat out that list using a flatMap. The Scala list seems to be correctly translated into the PactList type, but during its serialization a NullPointerException is raised.

The code of the failing Scala job is here:

https://github.com/fhueske/ozone/blob/fc914eadc3507cc27a2eb4891b3f491df0cb0e7a/pact-scala/pact-scala-examples/src/main/scala/eu/stratosphere/scala/examples/graph/ComputeEdgeDegrees2.scala

---------------- Imported from GitHub ----------------
Url: https://github.com/stratosphere/stratosphere/issues/160
Created by: fhueske
Labels: bug, 
Milestone: Release 0.4
Assignee: aljoscha
Created at: Mon Oct 14 14:43:19 CEST 2013
State: closed