Flink might chain together two data sinks under certain conditions.
In that case, the metrics accumulators will have a name clash (each task can have an accumulator only once, with chaining multiple sinks are sharing a task).

Also, when merging accumulators from different tasks for a per-job result, having multiple kafka producers or consumers will lead to wrong results as the merging happens only on a per-name basis.

With this issue, I'd like to introduce a unique id for consumers and producers when registering accumulators