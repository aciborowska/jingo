It seems that a SQL VALUES clause uses one operator per value under certain conditions which leads to a complicated job graph. Given that we need to compile code for every operator in the open method and have other overhead as well, this looks inefficient to me.

For example, the following query creates and unions 6 operators together:


SELECT *
  FROM (
    VALUES
      (1, 'Bob', CAST(0 AS BIGINT)),
      (22, 'Alice', CAST(0 AS BIGINT)),
      (42, 'Greg', CAST(0 AS BIGINT)),
      (42, 'Greg', CAST(0 AS BIGINT)),
      (42, 'Greg', CAST(0 AS BIGINT)),
      (1, 'Bob', CAST(0 AS BIGINT)))
    AS UserCountTable(user_id, user_name, user_count)

