The following program fails with a ClassCastException. It seems that key expressions and rows are not tested well. We should add more tests for them.



final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

TypeInformation[] types = new TypeInformation[] {Types.INT, Types.INT};

String[] fieldNames = new String[]{"id", "value"};
RowTypeInfo rowTypeInfo = new RowTypeInfo(types, fieldNames);

env.fromCollection(Collections.singleton(new Row(2)), rowTypeInfo)
.keyBy("id").sum("value").print();

env.execute("Streaming WordCount");

