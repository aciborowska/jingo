The problem is that ExtractTimestampsOperator wrongly updates the currentWatermark in the trigger method. This will interfere with values returned from extractWatermark.