Hi Everyone,

i got some trouble using SequentialInputFormat with one big file and found two bugs in BinaryInputFormat.

1. Unnecessary empty input splits are created if more minNumSplits requested than input files are present.
2. This empty splits are created using invalid ranges. HDFS returns an empty block locations array in this case and ends up with an IndexOutOfBoundsException two lines further.

I am not sure how to test the second bug, but attached a test against the first one.

Regards,
Sascha

---------------- Imported from GitHub ----------------
Url: https://github.com/stratosphere/stratosphere/pull/74
Created by: derSascha
Labels: 
Assignee: StephanEwen
Created at: Thu Sep 05 20:48:23 CEST 2013
State: closed