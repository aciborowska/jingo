when running the documentation build script as:
./build_docs.sh -p the docs are built using the correctly overridden baseurl, but they are then served from the wrong url making it a wee bit more difficult than intended to review changes locally.

The following is the output from running the script:

Configuration file: _config.yml
Configuration file: _local_preview_conf.yml
            Source: /vagrant/flink/docs
       Destination: /vagrant/flink/docs/target
 Incremental build: disabled. Enable with --incremental
      Generating...
/home/vagrant/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/pygments.rb-0.6.3/lib/pygments/popen.rb:57: warning: Insecure world writable dir /opt/scala-2.11.8/bin in PATH, mode 040777
                    done in 16.736 seconds.
 Auto-regeneration: enabled for '/vagrant/flink/docs'
Configuration file: /vagrant/flink/docs/_config.yml
    Server address: http://0.0.0.0:4000//ci.apache.org/projects/flink/flink-docs-master/
  Server running... press ctrl-c to stop.

As you see it looks to be using both config files to build, but only the default config file to serve.

This can be fixed by just removing the _local_preview_conf.yml file and instead specify the baseurl as an option to the serve command, so it becomes serve --config _config.yml --baseurl= --watch. Giving an output of:

Configuration file: _config.yml
            Source: /vagrant/flink/docs
       Destination: /vagrant/flink/docs/target
 Incremental build: disabled. Enable with --incremental
      Generating...
/home/vagrant/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/pygments.rb-0.6.3/lib/pygments/popen.rb:57: warning: Insecure world writable dir /opt/scala-2.11.8/bin in PATH, mode 040777
                    done in 15.928 seconds.
 Auto-regeneration: enabled for '/vagrant/flink/docs'
Configuration file: /vagrant/flink/docs/_config.yml
    Server address: http://0.0.0.0:4000/
  Server running... press ctrl-c to stop.