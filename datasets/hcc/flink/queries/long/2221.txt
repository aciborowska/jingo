If you think about it, this could never work. The state handle cleanup logic happens purely on the JobManager. So what happens is that the TaskManagers create state in some directory, let's say /tmp/checkpoints, on the TaskManager. For cleanup, the JobManager gets the state handle and calls discard (on the JobManager), this tries to cleanup the state in /tmp/checkpoints, but of course, there is nothing there since we are still on the JobManager.