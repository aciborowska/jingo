When using env.readCsvFile(filename), if a line in the CSV file has an empty last field, the line ends with a comma. This triggers an exception in GenericCsvInput.parseRecord():

			// check valid start position
			if (startPos >= limit) {
				if (lenient) 
{
					return false;
				}
 else 
{
					throw new ParseException("Row too short: " + new String(bytes, offset, numBytes));
				}
			}

Setting the parser to lenient would cause the last field to be left as null, rather than setting its value to "".

The parser should accept empty values for the last field on a row.