
  public int getNumberOfUsedBuffers() {
    return numberOfRequestedMemorySegments - availableMemorySegments.size();
  }


Access to availableMemorySegments should be protected with proper synchronization as other methods do.