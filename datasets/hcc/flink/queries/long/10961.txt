I am getting this exception when I tried to extract the key using external value e.g 



val partitionFactor = 10
val domainsSrc = env
.addSource(kafkaConsumer)
.keyBy(_.id.hashCode % partitionFactor
.map(...) 



I am getting this exception 



java.lang.RuntimeException: Could not extract key from Foo("some-uuid","text",1540348398,1)
....
Caused by: java.lang.ArithmeticException: / by zero



however when I simply use it like 



val domainsSrc = env
.addSource(kafkaConsumer)
.keyBy(_.id.hashCode % 10
.map(...) 



it works fine 