The ZooKeeperStateHandleStore cannot handle corrupted Znode data. When calling ZooKeeperStateHandleStore.getAll or getAllSortedByName and reading a node with corrupted data, the whole operation will fail. In such a situation, Flink won't be able to recover because it will read over and over again the same corrupted Znodes (in the recovery case). Therefore, I propose to ignore Znodes whose data cannot be read.