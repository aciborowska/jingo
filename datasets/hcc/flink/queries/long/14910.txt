There doesn't seem to be a way to add a UID to the Partition operator created by KeyBy, causing `disableAutoGeneratedUIDs` to fail.

 

Here's a simple test case that will reproduce the issue:

 @Test
public void testFailedUID() throws Exception {
    StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
    env.getConfig().disableAutoGeneratedUIDs();

    DataStream<String> data = env.fromCollection(Arrays.asList("1", "2", "3")).uid("source-uid");
    data.keyBy(i -> i)
            .map(i -> i).uid("map-uid");

    env.execute();
}


testFailedUID(twitch.creatoranalytics.sessions.StreamingJobTest)  Time elapsed: 0.008 sec  <<< ERROR!
java.lang.IllegalStateException: Auto generated UIDs have been disabled but no UID or hash has been assigned to operator Partition
 

 

This passes if the keyBy is removed. 