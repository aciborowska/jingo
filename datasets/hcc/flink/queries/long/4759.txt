
  public void serialize(T record, DataOutputView target) throws IOException {
    InstantiationUtil.serializeObject(new DataOutputViewStream(target), record);
  }


The DataOutputViewStream should be closed upon return from the method.