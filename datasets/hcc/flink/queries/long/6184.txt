The Buffer metrics defined in the TaskIOMetricGroup are created when a Task is created. At this time, the bufferPool in the Input gates that the metrics make use of is still null, leading to possible NPEs.

These metrics should either be created after the required objects are fully initialized or guard this case with null checks.