Currently, TwoPhaseCommitSinkFunction will fail if committing fails (either when doing it via the completed checkpoint notification or when trying to commit after restoring after failure). This means that the job will go into an infinite recovery loop because we will always keep failing.

In some cases it might be better to ignore those failures and keep on processing and this should be the default. We can provide an option that allows failing the sink on failing commits.