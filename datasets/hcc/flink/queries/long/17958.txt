When i am testing the kubernetes-session.sh, i find that the KubernetesResourceManager will constantly allocate taskmanager after cancel a job. I think it may be caused by a bug of the following code. When the dividend is 0 and divisor is bigger than 1, the return value will be 1. However, we expect it to be 0.


/**
 * Divide and rounding up to integer.
 * E.g., divideRoundUp(3, 2) returns 2.
 * @param dividend value to be divided by the divisor
 * @param divisor value by which the dividend is to be divided
 * @return the quotient rounding up to integer
 */
public static int divideRoundUp(int dividend, int divisor) {
   return (dividend - 1) / divisor + 1;
}

 

How to reproduce this issue?

	Start a Kubernetes session
	Submit a Flink job to the existing session
	Cancel the job and wait for the TaskManager released via idle timeout
	More and more TaskManagers will be allocated

