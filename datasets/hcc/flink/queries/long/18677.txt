The ZooKeeperLeaderRetrievalService does not invalidate the leader if the ZooKeeper connection gets SUSPENDED. This means that a TaskManager won't cancel its running tasks even though it might miss a leader change. I think we should at least make it configurable whether in such a situation the leader listener should be informed about the lost leadership. Otherwise, we might run into the situation where an old and a newly recovered instance of a Task can run at the same time.