
    if (promise == null) {
      LOG.info("Pending savepoint with ID " + checkpoint.getCheckpointID() + "  has been " +
          "removed before receiving acknowledgment.");
    }

    // Sanity check
    if (promise.isCompleted()) {
      throw new IllegalStateException("Savepoint promise completed");


Looks like a return statement is missing in the first if block above.