I was reading the watermark doc: https://ci.apache.org/projects/flink/flink-docs-release-1.2/dev/event_timestamps_watermarks.html
We should replace element with lastElement in the body of method checkAndGetNextWatermark:

public Watermark checkAndGetNextWatermark(MyEvent lastElement, long extractedTimestamp) {
		return element.hasWatermarkMarker() ? new Watermark(extractedTimestamp) : null;
	}

