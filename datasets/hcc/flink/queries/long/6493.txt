
        && ((partitionStateSerializer == null && ((Snapshot) obj).getPartitionStateSerializer() == null)
          || partitionStateSerializer.equals(((Snapshot) obj).getPartitionStateSerializer()))
        && ((partitionStateSerializerConfigSnapshot == null && ((Snapshot) obj).getPartitionStateSerializerConfigSnapshot() == null)
          || partitionStateSerializerConfigSnapshot.equals(((Snapshot) obj).getPartitionStateSerializerConfigSnapshot()));


The null check for partitionStateSerializer / partitionStateSerializerConfigSnapshot is in combination with another clause.

This may lead to NPE in the partitionStateSerializer.equals() call.