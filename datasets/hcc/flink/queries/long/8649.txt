This is StreamExecutionEnvironment.createInput in the Scala API:


def createInput[T: TypeInformation](inputFormat: InputFormat[T, _]): DataStream[T] =
  asScalaStream(javaEnv.createInput(inputFormat))


It should pass on the implicitly got TypeInformation to Java like this:


def createInput[T: TypeInformation](inputFormat: InputFormat[T, _]): DataStream[T] =
  asScalaStream(javaEnv.createInput(inputFormat, implicitly[TypeInformation[T]]))


The current situation creates a problem, for example, when we have generics in the type like in the following code, where the Java API can't deduce the TypeInformation on its own:


 StreamExecutionEnvironment.getExecutionEnvironment.createInput[Tuple2[Integer, Integer]](new ParallelIteratorInputFormat[Tuple2[Integer, Integer]](null))

