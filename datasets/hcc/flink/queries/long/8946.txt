Running in Yarn-standalone mode, when the Job Manager performs a failover, all TaskManager that are inherited from the previous JobManager will not send metrics to the new JobManager and other registered metric reporters.

 

A cursory glance reveal that these line of code might be the cause

https://github.com/apache/flink/blob/a3478fdfa0f792104123fefbd9bdf01f5029de51/flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala#L1082-L1086

Perhap the TaskManager close its metrics group when disassociating JobManager, but not creating a new one on fail-over association ?

 