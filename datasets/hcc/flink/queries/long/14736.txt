I created a very simple flink program using hive connector. According to logs, it seems that the program failed to connect hive metastore but it's okay with Spark on the same machine. 

Codes:


val fbEnv = ExecutionEnvironment.getExecutionEnvironment
fbEnv.setParallelism(10);
val fbTableEnv = BatchTableEnvironment.create(fbEnv)

val hiveCatalog = new HiveCatalog("hive", null, "/data00/tiger/spark_deploy/spark-stable/conf", "1.2.1")
fbTableEnv.registerCatalog("hive", hiveCatalog)

fbTableEnv.useCatalog("hive")
val testTable = fbTableEnv.sqlQuery("select count(1) from a.b")

val dataSet = fbTableEnv.toDataSet[Row](testTable)

dataSet.print()

fbTableEnv.execute("Hive Query");


 