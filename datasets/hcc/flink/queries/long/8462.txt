The TaskExecutor does neither properly stop RM heartbeats nor does it check whether a RM heartbeat timeout is still valid. As a consequence, it can happen that the TaskExecutor closes the connection to an active RM due to an outdated heartbeat timeout.