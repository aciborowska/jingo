There are duplicated cast operations in the generated code. For example, to run org.apache.flink.table.runtime.batch.sql.join.JoinITCase#testJoin, the generated code looks like this:

        @Override
        public void processElement(org.apache.flink.streaming.runtime.streamrecord.StreamRecord element) throws Exception {
          org.apache.flink.table.dataformat.BaseRow in1 = (org.apache.flink.table.dataformat.BaseRow) (org.apache.flink.table.dataformat.BaseRow) converter$0.toInternal((org.apache.flink.types.Row) element.getValue());
          ...

This issue removes the duplicated type casts.