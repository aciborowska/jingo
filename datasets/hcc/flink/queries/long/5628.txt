The CheckpointStatsTracker implements the Serializable interface, even though it no longer is serializable as it contains a List<ExecutionJobVertex>.

This was introduced in 579bc96446d598a2cfe8237b4ebd62d8c9df3483 which reworked the checkpoint stats tracking,

This does not affect 1.2 or 1.3 in any way (since these objects aren't serialized there), but it blocks the implementation of the HistoryServer.

The AccessExecution*/ArchivedExecution* classes, which are supposed to be a serializable form of the ExecutionGraph, are thus broken as they also make use of the CheckpointStatsTracker.

(Note: * = Graph/ExecutionJobVertex/ExecutionVertex/Execution) .

This wasn't catched in tests since no ExecutionJobVertices were given to the CheckpointStatsTracker in ArchivedExecutionGraphTest#setExecutionGraph.