I observed a non-deterministic failure of the KafkaITCase on Travis:

https://travis-ci.org/fhueske/flink/jobs/55815808


Running org.apache.flink.streaming.connectors.kafka.KafkaITCase
03/25/2015 16:08:15 Job execution switched to status RUNNING.
03/25/2015 16:08:15 Custom Source -> Stream Sink(1/1) switched to SCHEDULED
03/25/2015 16:08:15 Custom Source -> Stream Sink(1/1) switched to DEPLOYING
03/25/2015 16:08:15 Custom Source -> Stream Sink(1/1) switched to SCHEDULED
03/25/2015 16:08:15 Custom Source -> Stream Sink(1/1) switched to DEPLOYING
03/25/2015 16:08:15 Custom Source -> Stream Sink(1/1) switched to RUNNING
03/25/2015 16:08:15 Custom Source -> Stream Sink(1/1) switched to RUNNING
03/25/2015 16:08:17 Custom Source -> Stream Sink(1/1) switched to FAILED

java.util.NoSuchElementException: next on empty iterator
at scala.collection.Iterator$$anon$2.next(Iterator.scala:39)
at scala.collection.Iterator$$anon$2.next(Iterator.scala:37)
at scala.collection.LinearSeqLike$$anon$1.next(LinearSeqLike.scala:62)
at scala.collection.convert.Wrappers$IteratorWrapper.next(Wrappers.scala:30)
at org.apache.flink.streaming.connectors.kafka.api.simple.KafkaTopicUtils.getLeaderBrokerAddressForTopic(KafkaTopicUtils.java:83)
at org.apache.flink.streaming.connectors.kafka.api.KafkaSink.open(KafkaSink.java:118)
at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:33)
at org.apache.flink.streaming.api.invokable.StreamInvokable.open(StreamInvokable.java:158)
at org.apache.flink.streaming.api.streamvertex.StreamVertex.openOperator(StreamVertex.java:202)
at org.apache.flink.streaming.api.streamvertex.StreamVertex.invoke(StreamVertex.java:165)
at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:209)
at java.lang.Thread.run(Thread.java:701)

03/25/2015 16:08:17 Job execution switched to status FAILING.
03/25/2015 16:08:17 Custom Source -> Stream Sink(1/1) switched to CANCELING
03/25/2015 16:08:17 Custom Source -> Stream Sink(1/1) switched to FAILED

java.util.NoSuchElementException: next on empty iterator
at scala.collection.Iterator$$anon$2.next(Iterator.scala:39)
at scala.collection.Iterator$$anon$2.next(Iterator.scala:37)
at scala.collection.LinearSeqLike$$anon$1.next(LinearSeqLike.scala:62)
at scala.collection.convert.Wrappers$IteratorWrapper.next(Wrappers.scala:30)
at org.apache.flink.streaming.connectors.kafka.api.simple.KafkaTopicUtils.getLeaderBrokerAddressForTopic(KafkaTopicUtils.java:83)
at org.apache.flink.streaming.connectors.kafka.api.simple.PersistentKafkaSource.open(PersistentKafkaSource.java:159)
at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:33)
at org.apache.flink.streaming.api.invokable.StreamInvokable.open(StreamInvokable.java:158)
at org.apache.flink.streaming.api.streamvertex.StreamVertex.openOperator(StreamVertex.java:198)
at org.apache.flink.streaming.api.streamvertex.StreamVertex.invoke(StreamVertex.java:165)
at org.apache.flink.runtime.execution.RuntimeEnvironment.run(RuntimeEnvironment.java:209)
at java.lang.Thread.run(Thread.java:701)

03/25/2015 16:08:17 Job execution switched to status FAILED.

Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 10.774 sec <<< FAILURE! - in org.apache.flink.streaming.connectors.kafka.KafkaITCase

test(org.apache.flink.streaming.connectors.kafka.KafkaITCase) Time elapsed: 10.604 sec <<< FAILURE!
java.lang.AssertionError: Test failed with: null
at org.junit.Assert.fail(Assert.java:88)

at org.apache.flink.streaming.connectors.kafka.KafkaITCase.test(KafkaITCase.java:104)

