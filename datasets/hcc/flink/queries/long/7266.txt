Currently, every attempted release of an S3 state object also checks if the "parent directory" is empty and then tries to delete it.

Not only is that unnecessary on S3, but it is prohibitively expensive and for example causes S3 to throttle calls by the JobManager on checkpoint cleanup.

The FileState must only attempt parent directory cleanup when operating against real file systems, not when operating against object stores.