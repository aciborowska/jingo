The NestedMapsStateTable grows up continuously without free the heap memory.
We created a simple job that processes a stream of messages and uses CEP to generate an outcome message when a specific pattern is identified.
The messages coming from the stream are grouped by a key defined in a specific field of the message.
We've also added the "within" clause (set as 5 minutes), indicating that two incoming messages match the pattern only if they come in a certain time window.
What we've seen is that for every key present in the message, an NFA object is instantiated in the NestedMapsStateTable and it is never deallocated.
Also the "within" clause didn't help: we've seen that if we send messages that don't match the pattern, the memory grows up (I suppose that the state of NFA is updated) but it is not cleaned also after the 5 minutes of time window defined in "within" clause.
If you need, I can provide more details about the job we've implemented and also the screenshots about the memory leak.