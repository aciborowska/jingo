Trying to write reporter for elasticsearch 5.1.x using TransportClient which internally using io.netty version 4.1.6 which has a call to a method which is not present in flink io.netty verion 4.0.27 causing error

***********************************************************************************
Exception in thread "elasticsearch[_client_][management]T#1" java.lang.NoSuchMethodError: io.netty.buffer.CompositeByteBuf.addComponents(ZLjava/lang/Iterable;)Lio/netty/buffer/CompositeByteBuf;
        at org.elasticsearch.transport.netty4.Netty4Utils.toByteBuf(Netty4Utils.java:78)
        at org.elasticsearch.transport.netty4.Netty4Transport.sendMessage(Netty4Transport.java:449)
        at org.elasticsearch.transport.netty4.Netty4Transport.sendMessage(Netty4Transport.java:91)
        at org.elasticsearch.transport.TcpTransport.internalSendMessage(TcpTransport.java:976)
        at org.elasticsearch.transport.TcpTransport.sendRequest(TcpTransport.java:958)
        at org.elasticsearch.transport.TransportService.sendRequestInternal(TransportService.java:520)
        at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:465)
        at org.elasticsearch.client.transport.TransportClientNodesService$SniffNodesSampler$1.run(TransportClientNodesService.java:482)
        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:458)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)

***********************************************************************************

trying to upgrade the jar but in pom.xml of flink it's mentioned not to upgrade else there could be memory issue 
<dependency>
				<groupId>io.netty</groupId>
				<artifactId>netty-all</artifactId>
				<!-- Don't upgrade for now. Netty versions >= 4.0.28.Final
				contain an improvement by Netty, which slices a Netty buffer
				instead of doing a memory copy [1] in the
				LengthFieldBasedFrameDecoder. In some situations, this
				interacts badly with our Netty pipeline leading to OutOfMemory
				errors.

				[1] https://github.com/netty/netty/issues/3704 -->
				<version>4.0.27.Final</version>
			</dependency>



Please suggest a workaround.