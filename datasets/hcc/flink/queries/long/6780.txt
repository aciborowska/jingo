We observed that all streaming queries that refer to external tables fail when the Volcano planner converting LogicalTableScan to FlinkLogicalTableSourceScan:


Type mismatch:
rowtype of new rel:
RecordType(<table schema>, TIMESTAMP(3) NOT NULL proctime) NOT NULL
rowtype of set:
RecordType(<table schema>, ...) NOT NULL



Tables that are registered through StreamTableEnvironment#registerTableSource() do not suffer from this problem as StreamTableSourceTable adds the processing time / event time attribute automatically.