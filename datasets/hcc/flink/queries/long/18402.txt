I use array as follows:


DataStream<Tuple2<Boolean, CompanyBrandEntity>> ds = tEnv.toRetractStream(companyBrandSource, CompanyBrandEntity.class);
SingleOutputStreamOperator<Object[]> middleData = ds.map(new RuleMapFunction(ruleList))
 .filter(Objects::nonNull);


and I get this error:


java.lang.NullPointerException
 at org.apache.flink.api.common.typeutils.base.GenericArraySerializer.copy(GenericArraySerializer.java:96)
 at org.apache.flink.api.common.typeutils.base.GenericArraySerializer.copy(GenericArraySerializer.java:37)
 at org.apache.flink.streaming.runtime.tasks.OperatorChain$CopyingChainingOutput.pushToOperator(OperatorChain.java:639)
 at org.apache.flink.streaming.runtime.tasks.OperatorChain$CopyingChainingOutput.collect(OperatorChain.java:616)
 at org.apache.flink.streaming.runtime.tasks.OperatorChain$CopyingChainingOutput.collect(OperatorChain.java:596)
 at org.apache.flink.streaming.api.operators.AbstractStreamOperator$CountingOutput.collect(AbstractStreamOperator.java:730)
 at org.apache.flink.streaming.api.operators.AbstractStreamOperator$CountingOutput.collect(AbstractStreamOperator.java:708)
 at org.apache.flink.streaming.api.operators.StreamMap.processElement(StreamMap.java:41)


then I change the SingleOutputStreamOperator<Object[]> to SingleOutputStreamOperator<Ouput>,it begins to run correctly.

Â 