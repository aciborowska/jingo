
  public void clear() {
    registeredStates.clear();
  }


In other places of SharedStateRegistry, lock is taken on registeredStates before operation.
We should do the same for clear() method.