The TaskMetricGroup is created when a Task is created. It is cleaned up at the end of Task.run() in the finally block. If however run() is never called due some failure between the creation and the call to run the metric group is never closed. This also means that the JobMetricGroup is never closed.