The allocate() call is used in the YarnJobManager to send a heartbeat to the YARN resource manager. This call may block the JobManager actor system for arbitrary time, e.g. if retry handlers are set up within the call to allocate.

I propose to use the AMRMClientAsync's callback methods to send heartbeats and update the container information. The API is available for our supported Hadoop versions (2.3.0 and above).

https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/yarn/client/api/async/AMRMClientAsync.html