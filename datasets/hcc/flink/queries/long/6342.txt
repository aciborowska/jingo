The ZooKeeperLeaderElectionService should start its components under the lock in order to avoid race conditions with the LeaderLatchListener's callback isLeader. If this is not done, then a leader notification might go unnoticed from the election service because the LeaderLatch has been started but the internal state of the election service has not been set to running yet.