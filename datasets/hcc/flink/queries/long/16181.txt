It can be reproduced by a simple test case:

Add below to ScalarOperatorsTest


testSqlApi("IF(true, CAST('non-numeric' AS BIGINT), 0)", "null")


Â 

IMO, it's IfCallGen's bug, which should judge the nullTerm of operands first before assignment.

cc Jingsong Lee Jark Wu