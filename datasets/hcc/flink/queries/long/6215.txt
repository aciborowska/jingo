Currently the StatefulSequenceSource instantiates all the elements to emit first and keeps them in memory. This is not scalable as for large sequences of elements this can lead to out of memory exceptions.

To solve this, we can pre-partition the sequence of elements based on the maxParallelism parameter, and just keep state (to checkpoint) per such partition.