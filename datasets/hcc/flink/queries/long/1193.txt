The TypeExtractor cannot handle nested arrays with non-trivial element types. For example, the following code cannot be run

val input = env.fromCollection(List(1,2,3,4))
val mapped = input.map{
  id => {
    val pair = (1,1.0)
    val a = Array(pair)
    val b = Array(a)
    b
  }
}



The resulting type Array[Array[Tuple2[Int, Double]]] cannot be extracted. It would be nice, if Flink supported these types.