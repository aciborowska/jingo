Pojo.java


@Data
@NoArgsConstructor
public class Pojo  {
    private String foo;
}




object Fun extends ScalarFunction { 
   def eval(): Pojo = { new Pojo() } 
}
case class CaseClass(pojo:Pojo)


 

 


tableEnv.registerFunction("fun", Fun)
val table = tableEnv.sqlQuery("select fun() as pojo")
table.toRetractStream[CaseClass].print()


 

exception:

 


Exception in thread "main" org.apache.flink.table.api.ValidationException: Field types of query result and registered TableSink  do not match.
Query schema: [pojo: ROW<`foo` STRING>]
Sink schema: [pojo: LEGACY('STRUCTURED_TYPE', 'POJO<com.yunmo.iot.Pojo>')]

