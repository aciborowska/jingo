There are some minor differences in the behaviors of some File System functions, like mkdirs(). On some filesystems, it tolerates existing directories or files in place of parent directories. Some return false in an error case, some throw an exception.

I encountered this during writing tests for the file basted state backends. We should harmonize the behavior of FileSystem.mkdirs().

I suggest to adopt the behavior that is used by HDFS, which seems the most correct one.