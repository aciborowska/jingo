There seems to be a bug somewhere that Flink fails to allocate a full YARN cluster.

For example, my cluster has 42 nodes with 46.09 GB each (according to the NodeManager)
If my Flink client is requesting 41 + 1 (workers + master) containers (with 46GB each), I'm only getting 41 containers (instead of 42).

I've contacted the yarn-dev list already for help and I'm trying to figure out the cause of the issue.

As a simple workaround, users can just request one more container than they actually need.