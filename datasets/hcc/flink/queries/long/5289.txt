Using a ValueStateDescriptor and getRuntimeContext().getState(descriptor) on a non-keyed stream leads to NullPointerException which is not very helpful for users:


java.lang.NullPointerException
	at org.apache.flink.streaming.api.operators.StreamingRuntimeContext.getState(StreamingRuntimeContext.java:109)

