This was reported by an user: http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Flink-errors-out-and-job-fails-IOException-from-CollectSink-open-td12606.html

The shutdownFetcher method of KinesisDataFetcher is not protected against the condition when the source was closed before it started running. Both mainThread and shardConsumersExecutor should have null checks.