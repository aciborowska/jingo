As reported here https://issues.apache.org/jira/browse/FLINK-3763?focusedCommentId=15322517&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15322517, the RabbitMQ source might block forever / ignore the cancelling signal, if its listening to an empty queue.

Fix: call nextDelivery() with a timeout.