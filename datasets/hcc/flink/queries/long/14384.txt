In ValidationMatcher we use failMsg to test exception. However the sql can be validated successfully without throwing a exception and #matches method returns true finally.

 

Take #testInsertWithInvalidPartitionColumns as an example, you can succeed this tests even though you create a wrong failMsg.