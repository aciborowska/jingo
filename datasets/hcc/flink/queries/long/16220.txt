It's because the object reuse. For the below schema:


create table sink {
  col1 int,
  col2 array<int>
}

if col2 is null, then the reused object will be NullNode. for the next record, if it's not null, we will cast the reused object NullNode to ArrayNode, which will throw cast exception.

 

cc Jark Wu Timo Walther 