`BaseRow` is serialized and deserialized as `BinaryRow` by default, so when the key type of the map state is `BaseRow`, we should construct map keys with `BinaryRow` as type to get value from map state, otherwise, you would  always get Null...

Try it with following SQL:


// (b: Int, c: String)
SELECT 
      b, listagg(DISTINCT c, '#')
FROM MyTable
GROUP BY b


 