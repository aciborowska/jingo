When a task is canceled, the ClosableRegistry will be closed in the cancel thread. However, the task may still in the creation of KeyedStateBackend, and it will fail to register the backend to the ClosableRegistry. Because the backend is not assigned to the operator yet (due to the exception), the backend will not be destroyed when the task thread exits.

A simple solution is to catch exception in the registering and destroy the created backend in the case of failures. 