As the survey in this mailing list thread [1], kafka server will bind the error with topic-partition list when it handles `AddPartitionToTxnRequest`. So when the request body contains no topic-partition, the error won't be sent back to kafka producer client. Moreover, it producer internal api, it always check if `newPartitionsInTransaction` is empty before sending ADD_PARTITIONS_TO_TXN request to kafka cluster. We should apply it as well if you need to explicitly call it in the first commit phase of two-phase commit sink.

[1] http://apache-flink-user-mailing-list-archive.2336050.n4.nabble.com/Kafka-producer-failed-with-InvalidTxnStateException-when-performing-commit-transaction-td29384.html