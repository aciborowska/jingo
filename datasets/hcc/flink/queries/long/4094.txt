A user reported that off-heap memory is not properly deallocated when setting taskmanager.memory.preallocate:false (per default) [1]. This can cause the TaskManager process being killed by the OS.

It should be possible to execute multiple batch jobs with preallocation turned off. No longer used direct memory buffers should be properly garbage collected so that the JVM process does not exceed it's maximum memory bounds.

[1] http://apache-flink-mailing-list-archive.1008284.n3.nabble.com/offheap-memory-allocation-and-memory-leak-bug-td12154.html