
  protected void handleStateChange(ConnectionState newState) {
    switch (newState) {
      case CONNECTED:
        LOG.debug("Connected to ZooKeeper quorum. Leader election can start.");
      case SUSPENDED:
        LOG.warn("Connection to ZooKeeper suspended. The contender " + leaderContender.getAddress()
          + "no longer participates in the leader election.");
      case RECONNECTED:
        LOG.info("Connection to ZooKeeper was reconnected. Leader election can be restarted.");
      case LOST:
        // Maybe we have to throw an exception here to terminate the JobManager
        LOG.warn("Connection to ZooKeeper lost. The contender " + leaderContender.getAddress()
          + "no longer participates in the leader election.");


Any of the first 3 states would result in multiple log output.