This is configuration issue. There are two options: 

taskmanager.network.credit-based-flow-control.enabled

and

taskmanager.exactly-once.blocking.data.enabled

If we disable first one, but remain default value for the second one deadlocks will occur. I think we can safely drop the second config value altogether and always use blocking BarrierBuffer for credit based flow control and spilling BarrierBuffer for non credit based flow control.

cc Zhijiang