I'm trying to run a complicated computation that looks like this: [1].
One of the DataSource->Filter->Map chains finishes fine, but the other one freezes. Debugging shows that it is spinning in the while loop in LocalBufferPool.requestBuffer.

askToRecycle is false. Both numberOfRequestedMemorySegments and currentPoolSize is 128, so it never goes into that if either.

This is a stack trace: [2]

And here is the code, if you would like to run it: [3]. Unfortunately, I can't make it more minimal, becuase if I remove some operators, the problem disappears. The class to start is malom.Solver. (On first run, it calculates some lookuptables for a few minutes, and puts them into /tmp/movegen)

[1] http://compalg.inf.elte.hu/~ggevay/flink/plan.txt
[2] http://compalg.inf.elte.hu/~ggevay/flink/stacktrace.txt
[3] https://github.com/ggevay/flink/tree/deadlock-malom