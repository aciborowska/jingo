I get error results when I use an UDAF with Object Array return type (e.g. Row[]). I find that the problem is we reuse 'reuseArray' as the return value of ObjectArrayConverter.toBinaryArray().Â It leads to 'prevAggValue' and 'newAggValue' in GroupAggFunction.processElement() contains exactly the same BinaryArray, so 'equaliser.equalsWithoutHeader(prevAggValue, newAggValue)' is always true.