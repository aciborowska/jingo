Following NullPointerException from pr1956 rebased to master.

After the first execution (the program calls DataSet.count()) the call to ExecutionConfig.serializeUserCode sets registeredKryoTypes and other fields to null. During the second execution (creating the actual result) access to this field throws a NullPointerException.

[~till.rohrmann] should serializeUserCode set the fields to a new LinkedHashSet and leave globalJobParameters unchanged?


org.apache.flink.client.program.ProgramInvocationException: The main method caused an error.
	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:520)
	at org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:403)
	at org.apache.flink.client.program.Client.runBlocking(Client.java:248)
	at org.apache.flink.client.CliFrontend.executeProgramBlocking(CliFrontend.java:860)
	at org.apache.flink.client.CliFrontend.run(CliFrontend.java:327)
	at org.apache.flink.client.CliFrontend.parseParameters(CliFrontend.java:1187)
	at org.apache.flink.client.CliFrontend.main(CliFrontend.java:1238)
Caused by: java.lang.NullPointerException
	at org.apache.flink.api.common.ExecutionConfig.registerKryoType(ExecutionConfig.java:625)
	at org.apache.flink.api.java.typeutils.runtime.kryo.Serializers.recursivelyRegisterType(Serializers.java:96)
	at org.apache.flink.api.java.typeutils.runtime.kryo.Serializers.recursivelyRegisterType(Serializers.java:66)
	at org.apache.flink.api.java.ExecutionEnvironment$1.preVisit(ExecutionEnvironment.java:1053)
	at org.apache.flink.api.java.ExecutionEnvironment$1.preVisit(ExecutionEnvironment.java:1046)
	at org.apache.flink.api.common.operators.SingleInputOperator.accept(SingleInputOperator.java:198)
	at org.apache.flink.api.common.operators.SingleInputOperator.accept(SingleInputOperator.java:199)
	at org.apache.flink.api.common.operators.SingleInputOperator.accept(SingleInputOperator.java:199)
	at org.apache.flink.api.common.operators.SingleInputOperator.accept(SingleInputOperator.java:199)
	at org.apache.flink.api.common.operators.SingleInputOperator.accept(SingleInputOperator.java:199)
	at org.apache.flink.api.common.operators.SingleInputOperator.accept(SingleInputOperator.java:199)
	at org.apache.flink.api.common.operators.DualInputOperator.accept(DualInputOperator.java:281)
	at org.apache.flink.api.common.operators.GenericDataSinkBase.accept(GenericDataSinkBase.java:220)
	at org.apache.flink.api.common.Plan.accept(Plan.java:333)
	at org.apache.flink.api.java.ExecutionEnvironment.createProgramPlan(ExecutionEnvironment.java:1046)
	at org.apache.flink.api.java.ExecutionEnvironment.createProgramPlan(ExecutionEnvironment.java:1004)
	at org.apache.flink.client.program.ContextEnvironment.execute(ContextEnvironment.java:58)
	at org.apache.flink.api.java.ExecutionEnvironment.execute(ExecutionEnvironment.java:898)
	at org.apache.flink.api.java.utils.DataSetUtils.checksumHashCode(DataSetUtils.java:350)
	at org.apache.flink.graph.examples.HITS.main(HITS.java:114)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:505)
	... 6 more

