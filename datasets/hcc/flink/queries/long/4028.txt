In computeWindow we have this code: new TimeWindow(timestamp, timestamp + windowSize). This is wrong because timestamp is actually the end timestamp of the window.