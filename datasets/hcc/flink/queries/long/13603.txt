starting from Flink 1.6.2 , some schema not working when have nested object .

issue like :  Caused by: org.apache.calcite.sql.validate.SqlValidatorException: Column 'data.interaction.action_type' not found in table 

Even we can see that column from Table Schema .

And the same schema and query working on 1.5.2 , but not working for 1.6.x , 1.7.x and 1.8.x

 

I tried to dive into the bug, and found the root cause is calcite library doesn't mapping the column name with the correct Row type . 

I checked Flink 1.6 using the same version of Calcite as Flink 1.5 .  Not sure if Calcite is the root cause of this issue .

Attached with the code sample and two issue json schemas . both examples give column not found exception .

 