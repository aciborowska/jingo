If a partition state request is triggered for a producer that finishes before the request arrives, the execution is unregistered and the producer cannot be found. In this case the PartitionState returns null and the job fails.

We need to check the producer location via the intermediate result partition in this case.

See here: https://api.travis-ci.org/jobs/177668505/log.txt?deansi=true