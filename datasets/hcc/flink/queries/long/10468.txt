Here is related code:


    switch (strategy) {
    case PARTITION_CUSTOM:
      extractedKeys = new Object[1];
    case FORWARD:


It seems a 'break' is missing prior to FORWARD case.


    if (strategy == ShipStrategyType.PARTITION_CUSTOM && partitioner == null) {
      throw new NullPointerException("Partitioner must not be null when the ship strategy is set to custom partitioning.");
    }


Since the above check is for PARTITION_CUSTOM, it seems we can place the check in the switch statement.