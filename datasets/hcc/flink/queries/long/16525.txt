The current name() function in TwoPhaseCommitSinkFunction tries to describe the currently running subtask with its class name, the index of the subtask and the number of parallel subtasks.

Since the starting index of the subtask is 0, and the starting number for the parallelism is 1, it could lead to the following log message.


15:59:41,448 INFO  org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction  - FlinkKafkaProducer 0/1 - checkpoint 1 complete, committing transaction TransactionHolder{handle=KafkaTransactionState [transactionalId=null, producerId=-1, epoch=-1], transactionStartTime=1583852371370} from checkpoint 1


Although only one subtask is running it describes the subtask as 0/1 which might indicate more than one subtask.

I would suggest incrementing the first number after the class name by 1 to better indicate how many subtasks are running.

 

 