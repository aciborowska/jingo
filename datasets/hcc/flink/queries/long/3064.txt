The following example leads to a NPE:

ExecutionEnvironment env = ExecutionEnvironment.createCollectionsEnvironment();

env.fromCollection(Lists.newArrayList(new Tuple1<>(1L)))
  .filter(new AlwaysFalseFilter()) // returns false for any element
  .sum(0)
  .print();



In GroupReduceOperatorBase, it is not always checked if the input to a GroupReduceFunction is not empty. This leads to the NPE when executing the AggregateOperator.