Recently I found sometimes UDFs are not open properly. It turns out when transforming sql to execution plan, some generated functions' open method are not called. e.g. NonWindowJoin, TimeBoundedStreamJoin, FlatJoinRunner.