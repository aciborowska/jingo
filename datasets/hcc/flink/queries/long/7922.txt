FlinkTypeFactory does not override the following function correctly:


def leastRestrictive(types: util.List[RelDataType]): RelDataType = {
  //... 
}


dealing with SQL such as:


CASE 
  WHEN <CONDITION> THEN 
    <COMPOSITE_TYPE> 
  ELSE 
    NULL 
END


will trigger runtime exception. 

See following test sample for more details:
https://github.com/walterddr/flink/commit/a5f2affc9bbbd50f06200f099c90597e519e9170