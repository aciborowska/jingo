Some output streams perform blocking operations that cannot be properly interrupted. This causes cancellations to take very long when happening concurrently to large synchronous state snapshot operations.

Closing the streams concurrently helps to abort these blocking operations.

This might already be fixed in 1.2 by the CloseableRegistry.