Method clean in org.apache.flink.api.java.ClosureCleaner received a new parameter in Flink 1.8.1. This class is noted as internal, but is used in the Kafka connectors (in org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducerBase).

The Kafka connectors library is not provided by the server, and must be set up as a dependency with compile scope (see https://ci.apache.org/projects/flink/flink-docs-stable/dev/connectors/kafka.html#usage, or the Maven project template). Any project using those connectors and built with 1.8.0 cannot be deployed on a 1.8.1 Flink server, because it would target the old method.

=> This methods needs a fallback with the original two arguments (setting a default value ofÂ RECURSIVE for the level argument).