The default FlinkFixedPartitioner return  int[] partitions by subtaskid % partitions.length.When kafka sink parallelism<kafka partition numã€‚It only the first few kafka partitions will write data.

I think it needs to be improved here.


	@Override
	public int partition(T record, byte[] key, byte[] value, String targetTopic, int[] partitions) {
		Preconditions.checkArgument(
			partitions != null && partitions.length > 0,
			"Partitions of the target topic is empty.");

		return partitions[parallelInstanceId % partitions.length];
	}

