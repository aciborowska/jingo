FlinkKafkaProducer011ITCase.testRestoreToCheckpointAfterExceedingProducersPool(FlinkKafkaProducer011ITCase.java:152) deadlocked on travis:

 

"main" #1 prio=5 os_prio=0 tid=0x00007fa36800a000 nid=0x5b85 waiting on condition [0x00007fa371c4d000]
   java.lang.Thread.State: WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait for  <0x00000000f54856c8> (a java.util.concurrent.CountDownLatch$Sync)
	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304)
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231)
	at org.apache.kafka.clients.producer.internals.TransactionalRequestResult.await(TransactionalRequestResult.java:50)
	at org.apache.kafka.clients.producer.KafkaProducer.initTransactions(KafkaProducer.java:537)
	at org.apache.flink.streaming.connectors.kafka.internal.FlinkKafkaProducer.initTransactions(FlinkKafkaProducer.java:123)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.abortTransactions(FlinkKafkaProducer011.java:919)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.cleanUpUserContext(FlinkKafkaProducer011.java:903)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.finishRecoveringContext(FlinkKafkaProducer011.java:891)
	at org.apache.flink.streaming.api.functions.sink.TwoPhaseCommitSinkFunction.initializeState(TwoPhaseCommitSinkFunction.java:338)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011.initializeState(FlinkKafkaProducer011.java:867)
	at org.apache.flink.streaming.util.functions.StreamingFunctionUtils.tryRestoreFunction(StreamingFunctionUtils.java:178)
	at org.apache.flink.streaming.util.functions.StreamingFunctionUtils.restoreFunctionState(StreamingFunctionUtils.java:160)
	at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.initializeState(AbstractUdfStreamOperator.java:96)
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:254)
	at org.apache.flink.streaming.util.AbstractStreamOperatorTestHarness.initializeState(AbstractStreamOperatorTestHarness.java:424)
	at org.apache.flink.streaming.util.AbstractStreamOperatorTestHarness.initializeState(AbstractStreamOperatorTestHarness.java:346)
	at org.apache.flink.streaming.connectors.kafka.FlinkKafkaProducer011ITCase.testRestoreToCheckpointAfterExceedingProducersPool(FlinkKafkaProducer011ITCase.java:152)

 

https://api.travis-ci.org/v3/job/386021917/log.txt