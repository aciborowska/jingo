The credit-based flow control implementation of RemoteInputChannel#notifyBufferAvailable() does not forward errors (like the IllegalStateException) to the thread that is being notified. The calling code at LocalBufferPool#recycle, however, relies on the callback forwarding errors and completely ignores any failures.

Therefore, we could end up with a program waiting forever for the callback and not even a failure message in the logs.