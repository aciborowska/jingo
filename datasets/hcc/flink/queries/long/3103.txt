Here is related code:

    public void flush() throws IOException {
      if (!closed) {



Lock "FsCheckpointStateOutputStream.this" should be held.