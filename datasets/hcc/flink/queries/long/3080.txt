Currently it is not possible to union a stream with itself or a product of itself.
For example, the following code
stream.union(stream.map(...))
fails with this exception: "A DataStream cannot be unioned with itself".
The documentation currently states that "If you union a data stream with itself you will still only get each element once." and should also be updated.