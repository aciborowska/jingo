I tried calling  groupReduceOnEdges (EdgesFunctionWithVertexValue<K, VV, EV, T> edgesFunction, EdgeDirection direction, TypeInformation<T> typeInfo) in order to make the vertex-centric version of the Triangle Count library method applicable to any kind of key and I got a TypeErasure Exception. 

After doing a bit of debugging (see the hack in https://github.com/andralungu/flink/tree/trianglecount-vertexcentric), I saw that actually the call to TypeExtractor.createTypeInfo(NeighborsFunctionWithVertexValue.class, .... in ApplyNeighborCoGroupFunction does not work properly, i.e. it returns null. From what I see, the coGroup in groupReduceOnNeighbors tries to infer a type before "returns" is called. 

I may be missing something, but that particular feature (groupReduceOn with types) is not documented or tested so we would also need some tests for that. 