Here is related code:

      FSDataInputStream fdis = file.getPath().getFileSystem().open(file.getPath(), blockInfo.getInfoSize());
      fdis.seek(file.getLen() - blockInfo.getInfoSize());

      blockInfo.read(new DataInputViewStreamWrapper(fdis));
      totalCount += blockInfo.getAccumulatedRecordCount();


fdis / wrapper should be closed upon leaving the method