Connecting two grouped data stream coMapping them and sinking it in a custom sink sometimes results in null records.
More specifically on in this test the result might be an array with null, thus getting

java.lang.AssertionError: 
Expected :[1, 3, 5, 1, 3, 5]
Actual   :[null, 1, 5, 3, 1, 5]

or not getting all the expected messages:
java.lang.AssertionError: 
Expected :[1, 1, 3, 3, 5, 5]
Actual   :[1, 3, 5, 5]