The FileSourceFunction wraps InputFormat but doesn't execute its life cycle functions correctly.

1) It doesn't call close() before reading the next InputSplit via open(InputSplit split).

2) It calls close() even if no InputSplit has been read (and thus open(..) hasn't been called previously).