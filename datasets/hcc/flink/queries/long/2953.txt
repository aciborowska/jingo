Chaining for sortPartition() calls does not work correctly in Scala DataSet API.


val x: DataSet[(Int, Int, Int)] = ... //
x
  .sortPartition(0, Order.DESCENDING)
  .sortPartition(2, Order.ASCENDING)
  .print()

// result
(1,2,3)
(1,3,4)
(1,2,5)
(3,7,8)

// should be
(3,7,8)
(1,2,3)
(1,3,4)
(1,2,5)



The same program in the Java DataSet API works correctly.