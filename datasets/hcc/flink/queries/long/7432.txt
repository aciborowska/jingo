

  public QueryableStateClient(Configuration config) throws Exception {
    this(config, HighAvailabilityServicesUtils.createHighAvailabilityServices(
        config, Executors.directExecutor(), HighAvailabilityServicesUtils.AddressResolution.TRY_ADDRESS_RESOLUTION));



The HighAvailabilityServices instance is only used for calling getJobManagerLeaderRetriever().

The instance should be closed upon leaving QueryableStateClient ctor.