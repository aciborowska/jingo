When using RocksDB as our statebackend, we found it will lead to memory leak when restarting job (manually or in recovery case).

 

How to reproduce:

	increase RocksDB blockcache size(e.g. 1G), it is easier to monitor and reproduce.
	start a job using RocksDB statebackend.
	when the RocksDB blockcache reachs maximum size, restart the job. and monitor the memory usage (k8s pod working set) of the TM.
	go through step 2-3 few more times. and memory will keep raising.



 

Any solution or suggestion for this? Thanks!