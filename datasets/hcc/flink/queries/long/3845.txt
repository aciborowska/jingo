Gelly performs a DataSet union then calls distinct() which keeps vertices with the same label but different values. This should be replaced with one of the join operators.