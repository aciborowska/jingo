Similar to JDBC connectors, Hive connectors communicate with Flink framework using TableSchema, which contains DataType. As the time data read from and write to Hive connectors must be java.sql.* types and the default conversion class of our time data types are java.time.*, we have to fixÂ Hive connector with DataTypes.DATE/TIME/TIMESTAMP support.

But currently when reading tables from Hive, the table schema is created using Hive's schema, so the time types in the created schema will be sql time type not local time type. If user specifies a local time type in the table schema when creating a table in Hive, he will get a different schema when reading it out. This is undesired.