>Â When I create the HiveCatalog and Flink is not able to connect to the HiveMetastore, the statement can not be executed, but the catalog is still created. Subsequent attempts to query the tables result in a NPE.

In CatalogManager.registerCatalog.
 Consider open is a relatively easy operation to fail, we should put catalog into catalog manager after its open.