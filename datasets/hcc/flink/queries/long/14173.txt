The planner fails to generate a plan for ANSI-style joins with Temporal Table Functions. The Blink planners throws with aÂ "Missing conversion is LogicalTableFunctionScan[convention: NONE -> LOGICAL]" message (and some very fancy graphviz stuff). The old planner does a "This exception indicates that the query uses an unsupported SQL feature."

This fails:


 SELECT 
   o_amount * r_amount AS amount 
 FROM Orders 
 JOIN LATERAL TABLE (Rates(o_proctime)) 
   ON r_currency = o_currency 

This works:


 SELECT 
   o_amount * r_amount AS amount 
 FROM Orders 
    , LATERAL TABLE (Rates(o_proctime)) 
 WHERE r_currency = o_currency

Reproduction with the attached Java and pom.xml files. Also included: stack traces for both Blink and the old planner.

I think this is a regression. I remember using ANSI-style joins with a temporal table function successfully in 1.8.