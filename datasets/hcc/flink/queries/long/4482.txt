In CheckpointCoordinator#stopCheckpointScheduler() :

    synchronized (lock) {
...
      numUnsuccessfulCheckpointsTriggers = 0;


triggerLock is not held in the above operation.
See comment for triggerLock earlier in triggerCheckpoint():


    // we lock with a special lock to make sure that trigger requests do not overtake each other.
    // this is not done with the coordinator-wide lock, because the 'checkpointIdCounter'
    // may issue blocking operations. Using a different lock than teh coordinator-wide lock,
    // we avoid blocking the processing of 'acknowledge/decline' messages during that time.
    synchronized (triggerLock) {

