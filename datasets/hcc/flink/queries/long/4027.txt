The FlinkKafkaProducer09 sink appears to not offer at-least-once guarantees.

The producer is publishing messages asynchronously.  A callback can record publishing errors, which will be raised when detected.  But as far as I can tell, there is no barrier to wait for async errors from the sink when checkpointing or to track the event time of acked messages to inform the checkpointing process.

If a checkpoint occurs while there are pending publish requests, and the requests return a failure after the checkpoint occurred, those message will be lost as the checkpoint will consider them processed by the sink.