OrcRowInputFormat ignores isNull and isRepeating on nested struct columns. If a struct column contains nulls, it tries to read struct fields, leading to NPE in case of string fields:



java.lang.NullPointerException
	at java.lang.String.checkBounds(String.java:384)
	at java.lang.String.<init>(String.java:462)
	at org.apache.flink.orc.OrcUtils.readNonNullBytesColumnAsString(OrcUtils.java:392)
	at org.apache.flink.orc.OrcUtils.readField(OrcUtils.java:215)
	at org.apache.flink.orc.OrcUtils.readStructColumn(OrcUtils.java:1203)
	at org.apache.flink.orc.OrcUtils.readField(OrcUtils.java:252)
	at org.apache.flink.orc.OrcUtils.readNonNullStructColumn(OrcUtils.java:677)
	at org.apache.flink.orc.OrcUtils.readField(OrcUtils.java:250)
	at org.apache.flink.orc.OrcUtils.fillRows(OrcUtils.java:142)
	at org.apache.flink.orc.OrcRowInputFormat.ensureBatch(OrcRowInputFormat.java:334)
	at org.apache.flink.orc.OrcRowInputFormat.reachedEnd(OrcRowInputFormat.java:314)
	at org.apache.flink.runtime.operators.DataSourceTask.invoke(DataSourceTask.java:165)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:718)
	at java.lang.Thread.run(Thread.java:748)

