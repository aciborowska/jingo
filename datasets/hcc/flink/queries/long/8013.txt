The AggregationCodeGenerator checks that a user-defined AggregateFunction implements all required methods. However, the check for the merge(accumulator: ACC, its: java.lang.Iterable[ACC]): Unit method is too strict and rejects valid UDAGGs. 

This happens for more complex accumulators such as Array[org.apache.flink.api.java.tuple.Tuple2[java.lang.Integer, java.lang.Float]] because generic types are lost such that the check of the argument types of merge fails.