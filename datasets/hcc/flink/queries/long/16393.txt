The asynchronous record emitter depends on the periodic watermark calculation. If no periodic watermark is configured then records will be directly emitted by the shard consumer threads and the record emitter thread never used. We should skip the thread creation in that case.