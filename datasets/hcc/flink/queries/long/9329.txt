

Examples:
KafkaTableSource source = Kafka010JsonTableSource.builder()
.withSchema(TableSchema.builder()
.field("sensorId", Types.LONG()) 
.field("temp", Types.DOUBLE())
.field("ptime", Types.SQL_TIMESTAMP()).build())
.withProctimeAttribute("ptime")
.build(); tableEnv.registerTableSource("flights", source ); 

Â 


Kafka010JsonTableSource implement the DefinedRowtimeAttributes .
so when TableSourceUtil call hasRowtimeAttribute(source)to check ,it will call follow code
/** Returns a list with all rowtime attribute names of the [[TableSource]]. */
private def getRowtimeAttributes(tableSource: TableSource[_]): Array[String] = {
  tableSource match {
    case r: DefinedRowtimeAttributes =>
      r.getRowtimeAttributeDescriptors.asScala.map(_.getAttributeName).toArray
    case _ =>
      Array()
  }
}

 r.getRowtimeAttributeDescriptors will throw NPE because of we use ProctimeAttribute here


