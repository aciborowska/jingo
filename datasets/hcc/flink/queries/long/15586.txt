BucketingSink#createHadoopFileSystem first is loading org.apache.flink.core.fs.FileSystem through the plugin class loader (correctly), but later in the "re-instantiate" branch it's ignoring the plugin class loader/PluginManager classes altogether, which means it will be looking for non existing classes in the parent class loader.