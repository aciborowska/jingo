The following code is stuck sending data from the source to the map operator. Two settings seem to have an influence here: env.setBufferTimeout(-1); and env.disableOperatorChaining(); - if I remove either of these, the job works as expected.

(I pre-populated my Kafka topic with one element to reproduce easily)



    StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

    // comment either these two and the job works
    env.setBufferTimeout(-1);
    env.disableOperatorChaining(); 

    Properties properties = new Properties();
    properties.setProperty("bootstrap.servers", "localhost:9092");
    properties.setProperty("group.id", "test");
    FlinkKafkaConsumer<String> consumer = new FlinkKafkaConsumer<>("topic", new SimpleStringSchema(), properties);
    consumer.setStartFromEarliest();
    DataStreamSource<String> input = env.addSource(consumer);

    input
        .map((x) -> x)
        .print();

    env.execute();

