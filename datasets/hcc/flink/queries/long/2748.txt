On JobStatusChanged message and a failure to catch the accumulator result the client will receive a JobResultFailure and JobResultSuccess response


newJobStatus match {
  case JobStatus.FINISHED =>
    val accumulatorResults: java.util.Map[String, SerializedValue[AnyRef]] = try {
      executionGraph.getAccumulatorsSerialized()
    } catch {
      case e: Exception =>
        log.error(s"Cannot fetch final accumulators for job $jobID", e)
        val exception = new JobExecutionException(jobID,
          "Failed to retrieve accumulator results.", e)
        jobInfo.client ! decorateMessage(JobResultFailure(
          new SerializedThrowable(exception)))
        Collections.emptyMap()  <<< HERE
    }
  val result = new SerializedJobExecutionResult(
    jobID,
    jobInfo.duration,
    accumulatorResults)
    jobInfo.client ! decorateMessage(JobResultSuccess(result)) <<< HERE



Furthermore the indentation is off.