Sink DDL:

 


val sinkDDL =
  s"""
    |CREATE TABLE T2 (
    |  d DECIMAL(10, 2),
    |  cnt INT
    |) with (
    |  'connector.type' = 'filesystem',
    |  'connector.path' = '$sinkFilePath',
    |  'format.type' = 'csv',
    |  'format.field-delimiter' = ','
    |)
  """.stripMargin


Using blink with batch mode. (ensure insert BinaryRow into sink table)

 

In FLINK-15124 , but we still use wrong precision to construct DataFormatConverter. This will lead to exception when inserting BinaryRow. (BinaryRow need correct precision to get)

 