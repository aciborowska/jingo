The shading rework made before 1.3 removed a snappy dependency that was accidentally pulled in through hadoop. This is technically alright, until class-loaders rear their ugly heads.

Our kafka connector can read avro records, which may or may not require snappy. Usually this should be solvable by including the snappy dependency in the user-jar if necessary, however since the kafka connector loads classes that it requires using the system class loader this doesn't work.

As such we have to add a separate snappy dependency to flink-core.