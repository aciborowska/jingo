I am making some tests with IMap in Hazelcast 3.5.3.  These tests are being run with -Xms100M -Xmx100M.

My Map has <Integer, String> where I had 2MB Strings, running with no eviction  will exhaust memory around 30 items.

First I added an eviction policy at 20 items. This made the test run perfectly with items being evicted when needed.

I then added a MapStore. As these are just local tests the store simply saves and loads to a file in disk, in a real scenario persistence would be done to a distributed persistence. With the MapStore i can recover items that were present in the past and update them.

Problem happens when I use containsKey for a value that exists in the MapStore. I see the Item being loaded from the Store but it does not get added to the Map (no event being triggered in this case), eventually the system crashes with no memory.

The code is a bit long so I added it to a gist: https://gist.github.com/gfelisberto/1075ea5428920c9a2746 I can move it here if needed.
