Hi,

I have tried to use the Hazelcast-ra.rar version 1.9.1 on WebSphere both version 6.1 and 7.0, but I can't get it working on any of them.
I have installed the ressource adapter and configured it.

I have used the following jsp code:

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;%@page
    language=&quot;java&quot; contentType=&quot;text/html; charset=ISO-8859-1&quot;
    pageEncoding=&quot;ISO-8859-1&quot;%&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;test&lt;/title&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;%@page import=&quot;javax.resource.ResourceException&quot; %&gt;
&lt;%@page import=&quot;javax.transaction._&quot; %&gt;
&lt;%@page import=&quot;javax.naming._&quot; %&gt;
&lt;%@page import=&quot;javax.resource.cci._&quot; %&gt; 
&lt;%@page import=&quot;java.util._&quot; %&gt; 
&lt;%@page import=&quot;com.hazelcast.core.Hazelcast&quot; %&gt; 

&lt;%@page import=&quot;javax.resource.ResourceException&quot; %&gt;
&lt;%@page import=&quot;javax.transaction._&quot; %&gt;
&lt;%@page import=&quot;javax.naming._&quot; %&gt;
&lt;%@page import=&quot;javax.resource.cci._&quot; %&gt; 
&lt;%@page import=&quot;java.util._&quot; %&gt; 
&lt;%@page import=&quot;com.hazelcast.core.Hazelcast&quot; %&gt; 

&lt;%
UserTransaction txn = null;
Connection conn = null;
Queue queue = Hazelcast.getQueue (&quot;default&quot;);
Map map     = Hazelcast.getMap   (&quot;default&quot;);
Set set     = Hazelcast.getSet   (&quot;default&quot;);
List list   = Hazelcast.getList  (&quot;default&quot;);

try { 
    Context context = new InitialContext(); 
    txn = (UserTransaction) context.lookup(&quot;java:comp/UserTransaction&quot;); 
    txn.begin(); 

```
ConnectionFactory cf = (ConnectionFactory) context.lookup (&quot;hazel/test&quot;); 
conn = cf.getConnection();  

queue.offer(&quot;newitem&quot;);
map.put (&quot;1&quot;, &quot;value1&quot;);
set.add (&quot;item1&quot;);
list.add (&quot;listitem1&quot;);

txn.commit(); 
```

} catch (Throwable e) { 
    if (txn != null) {
        try{
            txn.rollback();
        }catch (Exception ix) {ix.printStackTrace();};
    }
    e.printStackTrace();
} finally { 
    if (conn != null) {
        try{
            conn.close();
        }catch (Exception ignored) {};
    }
}
%&gt;

&lt;/body&gt;
&lt;/html&gt;

If I debug the code I can see that when the server runs the line cf.getConnection() I get the following exception:

[20-01-11 10:36:32:396 CET] 0000001c RegisteredRes E   WTRN0078E: An attempt by the transaction manager to call start on a transactional resource has resulted in an error. The error code was XAER_RMERR. The exception stack trace follows: javax.transaction.xa.XAException: XAResource threw an unchecked exception
    at com.ibm.ws.Transaction.JTA.JTAResourceBase.processThrowable(JTAResourceBase.java:367)
    at com.ibm.ws.Transaction.JTA.JTAResourceBase.start(JTAResourceBase.java:165)
    at com.ibm.tx.jta.RegisteredResources.startRes(RegisteredResources.java:988)
    at com.ibm.ws.tx.jta.RegisteredResources.enlistResource(RegisteredResources.java:877)
    at com.ibm.ws.tx.jta.TransactionImpl.enlistResource(TransactionImpl.java:1718)
    at com.ibm.ws.tx.jta.TranManagerSet.enlistOnePhase(TranManagerSet.java:608)
    at com.ibm.ejs.j2c.LocalTransactionWrapper.enlist(LocalTransactionWrapper.java:587)
    at com.ibm.ejs.j2c.ConnectionManager.initializeForUOW(ConnectionManager.java:1567)
    at com.ibm.ejs.j2c.ConnectionManager.involveMCInTran(ConnectionManager.java:1194)
    at com.ibm.ejs.j2c.ConnectionManager.allocateConnection(ConnectionManager.java:698)
    at com.hazelcast.jca.ConnectionFactoryImpl.getConnection(ConnectionFactoryImpl.java:43)
    at com.ibm._jsp._test._jspService(_test.java:127)
    at com.ibm.ws.jsp.runtime.HttpJspBase.service(HttpJspBase.java:98)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:831)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1530)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:829)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:458)
    at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:175)
    at com.ibm.wsspi.webcontainer.servlet.GenericServletWrapper.handleRequest(GenericServletWrapper.java:121)
    at com.ibm.ws.jsp.webcontainerext.AbstractJSPExtensionServletWrapper.handleRequest(AbstractJSPExtensionServletWrapper.java:239)
    at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3742)
    at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:276)
    at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:929)
    at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1583)
    at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:178)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:455)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewInformation(HttpInboundLink.java:384)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:272)
    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214)
    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113)
    at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
    at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
    at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
    at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
    at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
    at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
    at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1550)

[20-01-11 10:36:32:396 CET] 0000001c LocalTransact E   J2CA0030E: Method enlist caught javax.transaction.RollbackException: XAResource start association error:XAER_RMERR
    at com.ibm.ws.tx.jta.TransactionImpl.enlistResource(TransactionImpl.java:1741)
    at com.ibm.ws.tx.jta.TranManagerSet.enlistOnePhase(TranManagerSet.java:608)
    at com.ibm.ejs.j2c.LocalTransactionWrapper.enlist(LocalTransactionWrapper.java:587)
    at com.ibm.ejs.j2c.ConnectionManager.initializeForUOW(ConnectionManager.java:1567)
    at com.ibm.ejs.j2c.ConnectionManager.involveMCInTran(ConnectionManager.java:1194)
    at com.ibm.ejs.j2c.ConnectionManager.allocateConnection(ConnectionManager.java:698)
    at com.hazelcast.jca.ConnectionFactoryImpl.getConnection(ConnectionFactoryImpl.java:43)
    at com.ibm._jsp._test._jspService(_test.java:127)
    at com.ibm.ws.jsp.runtime.HttpJspBase.service(HttpJspBase.java:98)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:831)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1530)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:829)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:458)
    at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:175)
    at com.ibm.wsspi.webcontainer.servlet.GenericServletWrapper.handleRequest(GenericServletWrapper.java:121)
    at com.ibm.ws.jsp.webcontainerext.AbstractJSPExtensionServletWrapper.handleRequest(AbstractJSPExtensionServletWrapper.java:239)
    at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3742)
    at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:276)
    at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:929)
    at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1583)
    at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:178)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:455)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewInformation(HttpInboundLink.java:384)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:272)
    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214)
    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113)
    at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
    at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
    at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
    at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
    at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
    at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
    at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1550)
Caused by: javax.transaction.SystemException: XAResource start association error:XAER_RMERR
    at com.ibm.tx.jta.RegisteredResources.startRes(RegisteredResources.java:1039)
    at com.ibm.ws.tx.jta.RegisteredResources.enlistResource(RegisteredResources.java:877)
    at com.ibm.ws.tx.jta.TransactionImpl.enlistResource(TransactionImpl.java:1718)
    ... 33 more

<p>Migrated from http://code.google.com/p/hazelcast/issues/detail?id=488</p>
