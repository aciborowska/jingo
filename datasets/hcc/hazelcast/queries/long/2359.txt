I have a map-reduce task running in a cluster of 3 nodes. The other two nodes eventually left the cluster and map-reduce task and never joined back (Split brain syndrome? also probably due to the issue I reported as a comment in #2105). But when the map-reduce tasks completes in the node that the map-reduce task initially started, it fails with the below log, instead of giving the correct output with the number of map(), reduce() invocations, which are counted using IAtomicLong.

The below log was found in the master node, just before it completed execution.

Apr 28, 2014 10:21:41 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation@36162346, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=100, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:21:44 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.FireNotificationOperation@52765b39, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=100, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:21:46 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation@36162346, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=110, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:21:49 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.FireNotificationOperation@52765b39, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=110, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:21:51 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation@36162346, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=120, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:21:54 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.FireNotificationOperation@52765b39, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=120, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:21:56 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation@36162346, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=130, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.CancelJobSupervisorOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:21:59 PM com.hazelcast.spi.impl.BasicInvocation
WARNING: [146.193.41.146]:5701 [main] [3.2] Retrying invocation: BasicInvocation{ serviceName='hz:impl:mapReduceService', op=com.hazelcast.mapreduce.impl.operation.FireNotificationOperation@52765b39, partitionId=-1, replicaIndex=0, tryCount=250, tryPauseMillis=500, invokeCount=130, callTimeout=50000000, target=Address[146.193.41.145]:5701}, Reason: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService
Apr 28, 2014 10:22:01 PM com.hazelcast.spi.impl.BasicInvocation

Printing the params of the collation map reduce job..
java.util.concurrent.ExecutionException: java.lang.RuntimeException: java.util.concurrent.ExecutionException: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService*****_Printing the parameters of the last executed job**_*********

```
    at com.hazelcast.mapreduce.impl.task.TrackableJobFuture.setResult(TrackableJobFuture.java:80)
    at com.hazelcast.mapreduce.impl.task.JobSupervisor.notifyRemoteException(JobSupervisor.java:143)
    at com.hazelcast.mapreduce.impl.operation.NotifyRemoteExceptionOperation.run(NotifyRemoteExceptionOperation.java:54)
    at com.hazelcast.spi.impl.BasicOperationService.processOperation(BasicOperationService.java:363)
    at com.hazelcast.spi.impl.BasicOperationService.processPacket(BasicOperationService.java:309)
    at com.hazelcast.spi.impl.BasicOperationService.access$400(BasicOperationService.java:102)
    at com.hazelcast.spi.impl.BasicOperationService$BasicOperationProcessorImpl.process(BasicOperationService.java:756)
```

Number of Mappers: 0

```
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:744)
    at com.hazelcast.util.executor.PoolExecutorThreadFactory$ManagedThread.run(PoolExecutorThreadFactory.java:59)Number of Combiners: 0
```

Number of Reducers: 16062

---

*****_Printing the number of jobs, mappers, combiners, and reducers executed**_*********
Caused by: java.lang.RuntimeException: java.util.concurrent.ExecutionException: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService
        at com.hazelcast.mapreduce.impl.MapReduceService.sendNotification(MapReduceService.java:233)
        at com.hazelcast.mapreduce.impl.task.ReducerTask.processProcessedState(ReducerTask.java:134)
        at com.hazelcast.mapreduce.impl.task.ReducerTask.run(ReducerTask.java:99)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask.run(FutureTask.java:262)
        at com.hazelcast.util.executor.CompletableFutureTask.run(CompletableFutureTask.java:57)
        at com.hazelcast.util.executor.CachedExecutorServiceDelegate$Worker.run(CachedExecutorServiceDelegate.java:186)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:744)
        at com.hazelcast.util.executor.PoolExecutorThreadFactory$ManagedThread.run(PoolExecutorThreadFactory.java:59)
        at ------ End remote and begin local stack-trace ------.(Unknown Source)
        at ------ Operation failed on node: Address[146.193.41.144]:5701 ------.notifyRemoteException(JobSupervisor.java:141)
        at com.hazelcast.mapreduce.impl.task.JobSupervisor.notifyRemoteException(JobSupervisor.java:141)
        ... 10 more
Caused by: java.util.concurrent.ExecutionException: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService
        at com.hazelcast.spi.impl.BasicInvocation$InvocationFuture.resolveResponseOrThrowException(BasicInvocation.java:792)
        at com.hazelcast.spi.impl.BasicInvocation$InvocationFuture.get(BasicInvocation.java:696)
        at com.hazelcast.spi.impl.BasicInvocation$InvocationFuture.get(BasicInvocation.java:674)
        at com.hazelcast.mapreduce.impl.MapReduceService.processRequest(MapReduceService.java:224)
        at com.hazelcast.mapreduce.impl.MapReduceService.sendNotification(MapReduceService.java:231)
        at com.hazelcast.mapreduce.impl.task.ReducerTask.processProcessedState(ReducerTask.java:134)
        at com.hazelcast.mapreduce.impl.task.ReducerTask.run(ReducerTask.java:99)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask.run(FutureTask.java:262)
        at com.hazelcast.util.executor.CompletableFutureTask.run(CompletableFutureTask.java:57)
        at com.hazelcast.util.executor.CachedExecutorServiceDelegate$Worker.run(CachedExecutorServiceDelegate.java:186)
        ... 4 more
Caused by: com.hazelcast.spi.exception.TargetNotMemberException: Not Member! target:Address[146.193.41.145]:5701, partitionId: -1, operation: com.hazelcast.mapreduce.impl.operation.FireNotificationOperation, service: hz:impl:mapReduceService
        at com.hazelcast.spi.impl.BasicInvocation.doInvoke(BasicInvocation.java:328)
        at com.hazelcast.spi.impl.BasicInvocation.access$900(BasicInvocation.java:62)
        at com.hazelcast.spi.impl.BasicInvocation$ReInvocationTask.run(BasicInvocation.java:547)
        ... 4 more
Number of Jobs: 0
Number of Mappers: 0
Number of Combiners: 0
Number of Reducers: 16062
Invocations of Map(): 0
Invocations of Combine() : 0
Invocations of Reduce(): 12909456

---

The time taken for the simulation: 9896.069 s.
The time taken for the initialization: 7.404000000000451 s.
The total time taken for the execution: 9903.473 s.
