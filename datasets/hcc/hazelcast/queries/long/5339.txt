Here is a simple mostly failing test.

```
@Test
    public void testWriteBehindUponMigration() throws Exception {
        MapStoreTest.SimpleMapStore<Integer, Integer> store 
                = new MapStoreTest.SimpleMapStore<Integer, Integer>();
        store.store.put(1, 0);

        Config config = createConfig(store);
        HazelcastInstance node1 = factory.newHazelcastInstance(config);

        IMap<Integer, Integer> map = node1.getMap(mapName);

        map.put(1, 1);
        map.delete(1);

        HazelcastInstance node2 = factory.newHazelcastInstance(config);

        map = node2.getMap(mapName);

        Integer value = map.get(1);
        factory.shutdownAll();

        assertNull(value);
    }


    private static Config createConfig(MapStoreTest.SimpleMapStore store) {
        MapStoreConfig mapStoreConfig = new MapStoreConfig();
        mapStoreConfig
                .setImplementation(store)
                .setWriteDelaySeconds(100)
                .setWriteBatchSize(1)
                .setWriteCoalescing(false);

        Config config = new Config();
        config.getMapConfig(mapName)
                .setBackupCount(1)
                .setMapStoreConfig(mapStoreConfig);

        return config;
    }
```
