instead of key based marking partition based approach can be used