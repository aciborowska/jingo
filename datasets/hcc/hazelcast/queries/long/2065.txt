```
@Test
    public void testClientNearCacheStaleData() {
        final HazelcastInstance server = Hazelcast.newHazelcastInstance();

        final ClientConfig clientConfig = new ClientConfig();
        clientConfig.getNetworkConfig().setSmartRouting(false);

        clientConfig.addNearCacheConfig("map*", new NearCacheConfig().setInMemoryFormat(InMemoryFormat.OBJECT));

        final HazelcastInstance client = HazelcastClient.newHazelcastClient(clientConfig);

        final IMap<String,String > map = client.getMap("map1");

        for (int i = 1; i < 100; i++) {
            String key = "key" + i;
            String value = "value" + i;

            String value0 = map.put(key, value);
            String value1 = map.get(key); // this brings the value into the NearCache
            String value2 = map.remove(key);
            String value3 = map.get(key); // one can see stale value

            assertNull(value0);
            assertEquals(value, value1);
            assertEquals(value, value2);
            assertNull(value3);
        }
    }
```
