Currently we don't send heartbeats for pending operations. So if you have an operation that takes a lot of time e..g a map loader, it will cause failures for every operation that is parked for that partition.

The best way to get strict control on waiting time for an invocation is future.get(timeout). 

We don't need to deserialize the operations to get the call id; we can just peek in the byte-stream.

The main problem is the operation queue isn't threadsafe. Once the operation thread takes operations in a batch; and these operations are currently not visible for external threads. So the invocation monitor can't see these. But this shouldn't be that difficult to address.