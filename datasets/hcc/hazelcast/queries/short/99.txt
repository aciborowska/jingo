Concurrent queue.take and txn.rollback issue