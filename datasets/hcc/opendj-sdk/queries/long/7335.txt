Found with 7.0.0-SNAPSHOT rev. ac6849f4e45 and 6.5.3.

Test steps:

	Setup topology of three servers (6.5.3) DSRS-RS-DS [replication enabled and in sync]
	Setup and do not start DSRS, DS and RS servers (7.0.0)
	Configure 7.0.0 servers to be compatible with 6.5.3 (serverId, set-password-storage-scheme-prop [Salted SHA-512], set-password-policy-prop [Salted SHA-512])

./DJ/opendj/bin/dsconfig --offline set-global-configuration-prop --set server-id:3 -n
./DJ/opendj/bin/dsconfig --offline set-password-storage-scheme-prop --scheme-name "Salted SHA-512" --set enabled:true -n
./DJ/opendj/bin/dsconfig --offline set-password-policy-prop --policy-name "Default Password Policy" --add default-password-storage-scheme:"Salted SHA-512" --remove default-password-storage-scheme:PBKDF2-HMAC-SHA256 -n






	run dsrepl add-local-server... command on 7.0.0 (DSRS)

./DJ/opendj/bin/dsrepl add-local-server-to-pre-7-0-topology -h pyforge.example.com -p 4447 -D "cn=admin,cn=Administrators,cn=admin data" -w "password" -X --baseDn "dc=com"






	start the server
	initialize the server

dsrepl initialize --fromServer 4 -h pyforge.example.com -p 4449 -D "uid=admin" -w password -X --baseDn "cn=admin data" --baseDn "cn=schema" --baseDn "dc=com"






	run dsrepl add-local-server... command on 7.0.0 (DS)

./DJ/opendj/bin/dsrepl add-local-server-to-pre-7-0-topology -h pyforge.example.com -p 4447 -D "cn=admin,cn=Administrators,cn=admin data" -w "password" -X --baseDn "dc=com"





Last step fails with Invalid Credentials error:

stderr 

Cannot obtain a connection for one of the servers in the existing topology.
 The error was: RuntimeException(com.forgerock.opendj.cli.ClientException:
 Cannot obtain a connection to server 'pyforge.example.com:4449' from the
 existing topology. The error was: Invalid Credentials)
 Check the server error logs for additional details


stdout

Establishing connections ..... Done
 Checking registration information ..... Done
 Configuring the servers in the topology to talk to the local server .....


 

The pyforge.example.com:4449 is previously added DSRS 7.0.0 server.

 

Command to reproduce:

./run-pybot.py -v -s replication_group3.MixedTopologies -t complex_topo_added_to_dsrs_ds_topo opendj

