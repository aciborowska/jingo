When adding a new DS server to an existing DS/RS topology, the new DS server points to the RS that the server is originally configured to. If that DS/RS is shutdown the new DS stops responding to requests.

 

Scripts are attached: 

	ds6.5.3-replicated.sh will create 6.5 replicated environment
	ds7.sh will install new ds6 and join 6.5 topology



 

I have an existing 6.5 topology with DS1/RS1 and DS2/RS2

Create new DS7 server DS3

Add DS7 to pre-7 topology pointing to DS1 with command 

 ./dsrepl \
 add-local-server-to-pre-7-0-topology \
 --hostname idrepo1.example.com \
 --port 24444 \
 --bindDn "cn=directory manager" \
 --bindPassword password \
 --baseDn ou=identities \
 --trustAll \
 --no-prompt


Start Server log reports - Directory server DS(3) has connected to replication server RS(1) for domain “ou=identities” 

Initialise DS3 from DS1  with command - 

 ./dsrepl \
 initialize \
 --fromServer 1 \
 --hostname idrepo3.example.com \
 --port 54444 \
 --bindDn "cn=directory manager" \
 --bindPassword password \
 --trustAll \
 --baseDn "cn=admin data" \
 --baseDn "ou=identities" \
 --baseDn "cn=schema"


dsrepl status shows:

~/opends/ds_instances/idrepo3/opendj/bin/dsrepl \
 status \
 --hostname idrepo3.example.com \
 --port 54444 \
 --bindDn "cn=directory manager" \
 --bindPassword password \
 --trustAll \
 --showReplicas \
 --showChangelogs \
 --no-prompt
  
 Base DN / RS / DS Status Receive Replay
 delay (ms) delay (ms)
 -------------------------------------------------
 ou=identities
 └─ RS/1
 └─ DS/3 OK 0 0


Also :

If DS1/RS1 is shut down, DS3 stops responding to updates - this is a major issue

Restarting DS3 does not fix the issue.