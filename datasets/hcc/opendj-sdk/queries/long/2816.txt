Found with OpenDJ 4.0.0 rev f91a480df0a08c9286dcb508e1adb78602d02114

We setup a server with a pdb backends and some auto-generated entries.

./opendj/setup -h localhost -p 1389 -D cn=myself -w password --adminConnectorPort 4444 -Z 1636 --generateSelfSignedCertificate -b dc=com -t pdb -d 10 --cli -n



Then we try renaming it but it fails with teh following error:

./opendj/bin/ldapmodify -h localhost -p 1389 -D cn=myself -w password
dn: uid=user.1,ou=people,dc=com
changetype: modrdn
newrdn: uid=Changed user.1
deleteoldrdn: 1
MODIFY DN operation failed
Result Code:  80 (Other)
Additional Information:  An error occurred while attempting to store compressed schema information in the database: OpenDJ does not support transactions nested in a write transaction. Code is forbidden from opening one.



This is a regression compared to 3.0.0 and it works fine with je backend.

script in attachment to reproduce the issue.

