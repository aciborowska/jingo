Found with Opendj 4.0.0 rev 392efa06173

Scenario:


	We setup 2 servers, with data, replicated
	We setup a proxy in static discovery mechanism service:

./DJ_PROXY1/opendj/bin/dsconfig -h localhost -p 4449 -D "cn=myself" -w password -X create-service-discovery-mechanism --mechanism-name static --type static -X --set primary-server:localhost:1392 --set primary-server:localhost:1393 -n

./DJ_PROXY1/opendj/bin/dsconfig -h localhost -p 4449 -D "cn=myself" -w password -X create-backend --set proxy-dn:cn=myself --set proxy-password:password --set route-all:true --set service-discovery-mechanism:static --set load-balancing-algorithm:affinity --type proxy --backend-name proxy --set enabled:true -n






	We check we can query dc=example,dc=com through the proxy to validate this configuration
	We create new backends on each of the replicated DJs, and create a new suffix dc=org, with some data in it and enable replication of this suffix.
	We change the settings so that the proxy only route dc=org:

./DJ_PROXY1/opendj/bin/dsconfig -h localhost -p 4449 -D "cn=myself" -w password -X set-backend-prop --backend-name proxy --set route-all:False --set base-dn:dc=org -n






	We try to search for dc=org through the proxy, it is routed correctly:

/DJ_PROXY1/opendj/bin/ldapsearch -h localhost -p 1394 -D "cn=myself" -w password -b "dc=org" --countEntries "(objectclass=*)" dn

...
 "# Total number of matching entries: 52" 





And no matter how long we wait, we can still retrieve the entries under dc=example,dc=com, whilst we were expecting that the request would not be forwarded anymore.

The same test with a replication discovery mechanism, at the opposite, fails to retrieve anything under dc=org nor dc=example,dc=com after the changes have been made.