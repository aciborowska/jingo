rebuild-index is using the JVM free heap space as basis to dimension off-heap buffers. While inconsistent, it should not problematic in most cases since JVM usually have enough free memory to return a big-enough value.

Solution is to port the --offHeapSize setting from the import-ldif to rebuild-index.