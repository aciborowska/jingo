Found using OpenDJ 6.5.0-SNAPSHOT (rev c98928122a6).

Scenario

	install a server
	create an index

$ ./DJ1/opendj/bin/dsconfig -h localhost -p 4447 -D "cn=myself" -w password -X set-backend-index-prop --backend-name userRoot --index-name uid --remove index-type:substring -n	
20:23:22.892	INFO	SUCCESS:
-- rc --
returned 0, effectively in [0]
-- stdout --

-- stderr --


	rebuild index online

$ ./DJ1/opendj/bin/rebuild-index -h localhost -p 4447 -D "cn=myself" -w password -X -b dc=com -i uid
-- rc --
returned 1, expected to be in [0]
-- stdout --
Rebuild Index task 20181023182324402 scheduled to start immediately
[23/Oct/2018:18:23:24 +0000] severity="NOTICE" msgCount=0 msgID=org.opends.messages.backend-413 message="Rebuild Index task 20181023182324402 started execution"
[23/Oct/2018:18:23:24 +0000] severity="NOTICE" msgCount=1 msgID=org.opends.messages.backend-370 message="The backend userRoot is now taken offline"
[23/Oct/2018:18:23:24 +0000] severity="INFORMATION" msgCount=2 msgID=org.opends.messages.backend-410 message="JE backend 'userRoot' does not specify the number of cleaner threads: defaulting to 2 threads"
[23/Oct/2018:18:23:24 +0000] severity="INFORMATION" msgCount=3 msgID=org.opends.messages.backend-411 message="JE backend 'userRoot' does not specify the number of lock tables: defaulting to 13"
[23/Oct/2018:18:23:24 +0000] severity="NOTICE" msgCount=4 msgID=org.opends.messages.backend-542 message="Rebuild of index(es) uid.caseIgnoreMatch started with 13 total entries to process"
[23/Oct/2018:18:23:24 +0000] severity="ERROR" msgCount=5 msgID=org.opends.messages.tool-852 message="An error occurred while attempting to perform index rebuild:  Insufficient free memory (12440593171 bytes) to perform import. At least 8192 bytes of free memory is required (id=org.opends.messages.backend-438)"
[23/Oct/2018:18:23:24 +0000] severity="ERROR" msgCount=6 msgID=org.opends.messages.config-422 message="The Directory Server was unable to acquire a shared lock for backend userRoot: The attempt to obtain a shared lock on file /root/workspace/OpenDJ-6.5.x/tests_full_linux/results/20181023-151507/indexes_group/DJ1/opendj/locks/backend-userRoot.lock was rejected because an exclusive lock was already held on that file. This generally means that the backend is in use by a process that requires an exclusive lock (e.g., importing from LDIF or restoring a backup). This backend will be disabled"
[23/Oct/2018:18:23:24 +0000] severity="ERROR" msgCount=7 msgID=null--1 message="Constraint Violation: The Directory Server was unable to acquire a shared lock for backend userRoot: The attempt to obtain a shared lock on file /root/workspace/OpenDJ-6.5.x/tests_full_linux/results/20181023-151507/indexes_group/DJ1/opendj/locks/backend-userRoot.lock was rejected because an exclusive lock was already held on that file. This generally means that the backend is in use by a process that requires an exclusive lock (e.g., importing from LDIF or restoring a backup). This backend will be disabled"
[23/Oct/2018:18:23:24 +0000] severity="NOTICE" msgCount=8 msgID=org.opends.messages.backend-414 message="Rebuild Index task 20181023182324402 finished execution in the state Stopped by error"
[23/10/2018:18:23:25 +0000] category=SDK seq=0 severity=FINE msg=LdapClientImpl 'org.forgerock.opendj.ldap.LdapClientImpl@a776e' is closing while 1 active connections remain

-- stderr --
Rebuild Index task 20181023182324402 did not complete successfully





To reproduce the issue:

$ ./run-pybot.py -s clu_group.RebuildIndex -t Online_Mode -v OpenDJ

