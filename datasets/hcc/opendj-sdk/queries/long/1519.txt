PasswordPolicyState.handleDeprecatedStorageSchemes() tries to fail fast, but in fact succeeds slowly because it tests the wrong list of schemes.

It should be calling getDeprecatedPasswordStorageSchemes().isEmpty() instead of getDefaultPasswordStorageSchemes().isEmpty().

This causes an additional password match to take place for every password value.