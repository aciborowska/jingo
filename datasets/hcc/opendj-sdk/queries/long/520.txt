Each LDAPClientConnection caches a single ASN1Writer for each worker thread. In addition, the JE backend also caches several entry encoding/decoding buffers for each worker thread.

These buffers grow in order to accommodate the largest entries/messages and are only released when a) the client connection is closed (in the case of the per connection buffers) or when a worker threads is stopped (usually only when the server is shutdown in practice).

If a client accesses large entries, such as groups, multiple times then it is quite possible that the resulting large cached buffers will severely impact server performance and possibly even cause the server to run out of heap.

The server should be a little more intelligent about how it caches these buffers. For example, it could set a threshold size at which large cached buffers are automatically shrunk after use.