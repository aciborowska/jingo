When I tried to enable replication with "interactive mode" I ended with SSL handshake error message. I used 2 servers and I used server 2 as source. The 1st server is configured without entries and only with base-dn . The second server is configured with automatically generated entries (200) and with same base-dn as 1st server (No SSL enabled, no ldaps port configured).
I was using a DJ in version 4.0.0 with revision 771b5114fd07971a63c73d78b1a3161e6088d9a1 .

Steps to reproduce:

	Setup 2 servers

./dj1/opendj/setup --hostname pyforge.example.com --ldapPort 1389 --adminConnectorPort 4444 -b dc=example,dc=com --rootUserDN cn=myself --rootUserPassword password
Validating parameters .....Done.
Configuring Certificates .....Done.
Configuring server .....Done.
Starting Directory Server .............Done.

To see basic server status and configuration, you can launch
/home/ondrej/playground/test-dsreplication-enable/dj1/opendj/bin/status
------------------
./dj2/opendj/setup --hostname pyforge.example.com --ldapPort 1390 --adminConnectorPort 4445 -b dc=example,dc=com --rootUserDN cn=myself --rootUserPassword password -d 200

Validating parameters .....Done.
Configuring Certificates .....Done.
Configuring server .....Done.
Importing Automatically-Generated Data (200 Entries) .............Done.
Starting Directory Server ...............Done.

To see basic server status and configuration, you can launch
/home/ondrej/playground/test-dsreplication-enable/dj2/opendj/bin/status


	Try to enable replication from server 1, provide server 2 as source

./dj1/opendj/bin/dsreplication 
What do you want to do?

    1)  Enable Replication
    2)  Disable Replication
    3)  Initialize Replication on one Server
    4)  Initialize All Servers
    5)  Pre External Initialization
    6)  Post External Initialization
    7)  Display Replication Status
    8)  Purge Historical
    9)  Re-synchronizes the change-log changenumber on one server with the
        change-log changenumber of another.

    c)  cancel

Enter choice: 1


>>>> Specify server administration connection parameters for the first server

Directory server hostname or IP address [ondrej-pq]: pyforge.example.com

Directory server administration port number [4444]: 4445

How do you want to trust the server certificate?

    1)  Automatically trust
    2)  Use a truststore
    3)  Manually validate

Enter choice [3]: 

Global Administrator User ID, or bind DN if no Global Administrator is defined
[admin]: cn=myself

Password for user 'cn=myself': 

Server Certificate:



User DN  : CN=pyforge.example.com, O=OpenDJ RSA Self-Signed Certificate
Validity : From 'Fri Feb 03 07:20:52 CET 2017'
             To 'Thu Jan 29 07:20:52 CET 2037'
Issuer   : CN=pyforge.example.com, O=OpenDJ RSA Self-Signed Certificate


Do you trust this server certificate?

    1)  No
    2)  Yes, for this session only
    3)  Yes, also add it to a truststore
    4)  View certificate details

Enter choice [2]: 
Replication port for the first server (the port must be free) [8989]: 8899

Do you want replication to use encrypted communication when connecting to
replication port 8899 on the first server? (yes / no) [no]: 



>>>> Specify server administration connection parameters for the second server

Directory server hostname or IP address [ondrej-pq]: pyforge.example.com

Directory server administration port number [4444]: 4444

How do you want to trust the server certificate?

    1)  Automatically trust
    2)  Use a truststore
    3)  Manually validate

Enter choice [3]: 

Global Administrator User ID, or bind DN if no Global Administrator is defined
[admin]: cn=myself

Password for user 'cn=myself': 

Server Certificate:



User DN  : CN=pyforge.example.com, O=OpenDJ RSA Self-Signed Certificate
Validity : From 'Fri Feb 03 07:19:49 CET 2017'
             To 'Thu Jan 29 07:19:49 CET 2037'
Issuer   : CN=pyforge.example.com, O=OpenDJ RSA Self-Signed Certificate


Do you trust this server certificate?

    1)  No
    2)  Yes, for this session only
    3)  Yes, also add it to a truststore
    4)  View certificate details

Enter choice [2]: 
Replication port for the second server (the port must be free) [8989]: 9988

Do you want replication to use encrypted communication when connecting to
replication port 9988 on the second server? (yes / no) [no]: 

Global Administrator must be created.
You must provide the credentials of the Global Administrator that will be
created to manage the server instances that are being replicated.
Global Administrator User ID [admin]: admin

Global Administrator Password: 

Confirm Password: 


You must choose at least one Base DN to be replicated.
Replicate base DN dc=example,dc=com? (yes / no) [yes]: 

Establishing connections ..... 
Error reading data from server pyforge.example.com:4444.  There is an error
with the certificate presented by the server.
Details: Server Connection Closed: An error occurred during establishment of a
connection: org.forgerock.opendj.ldap.LdapException: Local Error: SSL
handshake failed





Current behavior:
The dsreplication enable in interactive mode throw an error with SSL handshake.
However a correct command in non-interactive mode enables the replication without problem.

The non-interactive command

./dj1/opendj/bin/dsreplication  enable  --adminUID admin  \
--adminPassword password  \ 
--baseDN dc=example,dc=com  \
--host1 pyforge.example.com  \ 
--port1 4445  \ 
--bindDN1 "cn=myself" \
--bindPassword1 password \ 
--replicationPort1 8899 \
--host2 pyforge.example.com \ 
--port2 4444 \
--bindDN2 "cn=myself" \ 
--bindPassword2 password \
--replicationPort2 9988 \ 
--trustAll \ 
--no-prompt

Establishing connections ..... Done.
Checking registration information ..... Done.
Configuring Replication port on server pyforge.example.com:4445 ..... Done.
Configuring Replication port on server pyforge.example.com:4444 ..... Done.
Updating replication configuration for baseDN dc=example,dc=com on server
pyforge.example.com:4445 .....Done.
Updating replication configuration for baseDN dc=example,dc=com on server
pyforge.example.com:4444 .....Done.
Updating registration configuration on server pyforge.example.com:4445 ..... Done.
Updating registration configuration on server pyforge.example.com:4444 ..... Done.
Updating replication configuration for baseDN cn=schema on server
pyforge.example.com:4445 .....Done.
Updating replication configuration for baseDN cn=schema on server
pyforge.example.com:4444 .....Done.
Initializing registration information on server pyforge.example.com:4444 with
the contents of server pyforge.example.com:4445 .....Done.
Initializing schema on server pyforge.example.com:4444 with the contents of
server pyforge.example.com:4445 .....Done.

Replication has been successfully enabled.  Note that for replication to work
you must initialize the contents of the base DNs that are being replicated
(use dsreplication initialize to do so).

See /tmp/opendj-replication-6772256087757730608.log for a detailed log of this
operation.



Expected behavior:
I expect same behavior with interactive mode as with non-interactive mode.