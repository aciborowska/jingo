Connection pools used for bind operations will typically use a heartbeat as well. If the heartbeat is sent at the same time as a bind or starttls then an error will occur since no operation can be performed concurrently with bind or starttls operations.

Therefore the hbcf should serialize heartbeats with bind/starttls requests. An obvious approach is to use a read-write lock. Even a simple lock should do since binds/starttls can only be performed one at a time anyway.