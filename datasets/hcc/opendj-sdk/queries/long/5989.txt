When testing improvement OPENDJ-5727 I noticed that ou=tokens is hardcoded in setup-profiles/AM/cts/6.5/base-entries.ldif.  I used 6.5.1-RC1.

The setup works with custom baseDN when it is organizationUnit type like:


./dj-after-fix-master/opendj/setup \ 
--rootUserDn cn=Directory\ Manager \
--rootUserPassword wwwpppwww \
--hostname fuchsik-pq \
--adminConnectorPort 4444 \
--ldapPort 1389 \
--enableStartTls \
--ldapsPort 1636 \
--httpsPort 8443 \
--profile am-cts \ 
--set am-cts/amCtsAdminPassword:wwwpppwww \
--set am-cts/tokenExpirationPolicy:am \
--set am-cts/baseDn:ou=tokens 

Validating parameters..... Done
Configuring certificates..... Done
Configuring server..... Done
Configuring profile AM CTS data store...... Done
Starting directory server............. Done

To see basic server status and configuration, you can launch
/home/fuchsik/forks/pyforge/archives/dj-after-fix-master/opendj/bin/status



When it is different than default one like ou=test:

./dj-after-fix-master/opendj/setup \ 
--rootUserDn cn=Directory\ Manager \
--rootUserPassword wwwpppwww \
--hostname fuchsik-pq \
--adminConnectorPort 4444 \
--ldapPort 1389 \
--enableStartTls \
--ldapsPort 1636 \
--httpsPort 8443 \
--profile am-cts \
--set am-cts/amCtsAdminPassword:wwwpppwww \
--set am-cts/tokenExpirationPolicy:am \
--set am-cts/baseDn:ou=test 

Validating parameters..... Done
Configuring certificates..... Done
Configuring server..... Done
Configuring profile AM CTS data store....... Done
Starting directory server............ Done

To see basic server status and configuration, you can launch
/home/fuchsik/forks/pyforge/archives/dj-after-fix-master/opendj/bin/status



It works but there is still attribute ou=tokens see this ADS output (in the attachment).

When it is for instance dc=test it doesn't work:


./dj-after-fix-master/opendj/setup \ 
--rootUserDn cn=Directory\ Manager \
--rootUserPassword wwwpppwww \
--hostname fuchsik-pq \
--adminConnectorPort 4444 \
--ldapPort 1389 \
--enableStartTls \
--ldapsPort 1636 \
--httpsPort 8443 \
--profile am-cts \
--set am-cts/amCtsAdminPassword:wwwpppwww \
--set am-cts/tokenExpirationPolicy:am \
--set am-cts/baseDn:dc=test

Validating parameters..... Done
Configuring certificates..... Done
Configuring server..... Done
Configuring profile AM CTS data store.......Error......
The 'AM CTS data store' setup profile failed: Unable to import data (tool exit
with error return code '1')
See /tmp/opendj-setup-312778633082033742.log for a detailed log of the failed
operation.
Please report this error and provide the log file mentioned above.



In the improvement's comments, there is mentioned for instance dc=swisssign,dc=com that's why I started to complain about the functionality.

ATM there is no automated test but I will add one soon.