LDAPClientConnection extracts SSF/certificate etc information from the last established connection security provider.

This is not helpful if you have multiple layers installed - eg TLS and SASL confidentiality. In this case the SSF used in access control should be a combination of the 2 effective SSFs - probably the maximum of the two.

Having a "last established connection security provider" doesn't seem like a useful thing. If you connect with SASL confidentiality and then do StartTLS, you will end up with a different provider (a TLSByteChannel) than if you connect over TLS and then establish a SASL confidentiality layer (a SASLByteChannel). In both of these cases the actual protocol layering is correct, but the SSF/certificate etc information is inconsistent.