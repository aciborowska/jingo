Blowfish passwords hashed on instances from other environments require the symmetric-key to decode.

Scenario: 

Environment 1 uses a Blowfish storage scheme for all entries. If you export Environment 1 to ldif and import this into Environment 2, all authentications on Environment 2 will fail.

In order to get authentications to work, the following elements must be added to the new environment.

1) The Environment 1 key pair(s) must be added to the ads-truststore or the ads-truststore (+ pin) file can be copied into Environment 2.

2) The symmetric-key entry from Environment 1 must be added to the admin-backend.ldif from Environment 2.

 

dn: ds-cfg-key-id=4d6ad198-5a9d-4236-bde7-aaec277a92b4,cn=secret keys,cn=admin data
objectClass: top
objectClass: ds-cfg-cipher-key
ds-cfg-symmetric-key: 204EECDC91D6773C930174E3A0CB3B01:RSA/ECB/OAEPWITHSHA-1ANDMGF1PADDING:Blowfish:89E60E7162DDF700F572B163872837ED2EADC0C83339A294FCBFF45478540982DAB11A0E37A4D3B4C0788DFE7DD95394E66223D18E66971D2E425602CB3D1D1FE946187D0931EB6467E379FB4BF73A30AD3C6E6EDBFF73B69DDF9E1D91E30B799832DAC1BD20DB144FFB60D95694C75FE6B01362664ED70AF374956B6CFDCECF289E2B909722B169CA55A57C53A074F09F2BB8C61663BD8F3C9F53B1A1DB79C9E62D0F853733802E4B0C53A936FAD6FA0AE86D2D1C69EF36BAD55C11D766C0F57539E563070F1AF5F21E85E6442C09021E99261FFB6CF00E895FD1B0807485780A44338B42DAD428A80B29954F6610E5B8DFCD009D92451A7DC435461AFE2C41
ds-cfg-symmetric-key: 1ED39480BF18BFB871D3523C24B71ABA:RSA/ECB/OAEPWITHSHA-1ANDMGF1PADDING:Blowfish:88FEA11DC5EC645F8C06DC4366B66574BE2B7735424261BB74E024889B33F2115ABAC6228F3E02C2FBB02A946EC2A670F272B282E7702B7FCBFB5EC5939DB54271A9BA04F552195C102A51C65697A6DB679D094C7EB0A5EAE1A8AC2E3D1B96DA59B2B52B4926D58F15F4D76C7BA7D9358EAD8EC42E9D41ADE204794208BC650B4EB080CF5C316CCA31793AC7591106A381C29BCE8699491BC5FEA41D1F9878F12AAEDEEC234AE6B1197380176D5BA9EC6D17870CDDCF8CD9FFE2F69F3C0475102E939FFB1C785C10297FFA578AB3D0D563FDB0291D9790B8B58DC889CD276C55FFB49EF99281C53A0390EEC1F61E872EF7CFB7638C9340B27AB57EA5A3EFC6B9
ds-cfg-initialization-vector-length-bits: 64
ds-cfg-key-length-bits: 128
ds-cfg-key-id: 4d6ad198-5a9d-4236-bde7-aaec277a92b4
ds-cfg-cipher-transformation-name: Blowfish/CFB/NoPadding
creatorsName: cn=Internal Client,cn=Root DNs,cn=config
ds-sync-hist: dn:000001610ec5c0cc002b00000003:add
entryUUID: 307b4253-9075-4941-ac73-694ab57246f2
createTimestamp: 20180119141456Z

 

Note: Environment 1 and Environment 2 are different replication topologies, and replication is never configured between them.