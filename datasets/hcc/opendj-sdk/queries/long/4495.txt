Found with 6.0.0 rev 3315122b276fe3a6a17a40259a3417e58acb4547

Scenario:

1) We set up a server and import some data in it:

/tmp/6.0.0/opendj/setup directory-server -h localhost -p 1389 -D "cn=Directory Manager" -w password --adminConnectorPort 4445 -Z 1636 -b dc=com

/tmp/6.0.0/opendj/bin/import-ldif -h localhost -p 4445 -D "cn=Directory Manager" -w password -X -n userRoot -O  -l /tmp/data/security_group/pwd_storage_startup.ldif

/tmp/6.0.0/opendj/bin/ldapmodify -h localhost -p 1389 -D "cn=Directory Manager" -w password  -f /local/GIT/pyforge/PyBot/OpenDJ/testcases/data/security_group/sasl_startup.ldif



2) We set default-password-storage-scheme to Clear


/tmp/6.0.0/opendj/bin/dsconfig -h localhost -p 4445 -D "cn=Directory Manager" -w password -X set-password-policy-prop --policy-name "Default Password Policy" --set "default-password-storage-scheme:Clear" -n



3) admin modifies the password of 2 users:


/tmp/6.0.0/opendj/bin/ldapmodify -h localhost -p 1389 -D "cn=Directory Manager" -w password
dn: uid=jwalleye, ou=People, o=SASL Realm Tests, dc=example,dc=com
changetype: modify
replace: userpassword
userpassword: frogleg

/tmp/6.0.0/opendj/bin/ldapmodify -h localhost -p 1389 -D "cn=Directory Manager" -w password
dn: uid=jcarp, ou=People, o=SASL Tests, dc=example,dc=com
changetype: modify
replace: userpassword
userpassword: carpleg



4) We test ldapsearch with this DIGEST-MD5 sasl mechanism without authid:

EXPECTED:  RC=89 
GOT: RC=1 and null printed out on stderr:


$ /tmp/6.0.0/opendj/bin/ldapsearch -h localhost -p 1389 -w frogleg -b "dc=com" -o mech=DIGEST-MD5 -o authzid=jcarp "(objectclass=*)"
null

$ echo $?
1

