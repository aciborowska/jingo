Test case:


	Create instance hostA/DS1 with base DN dc=example,dc=com
	Create instance hostA/RS1 with no base DNs
	Create instance hostB/RS2 with no base DNs




	Enable replication between DS1 -> RS2



./bin/dsreplication enable --host1 hostA --port1 4444 --bindDN1  "cn=directory manager" --bindPassword1 password --noReplicationServer1 --host2 hostB --port2 4444 --bindDN2 "cn=directory manager" --bindPassword2 password --onlyReplicationServer2 --replicationPort2 8989 --adminUID admin --adminPassword password --baseDN "dc=example,dc=com" -X -n


	Enable replication between DS1 -> RS1



./bin/dsreplication enable --host1 hostA --port1 4444 --bindDN1  "cn=directory manager" --bindPassword1 password --noReplicationServer1 --host2 hostA --port2 5444 --bindDN2 "cn=directory manager" --bindPassword2 password --onlyReplicationServer2 --replicationPort2 8989 --adminUID admin --adminPassword password --baseDN "dc=example,dc=com" -X -n

Observe that DS1 is connected to RS2:

On hostA: lsof -p $(jps -m | grep <path-to-DS1> | cut -d" " -f 1) -n|grep TCP

Now break connection between hostA and hostB. DS1 switches to RS1 automatically, but repeatedly disconnects/reconnects. In addition it leaks connections (and Sockets) very quickly, ultimately resulting in server failure.

This is easily repeatable and a show-stopper.