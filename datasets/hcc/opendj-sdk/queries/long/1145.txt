I use a couple of OpenDJ 2.6 servers over RHEL 6.4 with OpenJDK 1.7:

java version "1.7.0_25"
OpenJDK Runtime Environment (rhel-2.3.10.4.el6_4-x86_64)
OpenJDK 64-Bit Server VM (build 23.7-b01, mixed mode)

The problem I have is that I can't setup MMR between the servers. The first 
one is loaded with data, the second one is empty.

When I run "./dsreplication enable --trustAll" on the loaded server, I get 
the following error:


Establishing connections ..... Done.
Checking registration information ..... Done.
Configuring Replication port on server identite.univ-lyon2.fr:1444 ..... Done.
Configuring Replication port on server identite2.univ-lyon2.fr:1444 ..... 
Done.
Updating replication configuration for baseDN dc=univ-lyon2,dc=fr on server 
identite.univ-lyon2.fr:1444 ..... Done.
Updating replication configuration for baseDN dc=univ-lyon2,dc=fr on server 
identite2.univ-lyon2.fr:1444 ..... Done.
Updating registration configuration on server identite.univ-lyon2.fr:1444 
..... Done.
Updating registration configuration on server identite2.univ-lyon2.fr:1444 
..... Done.
Updating replication configuration for baseDN cn=schema on server 
identite.univ-lyon2.fr:1444 ..... Done.
Updating replication configuration for baseDN cn=schema on server 
identite2.univ-lyon2.fr:1444 ..... Done.
Initializing registration information on server 
identite2.univ-lyon2.fr:1444 with the contents of server 
identite.univ-lyon2.fr:1444 .....
Error during the initialization with contents from server
identite.univ-lyon2.fr:1444.  Last log details: [13/Sep/2013:14:11:31 +0200]
severity="NOTICE" msgCount=0 msgID=9896349 message="Initialize From Replica
task quicksetup-initialize6 started execution".  Task state: STOPPED_BY_ERROR.
Check the error logs of identite.univ-lyon2.fr:1444 for more information.
See /tmp/opendj-replication-8392011901286834778.log for a detailed log of this
operation.


The /tmp/opendj-replication... file has the following content:

INFO: [13/Sep/2013:14:11:31 +0200] severity="NOTICE" msgCount=0 
msgID=9896349 message="Initialize From Replica task quicksetup-initialize6 
started execution"
Sep 13, 2013 2:11:16 PM org.opends.quicksetup.installer.Installer 
initializeSuffix
INFO: Last task entry: : 
null:null:
{ds-task-unprocessed-entry-count=ds-task-unprocessed-entry-count: 
0, ds-task-state=ds-task-state: STOPPED_BY_ERROR, 
ds-task-log-message=ds-task-log-message: [13/Sep/2013:14:11:31 +0200] 
severity="NOTICE" msgCount=0 msgID=9896349 message="Initialize From Replica 
task quicksetup-initialize6 started execution", [13/Sep/2013:14:11:32 
+0200] severity="INFORMATION" msgCount=1 msgID=-1 message="Domain cn=admin 
data: the server with serverId=25577 is unreachable In Replication 
Server=Replication Server 8989 19123 unroutable message 
=InitializeRequestMsg Details:routing table is empty", 
[13/Sep/2013:14:11:32 +0200] severity="NOTICE" msgCount=2 msgID=9896350 
message="Initialize From Replica task quicksetup-initialize6 finished 
execution", ds-task-processed-entry-count=ds-task-processed-entry-count: 0}
Sep 13, 2013 2:11:16 PM org.opends.quicksetup.installer.Installer 
initializeSuffix
WARNING: Processed errorMsg: Error during the initialization with contents 
from server identite.univ-lyon2.fr:1444.  Last log details: 
[13/Sep/2013:14:11:31 +0200] severity="NOTICE" msgCount=0 msgID=9896349 
message="Initialize From Replica task quicksetup-initialize6 started 
execution".  Task state: STOPPED_BY_ERROR.  Check the error logs of 
identite.univ-lyon2.fr:1444 for more information.
Sep 13, 2013 2:11:16 PM org.opends.quicksetup.installer.Installer 
initializeSuffix
SEVERE: Throwing ApplicationException.
Sep 13, 2013 2:11:16 PM 
org.opends.server.tools.dsreplication.ReplicationCliMain enableReplication
SEVERE: Complete error stack:
org.opends.server.tools.dsreplication.ReplicationCliException: Error during 
the initialization with contents from server identite.univ-lyon2.fr:1444.  
Last log details: [13/Sep/2013:14:11:31 +0200] severity="NOTICE" msgCount=0 
msgID=9896349 message="Initialize From Replica task quicksetup-initialize6 
started execution".  Task state: STOPPED_BY_ERROR.  Check the error logs of 
identite.univ-lyon2.fr:1444 for more information.
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.initializeSuffix(ReplicationCliMain.java:8342)
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.updateConfiguration(ReplicationCliMain.java:6500)
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.enableReplication(ReplicationCliMain.java:4359)
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.enableReplication(ReplicationCliMain.java:666)
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.execute(ReplicationCliMain.java:503)
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.mainCLI(ReplicationCliMain.java:358)
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.main(ReplicationCliMain.java:289)
Caused by: Error during the initialization with contents from server 
identite.univ-lyon2.fr:1444.  Last log details: [13/Sep/2013:14:11:31 
+0200] severity="NOTICE" msgCount=0 msgID=9896349 message="Initialize From 
Replica task quicksetup-initialize6 started execution".  Task state: 
STOPPED_BY_ERROR.  Check the error logs of identite.univ-lyon2.fr:1444 for 
more information.
     at 
org.opends.quicksetup.installer.Installer.initializeSuffix(Installer.java:4733)
     at 
org.opends.server.tools.dsreplication.ReplicationCliMain.initializeSuffix(ReplicationCliMain.java:8318)
     ... 6 more

The error log file on the first server contains the following lines:

[13/Sep/2013:14:10:34 +0200] category=SYNC severity=NOTICE msgID=15138878 
msg=Directory server DS(32580) has connected to replication server RS(1074) 
for domain "dc=univ-lyon2,dc=fr" at 
identite.univ-lyon2.fr/159.84.64.102:8989 with generation ID 226445
[13/Sep/2013:14:10:44 +0200] category=SYNC severity=NOTICE msgID=15138878 
msg=Directory server DS(25577) has connected to replication server RS(1074) 
for domain "cn=admin data" at identite.univ-lyon2.fr/159.84.64.102:8989 
with generation ID 179044
[13/Sep/2013:14:11:05 +0200] category=SYNC severity=SEVERE_WARNING 
msgID=14811344 msg=Directory server DS(25054) was unable to connect to any 
replication servers for domain "cn=schema"
[13/Sep/2013:14:11:16 +0200] category=SYNC severity=SEVERE_ERROR 
msgID=14942386 msg=Directory server 25054 was attempting to connect to 
replication server 1074 but has disconnected in handshake phase
[13/Sep/2013:14:11:21 +0200] category=SYNC severity=NOTICE msgID=15138878 
msg=Directory server DS(25054) has connected to replication server RS(1074) 
for domain "cn=schema" at identite.univ-lyon2.fr/159.84.64.102:8989 with 
generation ID 8408

I've not asked for SSL or TLS for replication, both servers have 
self-signed certificates, so I don't understand why it seems to be a 
hanshake phase failure, maybe with the admin serv.
Anyway, it seems like I fall into some bug.

I also noticed 2 other bugs:


	I tried different parameters combination to setup replication, and
sometimes, I had "no suffix configured for replication" (or such like 
errors), while
the status command reported both servers had a backend configured for 
replication. I also tried to add the root entry to the server to be 
initialized, but it didn't change anything.




	When trying to stop the dsreplication script with ^C, it doesn't work,
the script still executes, but the terminal becomes near unuable which is 
boring.
Another shell must be started to kill the dsreplication process tree.

