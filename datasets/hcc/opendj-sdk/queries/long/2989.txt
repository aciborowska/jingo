Create a server with base o=example and 2000 entries (prob no important the number).

Add the following


dn: o=example
changetype: modify
add: aci
aci: (targetattr="postalAddress || postalCode || uid || description || employeeNumber || initials || givenName || pager || mobile || cn || telephoneNumber || sn || street || homePhone || mail || l || st")(version 3.0; acl "Allow Self Mods"; allow (write) userdn = "ldap:///self"; )



This search returns incorrect information, see below.


./bin/ldapsearch \
 --dontWrap \
 --control effectiverights \
 --getEffectiveRightsAuthzid "dn: uid=user.0,ou=People,o=example" \
 --getEffectiveRightsAttribute postalAddress --getEffectiveRightsAttribute postalCode --getEffectiveRightsAttribute uid \
--getEffectiveRightsAttribute description --getEffectiveRightsAttribute employeeNumber --getEffectiveRightsAttribute initials \
--getEffectiveRightsAttribute givenName --getEffectiveRightsAttribute pager --getEffectiveRightsAttribute mobile --getEffectiveRightsAttribute cn --getEffectiveRightsAttribute telephoneNumber \
--getEffectiveRightsAttribute sn --getEffectiveRightsAttribute street --getEffectiveRightsAttribute homePhone \
--getEffectiveRightsAttribute mail --getEffectiveRightsAttribute l --getEffectiveRightsAttribute st \
 --port 15389 \
 --bindDN "cn=directory manager" \
 --bindPassword qwerty \
 --baseDN "o=example" \
 "uid=user.0" \
 aclRights



postaladdress, postalcode and employeenumber are incorrect in the cut down extract below.


aclRights;attributeLevel;postaladdress: search:1,read:1,compare:1,write:0,selfwrite_add:0,selfwrite_delete:0,proxy:0
aclRights;attributeLevel;postalcode: search:1,read:1,compare:1,write:0,selfwrite_add:0,selfwrite_delete:0,proxy:0
aclRights;attributeLevel;uid: search:1,read:1,compare:1,write:1,selfwrite_add:1,selfwrite_delete:1,proxy:0
aclRights;attributeLevel;description: search:1,read:1,compare:1,write:1,selfwrite_add:1,selfwrite_delete:1,proxy:0
aclRights;attributeLevel;employeenumber: search:1,read:1,compare:1,write:0,selfwrite_add:0,selfwrite_delete:0,proxy:0



Doing the same search requesting the attributes as in a normal search works fine.

Initially found using the API.