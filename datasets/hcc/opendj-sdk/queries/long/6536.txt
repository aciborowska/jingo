Found with rev b3a29e49c308459023d29668aa4fecd861cd8cb4
was working with rev  	OpenDJ 7.0.0-SNAPSHOT (3a762502b88)

We set up 3 servers, installing them in 5.0.0 and directly upgrading them to 7.0.0 (what we call an upgrade mode):


./DJ1/opendj/setup directory-server -h localhost -p 1389 -D "cn=Directory Manager" -w password --adminConnectorPort 4444 -Z 1636 -t je -b dc=com -l /local/GIT/pyforge/PyBot/OpenDJ/testcases/data/replication_startup.ldif   -O --acceptLicense

then stop and copy 7.0.0 files and upgrade:
./DJ1/opendj/upgrade -n --acceptLicense --force

for the 3 servers.



Then we configure replication between  'DJ1' and 'DJ3' and it gets stuck:


DJ1/opendj/bin/dsreplication configure --host1 localhost --port1 4444 --bindDN1 "cn=Directory Manager" --bindPassword1 "password" --replicationPort1 8989 --host2 localhost --port2 4446 --bindDN2 "cn=Directory Manager" --bindPassword2 "password" --replicationPort2 8991 -b dc=com -I admin -w password  -X -n



we have the following errors in replication logs:


[16/Aug/2019:15:01:31 +0200] category=SYNC severity=NOTICE msgID=204 msg=Replication server RS(Jan_Farrell) started listening for new connections on address 0.0.0.0 port 8989
[16/Aug/2019:15:01:31 +0200] category=SYNC severity=INFORMATION msgID=207 msg=Replication server RS(Jan_Farrell) has accepted a connection from directory server DS(Jan_Farrell) for domain "dc=com" at /127.0.0.1:52488
[16/Aug/2019:15:01:31 +0200] category=SYNC severity=NOTICE msgID=62 msg=Directory server DS(Jan_Farrell) has connected to replication server RS(Jan_Farrell) for domain "dc=com" at 127.0.0.1:8989 with generation ID 3079061
[16/Aug/2019:15:01:31 +0200] category=SYNC severity=INFORMATION msgID=105 msg=Replication server accepted a connection from /127.0.0.1:52490 to local address 0.0.0.0/0.0.0.0:8989 but the SSL handshake failed. This is probably benign, but may indicate a transient network outage or a misconfigured client application connecting to this replication server. The error was: Received fatal alert: certificate_unknown
...



To reproduce:


in config.cfg, to trigger the upgrade mode:

[OpenDJ]
...
version = ["5.0.0", "7.0.0-SNAPSHOT"]

and then:
./run-pybot.py -nvs replication_group3.Failover -t Failover_One_Server_Down_(Stopped)_Add_Op opendj

