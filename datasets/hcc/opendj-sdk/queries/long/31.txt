When there is a referral stored in an entry:

dn: ou=refs1,dc=example,dc=com
objectclass: top
objectclass: extensibleObject
objectclass: referral
ou: refs1
ref: ldap://localhost:1389/ou=managers,dc=onecorp,dc=com??sub?(uid=*)

And you query that entry with LDAPSEARCH command line tool (or any other) on the RES_SEARCH_DONE with result code 10 (referral) the referral returned is

ldap://localhost:1389/ou=managers,dc=onecorp,dc=com??SCOPE?   where SCOPE is the scope of the ldapsearch query sent from command line:

$ ldapsearch -LLL -x -h localhost -p 13890 -D cn=dirmanager -w dirmanager -b ou=refs1,dc=example,dc=com '(cn=*)'
Referral (10)
Matched DN: ou=refs1,dc=example,dc=com
Additional information: A referral entry ou=refs1,dc=example,dc=com indicates that the operation must be processed at a different server
Referral: ldap://localhost:1389/ou=appli,o=oih??sub?

$ ldapsearch -LLL -x -h localhost -p 13890 -D cn=dirmanager -w dirmanager -b ou=refs1,dc=example,dc=com '(cn=*)' -s base
Referral (10)
Matched DN: ou=refs1,dc=example,dc=com
Additional information: A referral entry ou=refs1,dc=example,dc=com indicates that the operation must be processed at a different server
Referral: ldap://localhost:1389/ou=appli,o=oih??base?


This also happened in OpenDS. However, Sun DS 7 does return the scope and filter. Not sure if this is a bug or a feature, but at least looks a bit weird. Tested in 2.4.0 beta1, I think it also happens in previous versions, not tested in official 2.4.0