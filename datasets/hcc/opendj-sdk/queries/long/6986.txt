The entries published under cn=Secret keys by CryptoManager contain elements built with different schemas:
 DN: core schema.
 Object classes: Server schema.
 Attribute descriptions: Default schema.

The attribute descriptions should be built with the server schema (I don't know when the DN should be built with the server schema too).

I don't have a reproduce case for this issue but, in one of my branches, I have a unit test that adds a side effect to all the integration tests (I am not sure how this happens), the tests fail with the following error:

Failure Cause:  Other: An error occurred while trying to encrypt a value using password storage scheme AES: CryptoManager failed to add locally produced symmetric key entry "ds-cfg-key-id=4a1ef96d-bd8a-4e1c-b582-3112e84237e3,cn=secret keys,cn=admin data": Entry "ds-cfg-key-id=4a1ef96d-bd8a-4e1c-b582-3112e84237e3,cn=secret keys,cn=admin data" violates the schema because it does not contain attribute "ds-cfg-symmetric-key" which is required by object class "ds-cfg-cipher-key"    


The entry published by CryptoManager does contain the attribute ds-cfg-symmetric-key but, because it was built with the wrong schema, the directory server does not recognize it.

This is probably not an issue outside of our tests otherwise we would have heard of it already.

Because there is no reproduce case, I think the code review will be sufficient to validate that the bug is fixed.