Preconditions

1. LDAP context which schema contains definition of OC that will be used in the test that contains at least one optional attribute; the attribute can't be met in any other OC in this context; there is only one entry of that OC in the context
2. Two OpenDJ servers have been set up, each on its own separate host, using next global settings:

'single-structural-objectclass-behavior' : 'accept'
'etime-resolution' : 'nanoseconds'
'idle-time-limit' : '"120000 ms"'
'size-limit' : '0'
'lookthrough-limit' : '0'
'allow-pre-encoded-passwords' : 'true'
 '--policy-name "Default Password Policy"'


3. Replication is configured between the servers following standard procedures from the admin guide.

Steps to reproduce

1. Using dsconfig tool, add string "yourtestOC:yourtestAttr" to “fractional-exclude” global property on both nodes

Result

Replication between nodes immediately is broken (still dsreplication tool shows states of participants as normal, with only Missing Changes counters keep incrementing). Changes on one node stops appearing on the other.
There are strange records in the "errors" log file:


    [21/May/2016:07:02:42 -0400] category=SYNC severity=SEVERE_WARNING msgID=14811271 msg=Replication server RS(8418) ignoring update 00000154d2fb42482077000089c9 for domain "o=mycontext" from directory server DS(8311) at some.host.loc/111.111.111.111:47127 because its generation ID 23830629 is different to the local generation ID 23830629
    [21/May/2016:07:02:43 -0400] category=SYNC severity=SEVERE_WARNING msgID=14811271 msg=Replication server RS(8418) ignoring update 00000154d2fb44a02077000089ca for domain "o=mycontext" from directory server DS(8311) at some.host.loc/111.111.111.111:47127 because its generation ID 23830629 is different to the local generation ID 23830629
    [21/May/2016:07:03:05 -0400] category=SYNC severity=SEVERE_WARNING msgID=14811271 msg=Replication server RS(8418) ignoring update 00000154d2fb9c2c2077000089cb for domain "o=mycontext" from directory server DS(8311) at some.host.loc/111.111.111.111:47127 because its generation ID 23830629 is different to the local generation ID 23830629
    [21/May/2016:07:03:05 -0400] category=SYNC severity=SEVERE_WARNING msgID=14811271 msg=Replication server RS(8418) ignoring update 00000154d2fb9dbc2077000089cc for domain "o=mycontext" from directory server DS(8311) at some.host.loc/111.111.111.111:47127 because its generation ID 23830629 is different to the local generation ID 23830629
    [21/May/2016:07:03:06 -0400] category=SYNC severity=SEVERE_WARNING msgID=14811271 msg=Replication server RS(8418) ignoring update 00000154d2fb9f4d2077000089cd for domain "o=mycontext" from directory server DS(8311) at some.host.loc/111.111.111.111:47127 because its generation ID 23830629 is different to the local generation ID 23830629
    [21/May/2016:07:04:06 -0400] category=SYNC severity=SEVERE_WARNING msgID=14811271 msg=Replication server RS(8418) ignoring update 00000154d2fc8a932077000089ce for domain "o=mycontext" from directory server DS(8311) at some.host.loc/111.111.111.111:47127 because its generation ID 23830629 is different to the local generation ID 23830629



As soon as “fractional-exclude” setting is cleared of values on both nodes replication starts to work normally, MC counters decrease to 0.

Has been tried twice for each of the mentioned app's versions.

Expected result

All changes to all entries' attributes of this context are being replicated between the servers, except for this particular attribute of entry with the OC that is used for the test, i.e. these attribute (its copies on both nodes) are totally unaffected by replication.