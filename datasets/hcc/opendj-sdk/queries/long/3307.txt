OpenDJ 4.0.0 (revision a8c66042313)

We have this problem every day in the functional tests on Linux and Windows (more often on Windows).

Scenario:

	install a server (don't start it after installation)

C:> opendj\setup.bat -h localhost -p 1390 -D "cn=myself" -w password --adminConnectorPort 4445 -Z 1637 --generateSelfSignedCertificate -b dc=mysuffix -t je -O --cli -n


	start the server

C:> opendj\bat\start-ds.bat


	wait for the server to be ready running ldapsearch commands

C:> opendj\bat\ldapsearch.bat -h localhost -p 1390 -D "cn=myself" -w password -T -b "cn=config" -s base "(objectclass=*)"


	restart the server using "stop-ds -R" command

C:> opendj\bat\stop-ds.bat -h dj-robot-windows.internal.forgerock.com -p 4444 -D "cn=myself" -w password -X -R





=> after one minute the server is not restarted

We get the following error in the "server.out" file:

ERROR:  Unable to perform an in-core restart:
java.lang.NullPointerException
	at org.opends.server.core.DirectoryServer.getSchema(DirectoryServer.java:2184)
	at org.opends.server.backends.task.Task.addLogMessage(Task.java:809)
	at org.opends.server.loggers.ErrorLogger.log(ErrorLogger.java:110)
	at org.opends.server.loggers.slf4j.OpenDJLoggerAdapter.publishInErrorLogger(OpenDJLoggerAdapter.java:157)
	at org.opends.server.loggers.slf4j.OpenDJLoggerAdapter.publish(OpenDJLoggerAdapter.java:128)
	at org.opends.server.loggers.slf4j.OpenDJLoggerAdapter.debug(OpenDJLoggerAdapter.java:201)
	at org.forgerock.i18n.slf4j.LocalizedLogger.debug(LocalizedLogger.java:166)
	at org.opends.server.core.DirectoryServer.bootstrapServer(DirectoryServer.java:1264)
	at org.opends.server.core.DirectoryServer.reinitialize(DirectoryServer.java:5351)
	at org.opends.server.core.DirectoryServer.restart(DirectoryServer.java:5317)
	at org.opends.server.core.DirectoryServer.restart(DirectoryServer.java:5297)
	at org.opends.server.tasks.RestartTaskThread.run(RestartTaskThread.java:76)
Halting the JVM so that it must be manually restarted.

