Discovered with functional tests targeted on fractional replication.

In the test we have 2x DSRS topology and we set fractional replication with following commands:


./dsconfig -h opendj.example.com -p 4445 -D "cn=Directory Manager" -w password -X set-replication-domain-prop --provider-name "Multimaster Synchronization" --domain-name "o=example" --set fractional-include:*:description --reset fractional-exclude -n

as next step we try an offline initialization with following commands:


./makeldif -o /tmp/basic-master.ldif /tmp/basic-master.template



./DJ1/opendj/bin/stop-ds



./DJ2/opendj/bin/stop-ds



./DJ1/opendj/bin/import-ldif --offline -n userRoot -O --skipFile /tmp/skip-DJ1-20180626-102005.txt --rejectFile /tmp/reject-DJ1-20180626-102005.txt -l /tmp/basic-master.ldif



./DJ1/opendj/bin/start-ds



./DJ2/opendj/bin/start-ds



./DJ1/opendj/bin/dsreplication initialize-all -h opendj.example.com -p 4444 -b o=example -I admin -w password -X -n

The test itself is ok, but we discover an error message in DJ2 errors log file:


(ERROR) [26/Jun/2018:10:20:23 +0200] category=SYNC severity=ERROR msgID=21 msg=Error when searching old changes from the database for base DN o=example

The time of the error is related to start of DJ2 instance.

Framework command to reproduce:


./run-pybot.py -s replication_group3.fractional -t fractional_include_configure -t "fractional_include_basic_off*" dj

 