Having duplicated keys (e.g. frapi:opendj:rest2ldap:user:1.0)  in rest2ldap config.json files leads to some unfriendly errors and stops DS from starting.  To recreate - 

Install DS

Enable the default /api rest2ldap endpoint

Create a new config directory and copy example-v1.json


mkdir /path/to/ds/config/rest2ldap/endpoints/api2 
cp /path/to/ds/config/rest2ldap/endpoints/api/example-v1.json /path/to/ds/config/rest2ldap/endpoints/api2

Create a new rest2ldap endpoint, for example -   


./dsconfig create-http-endpoint --hostname localhost --port 4444 --bindDN "cn=Directory Manager" --bindPassword password --endpoint-name /api2 --type rest2ldap-endpoint --set authorization-mechanism:"HTTP Basic" --set config-directory:config/rest2ldap/endpoints/api2 --set enabled:true --no-prompt --trustAll



The Rest2LDAP Endpoint could not be created due to a communications problem: Undefined 

However, the endpoint is actually created, on restart another error is reported and DS does not start - 


[18/Mar/2019:11:02:13 -0700] category=CORE severity=NOTICE msgID=139 msg=The Directory Server has sent an alert notification generated by class org.opends.server.core.DirectoryServer (alert type org.opends.server.DirectoryServerShutdown, alert ID org.opends.messages.core-141): The Directory Server has started the shutdown process. The shutdown was initiated by an instance of class org.opends.server.core.DirectoryServer and the reason provided for the shutdown was An error occurred while trying to start the Directory Server: IllegalArgumentException: Duplicated key for definition but different value. Already got org.forgerock.api.transform.LocalizableComposedModel@2223a52f (SwaggerApiProducer.java:235 SwaggerApiProducer.java:189 SwaggerApiProducer.java:43 AbstractRouter.java:361 AbstractRouter.java:334 AbstractRouter.java:141 AbstractRouter.java:124 HttpEndpointConfigManager.java:155 HttpEndpointConfigManager.java:138 HttpEndpointConfigManager.java:125 HttpEndpointConfigManager.java:102 DirectoryServer.java:1364 DirectoryServer.java:4080)

This could also be a problem if you created a new endpoint and decided to copy the example config over after the fact, DS will fail on the next restart with the above error.

The issue is caused by duplicate config in the example-v1.json files, entries such as frapi:opendj:rest2ldap:user:1.0 must be unique, a doc bug has been raised to improve information around this, this bug is being raised to address the ambiguous errors.  

Workaround - replace all entries in the endpoint config.json file with unique comma separated values such as example:frapi:opendj:rest2ldap:user:1.0