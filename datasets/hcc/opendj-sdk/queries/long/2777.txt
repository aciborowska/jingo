Found with OpenDJ 4.0.0 rev 3259fdc435a6ed8687e9572f7f05285caa47da2a

We setup a server, import ldif, try to add an aci to a branch with a bad userdn:


./opendj/bin/ldapmodify -h localhost -p 1390 -D "cn=myself" -w password 
dn: ou=aci branch,o=RDN Wildcard Tests,o=ACI Tests,dc=example,dc=com
changetype: modify
add: aci
aci: (target="ldap:///uid=dmiller, ou=branch level three, ou=branch level two, ou=branch level one, ou=aci branch,o=RDN Wildcard Tests,o=ACI Tests,dc=example,dc=com")(targetattr="*")(version 3.0; acl "add_aci24"; deny (search,read) userdn="ldap:///ldap:///uid=auser,ou=People,*,dc=example,dc=com";)
Processing MODIFY request for ou=aci branch,o=RDN Wildcard Tests,o=ACI Tests,dc=example,dc=com
MODIFY operation failed



The operation is failing as expected but the return code is not the expected one. We were expecting 21, we got 255.

Besides, there is an error message in the error logs of the server with a java stack:

[15/Mar/2016:11:51:22 +0100] category=EXTENSIONS severity=ERROR msgID=org.opends.messages.core.108 msg=Worker Thread 2 encountered an uncaught exception while processing operation ModifyOperation(connID=1, opID=1, dn=ou=aci branch,o=RDN Wildcard Tests,o=ACI Tests,dc=example,dc=com): LocalizedIllegalArgumentException: The provided value "ldap:///uid=auser,ou=People,*,dc=example,dc=com" could not be parsed as a valid distinguished name because character ':' at position 4 is not allowed in an attribute name (AVA.java:448 AVA.java:431 AVA.java:117 RDN.java:172 DN.java:270 DN.java:242 DN.java:210 LDAPURL.java:404 UserDN.java:96 BindRule.java:407 BindRule.java:267 BindRule.java:219 PermBindRulePair.java:42 PermBindRulePair.java:55 AciBody.java:197 Aci.java:366 AciSyntaxImpl.java:76 Syntax.java:337 LocalBackendModifyOperation.java:1194 LocalBackendModifyOperation.java:1148 LocalBackendModifyOperation.java:917 ...)



script in attachment to reproduce the issue