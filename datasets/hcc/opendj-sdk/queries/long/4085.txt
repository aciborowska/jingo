Steps to reproduce:

	Setup a directory server with some test entries under dc=example, dc=com:

./setup directory-server -D "cn=directory manager" -w "password" -p 1389 -h localhost --adminConnectorPort 4444 -b dc=example,dc=com -d 10 -Z 1636 --acceptLicense






	Tries to add base DN dc=com to the userRoot backend using dsconfig (we have the same behavior using interactive mode):

 $ bin/dsconfig set-backend-prop --backend-name userRoot --add base-dn:dc=com --hostname gaetan-laptop --port 4444 --bindDn cn=Directory\ Manager --bindPassword password --trustAll --no-prompt

The JE Backend could not be modified due to a communications problem: Other:
The attempt to apply the configuration modification failed. The preliminary
checks were all successful and the modified entry was written to the server
configuration, but at least one of the configuration change listeners reported
an error when attempting to apply the change: DirectoryException: Unable to
register base DN dc=com with the Directory Server for backend userRoot because
that backend already contains another base DN dc=example,dc=com that is within
the same hierarchical path (BackendConfigManager.java:1110
BackendConfigManager.java:1053 BackendConfigManager.java:1026
BackendConfigManager.java:933 BackendConfigManager.java:578
BackendImpl.java:869 JEStorage.java:706 TracedStorage.java:529
BackendImpl.java:851 BackendImpl.java:87
ServerManagedObjectChangeListenerAdaptor.java:50
ConfigChangeListenerAdaptor.java:281 ConfigurationHandler.java:645
ConfigurationBackend.java:477 LocalBackendModifyOperation.java:492
LocalBackendModifyOperation.java:279 LocalBackendWorkflowElement.java:484
LocalBackendWorkflowElement.java:605 ModifyOperationBasis.java:296
SynchronousStrategy.java:39 LdapClientConnection.java:597 ...)

Note that we got an explicit error message but in interactive mode the session end up directly after the error print and we have no chances to fix the error.




	If we list backends we can see that dc=com base DN has been added:

$ bin/dsconfig list-backends --hostname gaetan-laptop --port 4444 --bindDn cn=Directory\ Manager --bindPassword password --trustAll --no-prompt
Backend   : Type : enabled : base-dn                                     : confidentiality-enabled
--------------:-------:------------:-----------------------------------------:------------------------
adminRoot : ldif : true         : cn=admin data                           : -
userRoot    : je   : true         : dc=com, "dc=example,dc=com" : false






	Restart the server:

 $ bin/stop-ds -R
Stopping Server...
[14/Jun/2017:16:38:15 +0200] category=BACKEND severity=NOTICE msgID=370 msg=The backend userRoot is now taken offline
[14/Jun/2017:16:38:15 +0200] category=CORE severity=NOTICE msgID=203 msg=The Directory Server is now stopped
[14/Jun/2017:16:38:16 +0200] category=com.forgerock.opendj.ldap.config.config severity=NOTICE msgID=571 msg=Loaded extension from file '/tmp/opendj/lib/extensions/snmp-mib2605.jar' (build 4.0.0, revision 0b7da454b79944f54e66daf3f591cefb5d77165b)
[14/Jun/2017:16:38:16 +0200] category=CORE severity=NOTICE msgID=134 msg=OpenDJ Server 4.0.0 (build 20170327164811, revision number 0b7da454b79944f54e66daf3f591cefb5d77165b) starting up
[14/Jun/2017:16:38:17 +0200] category=JVM severity=NOTICE msgID=21 msg=Installation Directory: /tmp/opendj
[14/Jun/2017:16:38:17 +0200] category=JVM severity=NOTICE msgID=23 msg=Instance Directory: /tmp/opendj
[14/Jun/2017:16:38:17 +0200] category=JVM severity=NOTICE msgID=17 msg=JVM Information: 1.8.0_131-8u131-b11-0ubuntu1.16.04.2-b11 by Oracle Corporation, 64-bit architecture, 3717201920 bytes heap size
[14/Jun/2017:16:38:17 +0200] category=JVM severity=NOTICE msgID=18 msg=JVM Host: gaetan-laptop, running Linux 4.4.0-78-generic amd64, 16725196800 bytes physical memory size, number of processors available 8
[14/Jun/2017:16:38:17 +0200] category=JVM severity=NOTICE msgID=19 msg=JVM Arguments: "-Dorg.opends.server.scriptName=start-ds"
[14/Jun/2017:16:38:18 +0200] category=BACKEND severity=NOTICE msgID=513 msg=The database backend userRoot containing 12 entries has started
[14/Jun/2017:16:38:18 +0200] category=CONFIG severity=ERROR msgID=116 msg=An error occurred while trying to initialize a backend loaded from class org.opends.server.backends.jeb.JEBackend with the information in configuration entry ds-cfg-backend-id=userRoot,cn=Backends,cn=config: InitializationException: 
An error occurred while attempting to register the base DNs [dc=com, dc=example,dc=com] in the Directory Server: org.opends.server.types.DirectoryException: 
Unable to register base DN dc=example,dc=com with the Directory Server for backend userRoot because that backend already contains another base DN dc=com
 that is within the same hierarchical path (BackendImpl.java:204 BackendConfigManager.java:807 BackendConfigManager.java:790 BackendConfigManager.java:249 BackendConfigManager.java:225 BackendConfigManager.java:215 DirectoryServer.java:1664 DirectoryServer.java:1485 DirectoryServer.java:5048). This backend will be disabled
[14/Jun/2017:16:38:18 +0200] category=EXTENSIONS severity=NOTICE msgID=221 msg=DIGEST-MD5 SASL mechanism using a server fully qualified domain name of: localhost
[14/Jun/2017:16:38:19 +0200] category=PROTOCOL severity=NOTICE msgID=276 msg=Started listening for new connections on Administration Connector 0.0.0.0 port 4444
[14/Jun/2017:16:38:19 +0200] category=PROTOCOL severity=NOTICE msgID=276 msg=Started listening for new connections on LDAP Connection Handler 0.0.0.0 port 1389
[14/Jun/2017:16:38:19 +0200] category=PROTOCOL severity=NOTICE msgID=276 msg=Started listening for new connections on LDAPS Connection Handler 0.0.0.0 port 1636
[14/Jun/2017:16:38:19 +0200] category=CORE severity=NOTICE msgID=135 msg=The Directory Server has started successfully
[14/Jun/2017:16:38:19 +0200] category=CORE severity=NOTICE msgID=139 msg=The Directory Server has sent an alert notification generated by class org.opends.server.core.DirectoryServer (alert type org.opends.server.DirectoryServerStarted, alert ID org.opends.messages.core-135): The Directory Server has started successfully


Notice that the userRoot backend has been disabled so we cannot access data from dc=example,dc=com anymore.



dsconfig should not add the incorrect base DN to the backend base DNs list and when used in interactive mode should not exit if ran in interactive mode.