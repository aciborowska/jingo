Using the subentries request control:


    static void useSubentriesRequestControl(Connection connection) throws ErrorResultException {
        if (isSupported(SubentriesRequestControl.OID)) {
            final SearchRequest request =
                    Requests.newSearchRequest("dc=example,dc=com",
                                SearchScope.WHOLE_SUBTREE,
                                "cn=*Class of Service", "*", "+")
                            .addControl(SubentriesRequestControl.newControl(
                                true, true));

            final ConnectionEntryReader reader = connection.search(request);
            final LDIFEntryWriter writer = new LDIFEntryWriter(System.out);
            try {
                while (reader.hasNext()) {
                    if (reader.isEntry()) {
                        final SearchResultEntry entry = reader.readEntry();
                        writer.writeEntry(entry);
                    }
                }
                writer.close();
            } catch (ErrorResultIOException e) {
                e.printStackTrace();
            } catch (SearchResultReferenceIOException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
        } else {
            System.out.println("SubentriesRequestControl not supported");
        }
    }



The resulting error suggests the implementation of the control is not finished:


org.forgerock.opendj.ldap.ErrorResultIOException: org.forgerock.opendj.ldap.ErrorResultException: Protocol Error: Cannot decode the provided subentries control because it does not have a value
	at org.forgerock.opendj.ldif.ConnectionEntryReader.hasNext(ConnectionEntryReader.java:235)
	at org.forgerock.opendj.examples.Controls.useSubentriesRequestControl(Controls.java:819)
	at org.forgerock.opendj.examples.Controls.main(Controls.java:141)
Caused by: org.forgerock.opendj.ldap.ErrorResultException: Protocol Error: Cannot decode the provided subentries control because it does not have a value
	at org.forgerock.opendj.ldap.ErrorResultException.newErrorResult(ErrorResultException.java:184)
	... 3 more

