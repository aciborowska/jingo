Found with OPENDJ 6.5.0-M1

We install DJ with some users.
We remove global aci and add a target control aci to view aclRights on a branch:


/DJ1/opendj/bin/ldapmodify -h nameserver.example.com -p 1391 -D "cn=Directory Manager" -w password 	
dn: dc=example,dc=com
changetype: modify
add: aci
aci: (targetcontrol="*")(version 3.0; acl "allow control access"; allow(read) userdn="ldap:///anyone";)

./DJ1/opendj/bin/ldapmodify -h nameserver.example.com -p 1391 -D "cn=Directory Manager" -w password 	
dn: ou=aci branch,o=ACI Tests,dc=example,dc=com
changetype: modify
add: aci
aci: (target="ldap:///ou=aci branch,o=ACI Tests,dc=example,dc=com")(targetattr="aclRights || aclRightsInfo")(version 3.0; acl "add_effrights_aci"; allow (search,read) userdn="ldap:///uid=auser,ou=People,o=ACI Tests,dc=example,dc=com";)

 

Then we add an aci to allow all users to search on targetattr:

./DJ1/opendj/bin/ldapmodify -h nameserver.example.com -p 1391 -D "cn=Directory Manager" -w password 	
dn: ou=aci branch,o=ACI Tests,dc=example,dc=com
changetype: modify
add: aci
aci: (targetattr="*")(version 3.0; acl "add_aci2"; allow (search) userdn="ldap:///all";)



Then we do a search with effective rights control:

./DJ1/opendj/bin/ldapsearch -h nameserver.example.com -p 1391 -D "uid=auser,ou=People,o=ACI Tests,dc=example,dc=com" -w ACIRules -b "uid=scarter,ou=people,ou=aci branch,o=aci tests,dc=example,dc=com" -g "dn: uid=auser,ou=People,o=ACI Tests,dc=example,dc=com" -e uid -e roomnumber -e aclRights "objectclass=*" uid aclRights roomnumber



With previous 6.5.0-SNAPSHOT: (ie: 70b1c7cbb72)


dn: uid=scarter,ou=People,ou=aci branch,o=ACI Tests,dc=example,dc=com aclRights;attributeLevel;uid: search:1,read:0,compare:0,write:0,selfwrite_add:0,selfwrite_delete:0,proxy:0 aclRights;attributeLevel;roomNumber: search:1,read:0,compare:0,write:0,selfwrite_add:0,selfwrite_delete:0,proxy:0 aclRights;attributeLevel;aclRights: search:1,read:1,compare:0,write:0,selfwrite_add:0,selfwrite_delete:0,proxy:0 aclRights;entryLevel: add:0,delete:0,read:1,write:0,proxy:0



With M1:

dn: uid=scarter,ou=People,ou=aci branch,o=ACI Tests,dc=example,dc=com




Test is:
./run-pybot.py -n -s aci_group.TargetControl -t "Targetcontrol Search Users Effective Rights"  DJ

Could it be commit 7813a77ec11, Jean-NoÃ«l Rouvignac ?