I've just noticed that the OpenDJ LDAP SDK's SASL confidentiality and integrity implementations violate the protocol. Both the wrap and unwrap methods of the ConnectionSecurityLayer fail to encode/decode the 4-byte packet length.

Fixing this will require a significant refactoring of the ConnectionSecurityLayer interface.