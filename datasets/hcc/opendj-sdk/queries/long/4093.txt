This is a regression since the migration of ConnectionHandler to Grizzly.

To prevent connections to remain in TIME_WAIT state for too long on server-side, we should let the time to the client to perform the disconnection itself when it send an UnbindRequest or after receiving a Notice Of Disconnection from the server.

Today, there is no time limit enforced: a connection could remains open forever after an UnbindRequest if the client is not closing the connection itself (but it'll be closed by the server if it sends a message after sending the UnbindRequest).

Moreover, the server disconnect a connection rightÂ after sending a notice of disconnection without letting a change to the client to close the connection itself.

We should bring back the previous behavior: after receiving an UnbindRequest or sending a Notice of Disconnection, the server should wait a small amount before closing the connection so that the client have an opportunity to do it itself.