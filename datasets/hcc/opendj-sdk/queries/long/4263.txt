When Backend log files are compressed, the failure exception can go unnoticed because the only messages seen are in the DJ access log.  Customers do not normally monitor access logs for exceptions.


[04/Sep/2017:11:32:25 -0600] SEARCH REQ conn=11 op=1 msgID=2 base="dc=example,dc=com" scope=sub filter="(uid=*)" attrs="dn"
[04/Sep/2017:11:32:25 -0600] SEARCH RES conn=11 op=1 msgID=2 result=80 message="com.sleepycat.je.EnvironmentFailureException: (JE 7.3.7) Environment must be closed, caused by: com.sleepycat.je.EnvironmentFailureException: Environment invalid because of previous exception: (JE 7.3.7) /opt/instances/master1/db/userRoot Log file 00000000.jdb was deleted unexpectedly. LOG_UNEXPECTED_FILE_DELETION: A log file was unexpectedly deleted, log is likely invalid. Environment is invalid and must be closed." nentries=0 etime=1


The error is seen in cn=monitor, but it too can go unnoticed if it is not being polled frequently.


dn: cn=userRoot JE Database,cn=monitor
objectClass: top
objectClass: ds-monitor-entry
objectClass: extensibleObject
JEInfo: EnvironmentFailureException: (JE 7.3.7) Environment must be closed, caused by: com.sleepycat.je.EnvironmentFailureException: Environment invalid because of previous exception: (JE 7.3.7) /opt/instances/master1/db/userRoot Log file 00000000.jdb was deleted unexpectedly. LOG_UNEXPECTED_FILE_DELETION: A log file was unexpectedly deleted, log is likely invalid. Environment is invalid and must be closed. (EnvironmentFailureException.java:228 EnvironmentImpl.java:1766 EnvironmentImpl.java:1775 Environment.java:2473 Environment.java:2146 JEMonitor.java:61 MonitorBackend.java:730 MonitorBackend.java:698 MonitorBackend.java:534 LocalBackendSearchOperation.java:224 LocalBackendSearchOperation.java:101 LocalBackendWorkflowElement.java:732 LocalBackendWorkflowElement.java:1051 LocalBackendWorkflowElement.java:894 SearchOperationBasis.java:1007 TraditionalWorkerThread.java:148)
cn: userRoot JE Database


 

The exception should also be sent to the error and server.out files.

 