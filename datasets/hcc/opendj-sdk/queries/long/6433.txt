Found with rev (bca2ea0a02d)

I could not isolate a test to reproduce this issue but it seems that we are getting the error logs flooded with :


[04/Jul/2019:14:07:02 +0200] category=SYNC severity=ERROR msgID=179 msg=Replication server dj1 was attempting to connect to replication server openam.example.com/127.0.0.1:8989 but has disconnected in handshake phase. Error: SocketTimeoutException(Read timed out)
[04/Jul/2019:14:07:02 +0200] category=SYNC severity=ERROR msgID=179 msg=Replication server dj1 was attempting to connect to replication server /127.0.0.1:34524 but has disconnected in handshake phase. Error: SocketException(no more data)
[04/Jul/2019:14:07:07 +0200] category=SYNC severity=ERROR msgID=179 msg=Replication server dj1 was attempting to connect to replication server openam.example.com/127.0.0.1:8989 but has disconnected in handshake phase. Error: SocketTimeoutException(Read timed out)
[04/Jul/2019:14:07:07 +0200] category=SYNC severity=ERROR msgID=179 msg=Replication server dj1 was attempting to connect to replication server /127.0.0.1:34538 but has disconnected in handshake phase. Error: SocketException(no more data)
[04/Jul/2019:14:07:11 +0200] category=SYNC severity=ERROR msgID=343 msg=Replication server dj1 was attempting to connect to replication server /127.0.0.1:34550 but an error occurred in handshake phase. Error: Other: Timed out while trying to acquire the domain lock for domain "cn=schema". The connection attempt from replication server RS(0) at /127.0.0.1:34550 to this replication server RS(dj1) will be aborted. This is probably benign and a result of a simultaneous cross connection attempt



when running the whole ttlreaper test suite, systematically.
These tests configure 2 DJs, replicated, with data.
They then configure an index on both servers enabling ttl for it.
Then they check ttl reaper functionality playing around with ldapmodify, restarting the servers etc.

I am trying to isolate one or more test cases to try and have a reproducible sequence of steps to trigger the issue.

In the meantime:

./run-pybot.py -s replication_group3.TtlReaper opendj

 