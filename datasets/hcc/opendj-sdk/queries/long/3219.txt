Steps to reproduce
1. Setup an OpenDJ instance version 2.6.x without data import

./opendj/setup -h localhost -p 1389 -D "cn=myself" -w password --adminConnectorPort 4444 -Z 1636 --generateSelfSignedCertificate -b dc=mysuffix -O --cli -n --acceptLicense



2. Stop the instance

./opendj/bin/stop-ds



3. Copy files of OpenDJ 3.5.0 (rev 6c04f4cb5de809ea1b4e8deb12925396da89d841) or 4.0.0 (rev e61d6d0a55d022a0768e730521bfea36ad506f9d) over opendj folder

cp -rf 350_instance/opendj/* opendj/



4. Run an upgrade

./opendj/upgrade



Current behavior
I hit IllegalArgumentException during upgrade process:

>>>> Preparing to upgrade OpenDJ 3.0.0 introduced changes to the JE backend configuration and database format.
 The upgrade will update all JE backend configurations, but will only migrate JE backend databases which are associated with *enabled* JE backends.
 It is very strongly recommended that any existing data has been backed up and that you have read the upgrade documentation before proceeding. 
Do you want to proceed with the upgrade? (yes/no) yes 

** An error occurred while performing an upgrade task: IllegalArgumentException: 
Environment home
 /home/ondrej/DATA/repositories/pyforge-dev/results/20160714-124816/sample_group/DJ1/opendj/./db/userRoot 
doesn't exist (FileManager.java:365 EnvironmentImpl.java:482 
EnvironmentImpl.java:408 DbEnvPool.java:178 Environment.java:252
 Environment.java:233 Environment.java:177 UpgradeTasks.java:1158 UpgradeTasks.java:1150 UpgradeTasks.java:993 UpgradeTasks.java:983 
UpgradeTasks.java:527 Upgrade.java:909 UpgradeCli.java:315 
UpgradeCli.java:130 UpgradeCli.java:101) 

* See '/home/ondrej/DATA/repositories/pyforge-dev/results/20160714-124816/sample_group/DJ1/opendj/logs/upgrade.log' for a detailed log of this operation



Expected behavior
An upgrade without exceptions.