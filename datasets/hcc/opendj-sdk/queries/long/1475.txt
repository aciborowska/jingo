If a server has multiple FQDNs, a certificate could store alternate FQDNs in a Subject Alt Name extension instead of in the Subject DN.

At present, it looks like org.forgerock.opendj.ldap.TrustManagers#CheckHostName.verifyHostName does not check anything but the subject DN.

If alternative FQDNs are in the Subject Alt Name, these should take precedence over the subject DN.

Furthermore, the current verifyHostName logic assumes that the leaf-most element in the subject DN will be the CN, but this is not guaranteed. The verifier should check for the leaf-most CN and ignore other types such as EMAIL=