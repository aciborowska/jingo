With daily functional tests we hit an issue with reading the cn=changelog by administrator user after upgrade from older version (2.6.4) to latest 6.0.0-SNAPSHOT (rev f573eca56aa5d0f0b582832de1bb4ee88a8c0a2a). 

An ldapsearch with ouput:


./ldapsearch -h pyforge.example.com -p 1390 -D "cn=Directory Manager" -w password -b "cn=changelog" "(objectClass=*)"
# The LDAP search request failed: 50 (Insufficient Access Rights) 
# Additional Information: You do not have sufficient privileges to perform a search request on cn=changelog



To reproduce the problem run a test framework with modified config.cfg

Change a settings in [OpenDJ] section:


previous_version = 3.5.0

to


previous_version = 2.6.4

or export a env variable before running configure.py


export OPENDJ_PREVIOUS_VERSION=2.6.4
./configure.py

A command to run a test:


./run-pybot.py -s upgrade_group.upgrade_tasks -t Upgrade_Tasks -t Post_Change_Backend_Files dj


Notes:

A test with name "Post_Change_Backend_Files" fails .

I noticed this only when upgrading from version 2.6.4, when I tried to upgrade from 3.0.0 or 3.5.0 the test passed.