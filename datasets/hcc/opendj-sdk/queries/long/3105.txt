After configuring OpenDJ rest2ldap oauth2  rfc7762 with the following command:


dsconfig -h bigmac.internal.forgerock.com -p 4444 -D "cn=myself" -w password -X set-http-authorization-mechanism-prop --mechanism-name "HTTP OAuth2 Token Introspection (RFC7662)" --set enabled:true --set required-scope:uid --set access-token-cache-enabled:False --set token-introspection-url:http://bigmac.internal.forgerock.com:8080/openam/oauth2/myrealm/introspect --set client-id:clientOIDC --set client-secret:password --set authzid-json-pointer:username -n



It does not work (unexpectedly unauthorized):

curl -v -H "Authorization: Bearer AQIC5wM2LY4SfcxOFvvMPimbgHqbd-pE7FgSM84ZOqSIV80.*AAJTSQACMDEAAlNLABI3ODI3NjM2NjM0NTY2NTI0MTYAAlMxAAA.*" http://bigmac.internal.forgerock.com:8081/api/users/user.0
*   Trying 127.0.0.1...
* Connected to bigmac.internal.forgerock.com (127.0.0.1) port 8081 (#0)
> GET /api/users/user.0 HTTP/1.1
> Host: bigmac.internal.forgerock.com:8081
> User-Agent: curl/7.43.0
> Accept: */*
> Authorization: Bearer AQIC5wM2LY4SfcxOFvvMPimbgHqbd-pE7FgSM84ZOqSIV80.*AAJTSQACMDEAAlNLABI3ODI3NjM2NjM0NTY2NTI0MTYAAlMxAAA.*
>
< HTTP/1.1 401 Unauthorized
< Set-Cookie: JSESSIONID=8865025837231451960; Path=/
< WWW-Authenticate: Bearer realm="no_realm", error="invalid_token", error_description="The access token provided is expired, revoked, malformed, or invalid for other reasons."
< Date: Fri, 10 Jun 2016 08:51:17 GMT
< Transfer-Encoding: chunked
<
* Connection #0 to host bigmac.internal.forgerock.com left intact



Looking at the request sent from DJ to OpenAM:

T 127.0.0.1:59604 -> 127.0.0.1:8080 [AP]
POST /openam/oauth2/myrealm/introspect HTTP/1.1.
Accept: application/json.
Authorization: Basic cGFzc3dvcmQ6cGFzc3dvcmQ=.
Content-Length: 137.
Content-Type: application/x-www-form-urlencoded.
Host: bigmac.internal.forgerock.com:8080.
Connection: Keep-Alive.
User-Agent: Apache-HttpAsyncClient/4.1 (Java/1.8.0_25).
.
token=AQIC5wM2LY4Sfcyz7Ygkf8shZPK1mu1f7DM1aPQTlJgUrko.*AAJTSQACMDEAAlNLABMtMTQzMDQwMjE5ODQ3MjQ3MzYxAAJTMQAA*&token_type_hint=access_token

T 127.0.0.1:8080 -> 127.0.0.1:59604 [AP]
HTTP/1.1 401 Unauthorized.
Date: Fri, 10 Jun 2016 09:15:20 GMT.
Accept-Ranges: bytes.
Server: Restlet-Framework/2.3.4.
Vary: Accept-Charset, Accept-Encoding, Accept-Language, Accept.
Content-Type: application/json.
Transfer-Encoding: chunked.
.
4d.
{"error_description":"Client authentication failed","error":"invalid_client"}.



The basic authorization header is base64 encoding of 

password:password



which obviously looks wrong