Found with OpenDJ 3.0.0 rev 7084f6583704d1cc371242937e9b13698f57c66b
On windows with PDB

Scenario:

We have a DJ installed with a default PDB backend configured with db-cache-percent=50

We add a backend with db-cache-percent set to 40

We try adding a backend with db-cache-percent set to 50, expected for this backend creation to fail as it goes beyond the 100% limit.

The problem is that the backend is created but with the following error message:

The PDB Backend could not be created due to a communications problem: Undefined



Afterwards, the server is in a pretty bad shape, unable to perform any operation.

We get the following error in server logs:

(ERROR) [02/Dec/2015:14:00:00 +0000] category=org.opends.server.api.DirectoryThread severity=ERROR msgID=org.opends.messages.core.140 msg=An uncaught exception during processing for thread LDAP Request Handler 0 for connection handler Administration Connector 0.0.0.0 port 4444 has caused it to terminate abnormally. The stack trace for that exception is: OutOfMemoryError: Java heap space (HeapByteBuffer.java:57 ByteBuffer.java:335 Buffer.java:406 BufferPool.java:272 Persistit.java:626 Persistit.java:442 Persistit.java:325 PDBStorage.java:841 PDBStorage.java:828 TracedStorage.java:487 RootContainer.java:137 BackendImpl.java:1025 BackendImpl.java:190 BackendConfigManager.java:1008 BackendConfigManager.java:843 BackendConfigManager.java:800 BackendConfigManager.java:70 ServerManagedObjectAddListenerAdaptor.java:69 ConfigAddListenerAdaptor.java:173 ConfigFileHandler.java:994 LocalBackendAddOperation.java:473 ...) (ERROR) [02/Dec/2015:14:00:00 +0000] category=CORE severity=NOTICE msgID=org.opends.messages.core.139 msg=The Directory Server has sent an alert notification generated by class org.opends.server.api.DirectoryThread (alert type org.opends.server.UncaughtException, alert ID org.opends.messages.core-140): An uncaught exception during processing for thread LDAP Request Handler 0 for connection handler Administration Connector 0.0.0.0 port 4444 has caused it to terminate abnormally. The stack trace for that exception is: OutOfMemoryError: Java heap space (HeapByteBuffer.java:57 ByteBuffer.java:335 Buffer.java:406 BufferPool.java:272 Persistit.java:626 Persistit.java:442 Persistit.java:325 PDBStorage.java:841 PDBStorage.java:828 TracedStorage.java:487 RootContainer.java:137 BackendImpl.java:1025 BackendImpl.java:190 BackendConfigManager.java:1008 BackendConfigManager.java:843 BackendConfigManager.java:800 BackendConfigManager.java:70 ServerManagedObjectAddListenerAdaptor.java:69 ConfigAddListenerAdaptor.java:173 ConfigFileHandler.java:994 LocalBackendAddOperation.java:473 ...)








