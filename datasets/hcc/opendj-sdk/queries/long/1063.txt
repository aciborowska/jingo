Target "package-RPM" fails when the build path contains spaces.


$ pwd
/var/tmp/OpenDJ - Trunk
$ ./build.sh package-RPM
package-RPM:
    [mkdir] Created dir: /var/tmp/OpenDJ - Trunk/build/rpm/BUILD
    [mkdir] Created dir: /var/tmp/OpenDJ - Trunk/build/rpm/RPMS
    [mkdir] Created dir: /var/tmp/OpenDJ - Trunk/build/rpm/SOURCES
    [mkdir] Created dir: /var/tmp/OpenDJ - Trunk/build/rpm/SPECS
    [mkdir] Created dir: /var/tmp/OpenDJ - Trunk/build/rpm/SRPMS
      [rpm] Building the RPM based on the specFile file
      [rpm] Executing(%install): /bin/sh -e /var/tmp/rpm-tmp.xzYuKs
      [rpm] + umask 022
      [rpm] 
      [rpm] + cd /var/tmp/OpenDJ - Trunk/build/rpm/BUILD
      [rpm] 
      [rpm] + mkdir -p /var/tmp/OpenDJ - Trunk/build/rpm/BUILDROOT/opendj-2.7.0-1.noarch/opt/opendj
      [rpm] RPM build errors:
      [rpm] + cd /var/tmp/OpenDJ - Trunk/build/rpm/BUILDROOT/opendj-2.7.0-1.noarch/opt/opendj
      [rpm] + cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/upgrade .
      [rpm] cp: cannot copy a directory, `/var/tmp/OpenDJ', into itself, `./OpenDJ'
      [rpm] cp: cannot stat `-': No such file or directory
      [rpm] cp: cannot stat `Trunk/build/package/OpenDJ-2.7.0/upgrade': No such file or directory
      [rpm] error: Bad exit status from /var/tmp/rpm-tmp.xzYuKs (%install)
      [rpm]     Bad exit status from /var/tmp/rpm-tmp.xzYuKs (%install)
      [rpm] '/usr/bin/rpmbuild' failed with exit code 1

BUILD FAILED
/var/tmp/OpenDJ - Trunk/build.xml:1375: /var/tmp/OpenDJ - Trunk/build/rpm/RPMS/noarch does not exist.



The rpmbuild command fails due to non-escaped spaces (for some paths) in the generated RPM spec file.


$ cat /var/tmp/OpenDJ\ -\ Trunk/build/rpm/SPECS/specFile | grep "/var/tmp/OpenDJ"
%define _topdir /var/tmp/OpenDJ - Trunk/build/rpm
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/upgrade .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/bin .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/README .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/template .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/legal-notices .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/example-plugin.zip .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/setup .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/lib .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/uninstall .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/opendj_logo.png .
cp -r /var/tmp/OpenDJ - Trunk/build/package/OpenDJ-2.7.0/instance.loc .

