Found with 6.0.0 rev 4fa849bf969e8427eb22e87de136937a94d0493a

We have a 2 DSRS topology, with some data replicated on domain o=example.
We perform some addrate on first server and check the second server catches up and that data are in sync at the end of the test.
In the meantime, we are monitoring some attributes:

	ds-mon-update-replay-backlog (formerly update-replay-backlog)
	ds-mon-entries-awaiting-updates-count (formerly entries-awaiting-updates-count)



We use to retrieve them through a search on cn=o_example,cn=Replication,cn=monitor, using a search filter '(cn=Directory server DS*)'

Now we try to retrieve them on both server, querying "ds-mon-domain-name=o=example,cn=replicas,cn=replication,cn=monitor".

On first server, we never seem to retrieve them while they are present on second server when performing the addrate.

First server:

/local/GIT/pyforge/results/20180319-165833/replication/AddRate/DJ1/opendj/bin/ldapsearch -h nameserver.example.com -p 1389 -D "cn=myself" -w password -b "ds-mon-domain-name=o=example,cn=replicas,cn=replication,cn=monitor" "(objectclass=*)" 
# The LDAP search request failed: 32 (No Such Entry)
# Additional Information:  Entry ds-mon-domain-name=o=example,cn=replicas,cn=replication,cn=monitor does not exist in the "monitor" backend
# Matched DN:  cn=replicas,cn=replication,cn=monitor


Second server:

/local/GIT/pyforge/results/20180319-165833/replication/AddRate/DJ2/opendj/bin/ldapsearch -h nameserver.example.com -p 1390 -D "cn=myself" -w password -b "ds-mon-domain-name=o=example,cn=replicas,cn=replication,cn=monitor" "(objectclass=*)" 
dn: ds-mon-domain-name=o=example,cn=replicas,cn=replication,cn=monitor
objectClass: top
objectClass: ds-monitor
objectClass: ds-monitor-replica
objectClass: extensibleObject
ds-mon-ds-mon-replica-id: 20315
ds-mon-received-updates: 37616
ds-mon-sent-updates: 0
ds-mon-replayed-updates: 37616
ds-mon-current-max-remote-replica-delay: 0
ds-mon-server-state: 000001623eff54266149000092f0
ds-mon-generation-id: 18825977
ds-mon-connected-to-changelog-id: 23471
ds-mon-connected-to-changelog-hostport: 127.0.0.1:8990
ds-mon-lost-connections: 2
ds-mon-max-rcv-window: 100000
ds-mon-current-rcv-window: 62384
ds-mon-max-send-window: 100000
ds-mon-current-send-window: 100000
ds-mon-ssl-encryption: false
ds-mon-pending-updates: 0
ds-mon-replayed-updates-ok: 37616
ds-mon-resolved-naming-conflicts: 0
ds-mon-unresolved-naming-conflicts: 0
ds-mon-entries-awaiting-updates-count: 0
ds-mon-update-replay-backlog: 0
ds-mon-update-replay-total-per-thread: [4706, 4694, 4694, 4688, 4690, 4710, 4716, 4718]
ds-mon-assured-sr-sent-updates: 0
ds-mon-assured-sr-acknowledged-updates: 0
ds-mon-assured-sr-not-acknowledged-updates: 0
ds-mon-assured-sr-timeout-updates: 0
ds-mon-assured-sr-wrong-status-updates: 0
ds-mon-assured-sr-replay-error-updates: 0
ds-mon-assured-sr-received-updates: 0
ds-mon-assured-sr-received-updates-acked: 0
ds-mon-assured-sr-received-updates-not-acked: 0
ds-mon-assured-sd-sent-updates: 0
ds-mon-assured-sd-acknowledged-updates: 0
ds-mon-assured-sd-timeout-updates: 0
ds-mon-last-status-change-date: 20180319155951.081Z
ds-mon-status: Normal
ds-mon-domain-name: o=example

dn: cn=remote replicas,ds-mon-domain-name=o=example,cn=replicas,cn=replication,cn=monitor
objectclass: top
objectclass: ds-monitor
objectclass: ds-monitor-branch
cn: remote replicas

dn: ds-mon-replica-id=24905,cn=remote replicas,ds-mon-domain-name=o=example,cn=replicas,cn=replication,cn=monitor
objectClass: top
objectClass: ds-monitor
objectClass: ds-monitor-remote-replica
objectClass: extensibleObject
ds-mon-domain-name: o=example
ds-mon-current-delay: 0
ds-mon-replayed-updates: {"count":37616,"total":4985740.000,"mean_rate":221.972,"m1_rate":242.181,"m5_rate":100.851,"m15_rate":39.100,"mean":132.540,"min":3.998,"max":746.586,"stddev":106.705,"p50":118.489,"p75":171.966,"p95":341.836,"p98":530.579,"p99":595.591,"p999":692.060,"p9999":734.003,"p99999":746.586}
ds-mon-replica-id: 24905


Am I doing something wrong?

The topology I am working on can be installed and reproduced through:


./run-pybot.py -n -c stress -s replication.addrate OpenDJ

