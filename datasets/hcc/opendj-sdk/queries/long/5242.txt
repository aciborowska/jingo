Found using functional tests with 6.5.0-SNAPSHOT rev. (d71e9034837).

Command to reproduce the issue:


OPENDJ_PREVIOUS_VERSION=2.6.4
python3 configure.py
python3 run-pybot.py -s upgrade_group.upgradeTasks -v opendj





 

In the test we do an upgrade from 2.6.4 to latest snapshot. After upgrade we check if entry ds-cfg-backend-id=replicationChanges,cn=Backends,cn=config exists. 

After that we check global ACIs with:


ldapsearch.bat -h pyforge.example.com -p 1414 -D "cn=directory manager" -w password -b "cn=Access Control Handler,cn=config" "(objectClass=ds-cfg-dsee-compat-access-control-handler)" ds-cfg-global-aci


and we have following output:

dn: cn=Access Control Handler,cn=config ds-cfg-global-aci: 
...
...
...
(target="ldap:///dc=replicationchanges")(targetattr="*")(version 3.0; acl "Replication backend access"; deny (all) userdn="ldap:///anyone";)


Last line contains dc=replicationchanges which is unexpected and used to not be here before.