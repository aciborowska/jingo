Found with OpenDJ 4.1.0 rev 54373b39916a9d3e8999d8290d6abe03c51100f1

There are regression in our robustness tests using SASL external mechanism.
We configure a DJ with some data.
We export server certificates and import them to a client keystore
and we set up sasl external mechanism with a certificate mapper as "Subject Equals DN"

when using ldapsearch with an unexistent client certificate, rc used to be 49 and is now 91:


./opendj/bin/ldapsearch -h openam.example.com -p 1636  -o mech=EXTERNAL -b "dc=com"
-X -Z -E -K /tmp/DJ1/opendj/client_cert/clientkeystore -W "clientkeystorepass" -N "client-100-cert" "uid=user.340" postalCode
Unable to connect to the server: 91 (Connect Error)



Is it an expected change?

script to reproduce in attachment.

TO BE COMPLETED