After a successful upgrade & startup from 2.6.3 to 3.5.2 the following exception was thrown while trying apply a new matching rule for OPENDJ-3507.


Entry ds-cfg-debug-scope=org.opends.server.replication.plugin.LDAPReplicationDomain,cn=Debug Targets,cn=File-Based Debug Logger,cn=Loggers,cn=config read from LDIF starting at line 803 is not valid because it violates the server's schema configuration: Entry ds-cfg-debug-scope=org.opends.server.replication.plugin.LDAPReplicationDomain,cn=Debug Targets,cn=File-Based Debug Logger,cn=Loggers,cn=config violates the Directory Server schema configuration because it is missing attribute ds-cfg-enabled which is required by objectclass ds-cfg-debug-target


It was found there was old 2.6.x Debug Logging targets etc. were enabled before the upgrade.

Subsequent tests upgrading from 2.6.x to 4.0.0 show the upgrades go fine, but startup fails for the same reason.


Starting Server...
[27/Jul/2017:09:17:29 -0600] category=com.forgerock.opendj.ldap.config.config severity=NOTICE msgID=571 msg=Loaded extension from file '/opt/opendj/lib/extensions/snmp-mib2605.jar' (build 4.0.0, revision 0b7da454b79944f54e66daf3f591cefb5d77165b)
[27/Jul/2017:09:17:30 -0600] category=CORE severity=NOTICE msgID=134 msg=OpenDJ Server 4.0.0 (build 20170327164811, revision number 0b7da454b79944f54e66daf3f591cefb5d77165b) starting up
[27/Jul/2017:09:17:31 -0600] category=CORE severity=NOTICE msgID=139 msg=The Directory Server has sent an alert notification generated by class org.opends.server.core.DirectoryServer (alert type org.opends.server.DirectoryServerShutdown, alert ID org.opends.messages.core-141): The Directory Server has started the shutdown process. The shutdown was initiated by an instance of class org.opends.server.core.DirectoryServer and the reason provided for the shutdown was An error occurred while trying to start the Directory Server: ConfigException: Class org.opends.server.loggers.TextDebugLogPublisher specified in attribute ds-cfg-java-class of configuration entry cn=File-Based Debug Logger,cn=Loggers,cn=config cannot be instantiated as a Directory Server debug logger: org.forgerock.opendj.config.server.ConfigException: An error occurred while trying to decode the managed object configuration entry ds-cfg-debug-scope=org.opends.server.replication.plugin.LDAPReplicationDomain,cn=Debug Targets,cn=File-Based Debug Logger,cn=Loggers,cn=config: The Debug Target could not be decoded due to the following reason: The "enabled" property must be specified as it is mandatory (AbstractLogger.java:419 AbstractLogger.java:206 LoggerConfigManager.java:237 DirectoryServer.java:1437 DirectoryServer.java:5048)
[27/Jul/2017:09:17:31 -0600] category=CORE severity=NOTICE msgID=203 msg=The Directory Server is now stopped


An upgrade task should take care of stripping out or converting the old 2.6.x debug entries/schema to the new format.