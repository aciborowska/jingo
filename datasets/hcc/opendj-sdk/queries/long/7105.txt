
	Install DS 6.5.x with production mode and identity profile
	Setup AM with this identity store 
	Invoke change password as documented https://backstage.forgerock.com/docs/am/6.5/maintenance-guide/index.html#rest-api-change-password 
	AM returns: 

ERROR: An error occurred while trying to change password for identity: testuser1
Unavailable Critical Extension: The request control with Object Identifier (OID) "1.3.6.1.4.1.42.2.27.8.5.1" cannot be used due to insufficient access rights


DS error is:


{"eventName":"DJ-LDAP","client":{"ip":"192.168.56.132","port":49812},"server":{"ip":"192.168.56.132","port":3889},"request":{"protocol":"LDAP","operation":"MODIFY","connId":1953,"msgId":3,"dn":"uid=testuser1,ou=people,ou=identities"},"transactionId":"ebacddfc-0e50-4b01-a4c3-13db09cb58ff-124614","response":{"status":"FAILED","statusCode":"12","elapsedTime":1,"elapsedTimeUnits":"MILLISECONDS","detail":"The request control with Object Identifier (OID) \"1.3.6.1.4.1.42.2.27.8.5.1\" cannot be used due to insufficient access rights"},"timestamp":"2020-04-15T13:58:02.650Z","_id":"ebacddfc-0e50-4b01-a4c3-13db09cb58ff-124616"}


 



Adding this ACI resolves this issue: 


aci: (targetcontrol="1.3.6.1.4.1.42.2.27.8.5.1 || 1.3.6.1.4.1.36733.2.1.5.1") (version 3.0; acl "Allow anonymous access to behera draft and transaction control"; allow(read) userdn="ldap:///anyone";)
aci: (targetattr="userPassword") (version 3.0; acl "Allow password change"; allow (write) userdn="ldap:///self";)


 

Note: If DS with identity profile is installed without production mode, then this issue doesn't occur. 