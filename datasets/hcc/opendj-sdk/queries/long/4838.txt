Found with DJ 6.0.0 rev e1b7f368cc1

We setup 2 DJs, replicated, and a proxy pointing to these replication servers.
We add a new server, configure replication on another base dn for the 3 servers and initialize all.
Then we perform some search through the proxy on this new base dn.
Finally, we unconfigure replication this way:


./DJ1/opendj/bin/dsreplication unconfigure -h nameserver.example.com -p 4444 -I admin -w password --unconfigureAll -X -n



It works fine but there is an error in log with an exception stack:


[02/Mar/2018:10:22:26 +0100] category=SYNC severity=ERROR msgID=26 msg=Error trying to use the underlying database. The Replication Server is going to shut down: ChangelogException: Could not create replica database because the changelog database is shutting down (FileChangelogDB.java:193 FileChangelogDB.java:677 ReplicationServerDomain.java:416 ReplicationServerDomain.java:290 ServerHandler.java:898 ServerReader.java:90)



This happened in our daily job and I was able to reproduce it on my laptop using:



./run-pybot.py -s proxy_group.RouteConfigurationWithReplication opendj



Yet it is a bit random.