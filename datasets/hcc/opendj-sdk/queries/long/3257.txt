Found with opendj 4.0.0 rev f0a6cf610d8118ec7f88783343343e9099b9b95a

We setup 2 servers with ssl enabled and self-signed certificate generation.
We create a new backend on each of these servers, import some data on the first server to this backend.
Then we use the dsreplication enable and dsreplication initialize commands to replicate data between servers.
We export certificates from both servers and import these certificates to a keystore.

At the end of the test, we uninstall the first server using the following command:


${INSTANCE1}/opendj/uninstall --cli -n -a -I admin -w password -P /tmp/ks -T secret12



This command returns a 100 code and some error messages are logged in the temporary log file:


[17/08/2016:15:46:24 +0200] category=ADMIN_TOOL seq=22 severity=INFO msg=interactive: false
[17/08/2016:15:46:24 +0200] category=ADMIN_TOOL seq=23 severity=INFO msg=forceOnError: false
[17/08/2016:15:46:24 +0200] category=ADMIN_TOOL seq=24 severity=INFO msg=conf.isADS(): true
[17/08/2016:15:46:24 +0200] category=ADMIN_TOOL seq=25 severity=INFO msg=conf.isReplicationServer(): true
[17/08/2016:15:46:24 +0200] category=ADMIN_TOOL seq=26 severity=INFO msg=conf.isServerRunning(): true
[17/08/2016:15:46:24 +0200] category=ADMIN_TOOL seq=27 severity=INFO msg=Updating user data with remote servers.
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=28 severity=INFO msg=Reloading topology
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=29 severity=WARNING msg=Subject DN RDN value is: Administration Connector RSA Self-Signed Certificate and does not match host value: localhost
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=30 severity=WARNING msg=LdapException error reading server: localhost:4445
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=31 severity=WARNING msg=Subject DN RDN value is: Administration Connector RSA Self-Signed Certificate and does not match host value: localhost
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=32 severity=WARNING msg=LdapException error reading server: localhost:4444
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=33 severity=INFO msg=Loading ended at 28 ms
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=34 severity=INFO msg=Handle topology cache.
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=35 severity=INFO msg=Analyzing exception: org.opends.admin.ads.TopologyCacheException: Server Connection Closed: Heartbeat failed
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=36 severity=INFO msg=Analyzing exception: org.opends.admin.ads.TopologyCacheException: Server Connection Closed: Heartbeat failed
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=37 severity=INFO msg=exceptionMsgs: [Error reading data from server localhost:4444. There is an error with the certificate presented by the server.
Details: Server Connection Closed: Heartbeat failed, Error reading data from server localhost:4445. There is an error with the certificate presented by the server.
Details: Server Connection Closed: Heartbeat failed]
[17/08/2016:15:46:25 +0200] category=ADMIN_TOOL seq=38 severity=WARNING msg=Exception: com.forgerock.opendj.cli.ClientException: This server is configured to replicate some of its base DNs.  There was an error r
etrieving the references to it in the replicated servers.  Note that to be able to remove remote references you must provide Global Administrator credentials using the --adminUID and --bindPassword (or --bindPas
swordFile) options.
Check that the connection parameters you provided are correct.
If you want to uninstall the server even when remote references cannot be removed, you can use the --forceOnError option.

The error found was:

Error reading data from server localhost:4444. There is an error with the certificate presented by the server.
Details: Server Connection Closed: Heartbeat failed
Error reading data from server localhost:4445. There is an error with the certificate presented by the server.
Details: Server Connection Closed: Heartbeat failed
[17/08/2016:15:46:25 +0200] category=QUICKSETUP seq=39 severity=SEVERE msg=Unexpected error: com.forgerock.opendj.cli.ClientException: This server is configured to replicate some of its base DNs.  There was an e
rror retrieving the references to it in the replicated servers.  Note that to be able to remove remote references you must provide Global Administrator credentials using the --adminUID and --bindPassword (or --b
indPasswordFile) options.
Check that the connection parameters you provided are correct.
If you want to uninstall the server even when remote references cannot be removed, you can use the --forceOnError option.

The error found was:

Error reading data from server localhost:4444. There is an error with the certificate presented by the server.
Details: Server Connection Closed: Heartbeat failed
Error reading data from server localhost:4445. There is an error with the certificate presented by the server.
Details: Server Connection Closed: Heartbeat failed
[17/08/2016:15:46:25 +0200] category=QUICKSETUP seq=40 severity=INFO msg=returnValue: 100



This test used to work in 3.5.

see script in attachment to reproduce.