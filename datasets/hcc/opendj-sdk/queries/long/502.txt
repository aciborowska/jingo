The DSML gateway is not correctly forwarding modifications to userCertificate;binary attributes.

When using Jxexplorer or other dsml clients via the dsml gateway to OpenDJ are being rejected as 
invalidAttributeSyntax (When attempting to modify entry uid=gary1234,dc=europe,dc=com, one value for attribute userCertificate was found to be invalid according to the associated syntax:  The provided value is not a valid X.509 Certificate)

These seems to be that the modifyRequest containing the Certificate that is forwarded to OpenDJ by the DSML gateway is not correct:

Wireshark output:

    LDAPMessage modifyRequest(44) "uid=gary1234,dc=europe,dc=com"
        messageID: 44
        protocolOp: modifyRequest (6)
            modifyRequest
                object: uid=gary1234,dc=europe,dc=com
                modification: 1 item
                    modification item
                        operation: add (0)
                        modification userCertificate;binary
                            type: userCertificate;binary
                            vals: 1 item
                                Certificate
                                    BER Error: Wrong field in sequence  expected class:UNIVERSAL(0) tag:16(SEQUENCE) but found class:APPLICATION(1) tag:9
                                    BER Error: Wrong field in sequence  expected class:UNIVERSAL(0) tag:16(SEQUENCE) but found class:APPLICATION(1) tag:3
                                    BER Error: Sequence ate 75 too many bytes
        [Response In: 26098]

No.     Time        Source                Destination           Protocol Length Info
  26098 3279.587070 127.0.0.1             127.0.0.1             LDAP     300    modifyResponse(44) invalidAttributeSyntax (When attempting to modify entry uid=gary1234,dc=europe,dc=com, one value for attribute userCertificate was found to be invalid according to the associated syntax:  The provided value is not a valid X.509 Certificate)


For comparision modifying a entry using the same userCertificate directly to OpenDJ works OK.

bin/ldapmodify -p 1389 -D "cn=Directory Manager" -w secret12 <<EOF
dn: uid=gary1234,dc=europe,dc=com
changetype: modify
replace: userCertificate;binary
userCertificate;binary:: MIIBmjCCAQOgAwIBAgIBADANBgkqhkiG9w0BAQQFADARMQ8wDQYDVQQDEwZDQWNlcnQwHhcNMDEwNjE1MTA1NzExWhcNMTEwOTE1MTA1NzExWjAVMRMwEQYDVQQDEwpVc2VyMDBDZXJ0MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDHojZL+FlPO2PDopHPld0zcDKsTl2BEu7RTLM8qC/5AUkgT/66a4iADyiET+vlMomsuEQ+fZlgwr5rHvyhVAgSl1rpjnjDf4yo+ATeCoPli8Zo2scJFELXLGyDyufv5tcam2Mi3c0e/GEa+wqGTW4LPNx7+B3RBVlKB7lUHpUmzwIDAQABMA0GCSqGSIb3DQEBBAUAA4GBAJDz6JNAp6lanBZawivGA3xJayfU1Zai3wvEn6RCS4EM5Ry1Hb2pGGbqWvOcwDX8BQmVdAxrhQLmj6eJw9VFPqLniL5VvEh0zSkK87BAogG98AKYHkY6cRyKKph5Zq+mCYBr+q+fzaxNJDKMwkCN1X/JCCWN1sM9KuGgAcWP3wxx
EOF


Lightweight Directory Access Protocol
    LDAPMessage modifyRequest(2) "uid=gary1234,dc=europe,dc=com"
        messageID: 2
        protocolOp: modifyRequest (6)
            modifyRequest
                object: uid=gary1234,dc=europe,dc=com
                modification: 1 item
                    modification item
                        operation: replace (2)
                        modification userCertificate;binary
                            type: userCertificate;binary
                            vals: 1 item
                                Certificate (id-at-commonName=User00Cert)
                                    signedCertificate
                                    algorithmIdentifier (md5WithRSAEncryption)
                                    Padding: 0
                                    encrypted: 90f3e89340a7a95a9c165ac22bc6037c496b27d4d596a2df...
        [Response In: 1674]

No.     Time        Source                Destination           Protocol Length Info
   1674 301.873460  127.0.0.1             127.0.0.1             LDAP     82     modifyResponse(2) success
