Trying to restore offline an encrypted backup of adminRoot fails.

Steps to reproduce


	install a DJ or use an installed version
	perform a backup of the adminRoot backend with the option --encrypt
	restore the backup



Actual Result

We got an error message that warns the restore fails:



[17/06/2019:17:15:03 +0200] category=TOOLS seq=0 severity=SEVERE msg=An error occurred while attempting to acquire an exclusive lock for backend adminRoot:  The attempt to obtain an exclusive lock on file /home/ctranxuan/runtimes/forgerock/opendj-7.0.0-SNAPSHOT/locks/backend-adminRoot.lock was rejected because a shared lock was already held on that file.  This generally means some other process is still using this backend (e.g., it is in use by the Directory Server or a backup or LDIF export is in progress).  The restore cannot continue



Expected Result

Restore being successfully performed

Preliminary Analysis

They may be a side-effect from the CryptoManager that needs to get the key to encrypt from the adminRoot backend. As matter of fact, the adminRoot is already locked (shared lock) by the CryptoManager while the restoreDb tries to acquire an exclusive lock of adminRoot

Note: in attachment, a shell script to reproduce the issue.