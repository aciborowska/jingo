This is trivial to fix: we should just implement the hasValue() method for these attributes and use VirtualAttributeRules to restrict their scope. Also look at their memory allocation and strip out redundant HashSet allocations.

Changelog, first/last change number, cookie virtual attributes all need looking at.