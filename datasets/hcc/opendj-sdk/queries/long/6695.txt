A customer system has been observed to run out of heap. They have other identically configured systems which do not exhibit this problem, so why this instance has trouble and the others do not is unknown.

A heap dump has been captured (see link in private comment). In it we can see that there is a ConcurrentSkipListMap in FileChangelogDB referencing about 1.8GB of heap. This appears to be the registeredDomainCursors map. Inspecting the heap reveals ~ 3.3 million DomainDBCursor objects.

We can also see one CopyOnWriteArrayList that seems to contain ~1.6 million DomainDBCursor objects with a baseDN of cn=schema (I only checked a couple to make sure as I'm expecting them all to be the same DN), consuming about 453MB. That seems like an unexpectedly high number of cursors.
