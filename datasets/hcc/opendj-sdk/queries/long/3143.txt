Found using OpenDJ 3.5.0-M4 rev e424d96bb9fe550ea16f4894f01e33acc293f421

Scenario

	install OpenDJ 3.0.0
	stop instance
	copy new binaries (3.5.0 or 4.0.0) in the instance
	run upgrade tool

$ /tmp/opendj/upgrade -n --acceptLicense --force	
-- rc --
returned 1, expected 0
-- stdout --

>>>> OpenDJ Upgrade Utility

 * OpenDJ will be upgraded from version
 3.0.0.185acee3ba68d8da1782007eebacb3701dc996d6 to
 3.5.0.e424d96bb9fe550ea16f4894f01e33acc293f421
 * See
 '/tmp/opendj/logs/upgrade.log' for a detailed log of this operation

>>>> Preparing to upgrade

  OpenDJ 4.0.0 introduced a new format for all equality indexes based on
  "distinguishedName" attribute type, like "member", "owner", "roleOccupant"
  and "seeAlso". They all have to be rebuilt if they exist on your server and
  this could take a long time to proceed. Do you want to launch this process
  automatically at the end of the upgrade? (yes/no) yes

  The upgrade is ready to proceed. Do you wish to continue? (yes/no) yes


>>>> Performing upgrade

  Adding Bcrypt password storage scheme configuration....   20%       Adding Bcrypt password storage scheme configuration.................   100%     
  Removing configuration for matching rules......   20%       Removing configuration for matching rules...........................   100%     
  Removing old OpenDJ library files.   0%       Removing old OpenDJ library files...................................   100%     
  Removing config entry for the non-configurable configuration backend.   20%       Removing config entry for the non-configurable configuration backend.   100%     
  Restoring 'ds-cfg-delimiter-char' attribute type in concatenated
  schema.....................   33%       schema..............................................................   FAIL

 ** An error occurred reading schema file
 /tmp/opendj/config/upgrade/schema.ldif.current:
 FileNotFoundException:
 /tmp/opendj-basic-inst1/opendj/config/upgrade/schema.ldif.current
 (No such file or directory) (FileInputStream.java:-2 FileInputStream.java:195
 FileInputStream.java:138 FileReader.java:72 UpgradeTasks.java:1442
 UpgradeTasks.java:1417 Upgrade.java:779 UpgradeCli.java:315
 UpgradeCli.java:130 UpgradeCli.java:101)

 * See
 '/tmp/opendj/logs/upgrade.log' for a detailed log of this operation



