Syslog Handler is missing all logging output other than the following (Actual logging) for DS 5.5.1 - DS 7.0.0

Syslog output:

Actual logging:

Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]
Sep 30 14:45:50 opendj.forgerock.com ForgeRock-Directory-Services[1574615832]


Desired logging:


Sep 30 16:04:16 opendj.forgerock.com ForgeRock[Directory] 371397455 DJ-LDAP [ldap-access.ForgeRock Directory Services@36733 transactionId="0" userId="" runAs="" server.ip="192.168.0.72" server.port="1636" client.host="" client.ip="192.168.0.72" client.port="49002" request.protocol="LDAPS" request.operation="CONNECT" request.connId="0" request.msgId="" request.dn="" request.scope="" request.filter="" request.attrs="" request.authType="" request.controls="" request.attr="" request.idToAbandon="" request.message="" request.name="" request.newRDN="" request.newSup="" request.deleteOldRDN="" request.oid="" request.version="" request.opType="" response.status="SUCCESSFUL" response.statusCode="0" response.detail="" response.elapsedTime="0" response.elapsedTimeUnits="MILLISECONDS" response.nentries="" response.controls="" response.additionalItems="" response.failureReason="" response.maskedResult="" response.maskedMessage="" response.reason=""]
Sep 30 16:04:17 opendj.forgerock.com ForgeRock[Directory] 371397455 DJ-LDAP [ldap-access.ForgeRock Directory Services@36733 transactionId="f39de719-4fbe-491b-9968-01df96aa2cc2-4" userId="cn=Directory Manager,cn=Root DNs,cn=config" runAs="" server.ip="192.168.0.72" server.port="1636" client.host="" client.ip="192.168.0.72" client.port="49002" request.protocol="LDAPS" request.operation="BIND" request.connId="0" request.msgId="1" request.dn="cn=Directory Manager" request.scope="" request.filter="" request.attrs="" request.authType="SIMPLE" request.controls="" request.attr="" request.idToAbandon="" request.message="" request.name="" request.newRDN="" request.newSup="" request.deleteOldRDN="" request.oid="" request.version="3" request.opType="" response.status="SUCCESSFUL" response.statusCode="0" response.detail="" response.elapsedTime="257" response.elapsedTimeUnits="MILLISECONDS" response.nentries="" response.controls="" response.additionalItems="" response.failureReason="" response.maskedResult="" response.maskedMessage="" response.reason=""]
Sep 30 16:04:17 opendj.forgerock.com ForgeRock[Directory] 371397455 DJ-LDAP [ldap-access.ForgeRock Directory Services@36733 transactionId="f39de719-4fbe-491b-9968-01df96aa2cc2-9" userId="" runAs="" server.ip="192.168.0.72" server.port="1636" client.host="" client.ip="192.168.0.72" client.port="49002" request.protocol="LDAPS" request.operation="ADD" request.connId="0" request.msgId="2" request.dn="uid=user.1000000430,dc=example,dc=com" request.scope="" request.filter="" request.attrs="" request.authType="" request.controls="" request.attr="" request.idToAbandon="" request.message="" request.name="" request.newRDN="" request.newSup="" request.deleteOldRDN="" request.oid="" request.version="" request.opType="" response.status="SUCCESSFUL" response.statusCode="0" response.detail="" response.elapsedTime="83" response.elapsedTimeUnits="MILLISECONDS" response.nentries="" response.controls="" response.additionalItems="" response.failureReason="" response.maskedResult="" response.maskedMessage="" response.reason=""]
Sep 30 16:04:17 opendj.forgerock.com ForgeRock[Directory] 371397455 DJ-LDAP [ldap-access.ForgeRock Directory Services@36733 transactionId="f39de719-4fbe-491b-9968-01df96aa2cc2-14" userId="" runAs="" server.ip="192.168.0.72" server.port="1636" client.host="" client.ip="192.168.0.72" client.port="49002" request.protocol="LDAPS" request.operation="UNBIND" request.connId="0" request.msgId="3" request.dn="" request.scope="" request.filter="" request.attrs="" request.authType="" request.controls="" request.attr="" request.idToAbandon="" request.message="" request.name="" request.newRDN="" request.newSup="" request.deleteOldRDN="" request.oid="" request.version="" request.opType="" response.status="" response.statusCode="" response.detail="" response.elapsedTime="" response.elapsedTimeUnits="" response.nentries="" response.controls="" response.additionalItems="" response.failureReason="" response.maskedResult="" response.maskedMessage="" response.reason=""]
Sep 30 16:04:17 opendj.forgerock.com ForgeRock[Directory] 371397455 DJ-LDAP [ldap-access.ForgeRock Directory Services@36733 transactionId="0" userId="" runAs="" server.ip="192.168.0.72" server.port="1636" client.host="" client.ip="192.168.0.72" client.port="49002" request.protocol="LDAPS" request.operation="DISCONNECT" request.connId="0" request.msgId="" request.dn="" request.scope="" request.filter="" request.attrs="" request.authType="" request.controls="" request.attr="" request.idToAbandon="" request.message="" request.name="" request.newRDN="" request.newSup="" request.deleteOldRDN="" request.oid="" request.version="" request.opType="" response.status="SUCCESSFUL" response.statusCode="0" response.detail="" response.elapsedTime="0" response.elapsedTimeUnits="MILLISECONDS" response.nentries="" response.controls="" response.additionalItems="" response.failureReason="" response.maskedResult="" response.maskedMessage="" response.reason="Client Unbind"]



Reproduction:


	Setup Rsyslog
	Install DS 5.5.1+
	Copy in the syslog-handler.json
	Create the Syslog log publisher



dsconfig:


./dsconfig create-log-publisher --port 4444 --hostname opendj.example.com --bindDN "cn=Directory Manager" --bindPassword password --publisher-name "External Syslog Publisher Access" --type external-access --set enabled:true --set config-file:/opt/353syslog/config/syslog-handler.json --trustAll --no-prompt



syslog-handler.json:


{
   "class": "org.forgerock.audit.handlers.syslog.SyslogAuditEventHandler",
   "config": {
      "name": "Local Syslog Event Handler",
      "enabled" : true,
      "topics": [
         "ldap-access"
      ],
      "protocol": "UDP",
      "host": "localhost",
      "port": 514,
      "connectTimeout": 60,
      "facility": "SYSLOG",
      "buffering": {
         "enabled": false
      }
   }
}



See the following DS KB for more information on Rsyslog and Syslog config:

[How do I configure DS/OpenDJ (All versions) to use the Syslog audit event handler?



https://backstage.forgerock.com/knowledge/kb/article/a33163110]





Commons uses:




DS Version
Commons Version


DS 5.5.1-5.5.3
22.0.4


DS 6.0.0
23.0.x


DS 6.1.0
23.1.x


DS 6.5.x
24.0.x


DS 7.0.0
26.0.x



