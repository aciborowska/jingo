I try to import a file with the following command:


 ./bin/import-ldif -l ldif/ns.ldif.gz -n userRoot --skipfile /tmp/skipped --rejectfile /tmp/rejected --overwrite --skipSchemaValidation --skipDNValidation --isCompressed --excludefilter objectclass=nstombstone 



I always get the same error, until the --skipDNValidation option is removed:

[23/02/2016:09:51:57 -0600] category=TOOLS seq=57 severity=SEVERE msg=An error occurred while attempting to process the LDIF import:  ExecutionException: org.opends.server.backends.pluggable.spi.StorageRuntimeException: java.util.concurrent.ExecutionException: java.lang.IllegalArgumentException: Cannot accept multiple values (current=��, new=��) (FutureTask.java:122 FutureTask.java:188 OnDiskMergeImporter.java:2651 OnDiskMergeImporter.java:1241 OnDiskMergeImporter.java:893 OnDiskMergeImporter.java:142 OnDiskMergeImporter.java:212 BackendImpl.java:689 ImportLDIF.java:1092 TaskTool.java:362 ImportLDIF.java:292 ImportLDIF.java:147 ImportLDIF.java:110)



When the import fails, no rejected or skipped entries files are generated, and no entry is imported.

When removing the --skipDNValidation option, most of entries are imported and the rejected entries file contains a single entry:


# The entry 'dn:: dWlkPUM0MV9DUlN2McKgLG91PXBlb3BsZSxvPWN1c3RvbWVy
objectClass: top
uid:: QzQxX0NSU3YxwqA=
..
..
modifiersName: cn=directory manager
modifyTimestamp: 20140331141445Z
' cannot be added because an entry with that name already exists
uid=C41_CRSv1 ,ou=people,o=customer
dn:: dWlkPUM0MV9DUlN2McKgLG91PXBlb3BsZSxvPWN1c3RvbWVy
objectClass: top
uid:: QzQxX0NSU3YxwqA=
..
..
modifiersName: cn=directory manager
modifyTimestamp: 20140331141445Z



According to the content of that file, it's obvious the problem is due to a bad management of duplicate DNs, when the --skipDNValidation option is used.

That option should not make the import fail, and duplicate DN's should be handled in any case, gracefully.