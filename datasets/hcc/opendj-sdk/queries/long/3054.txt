A multi-valued attribute is changed during a modification, if one value contains the same value plus a Unicode SOFT HYPHEN character.

The behavior is different between 2.x and 3/4.x.

Example LDIF modification:



dn: uid=user.0,ou=people,dc=example,dc=com
changetype: modify
replace: givenName
givenName:: U29maWE=
givenName:: U29macKtYQ==



Note: In the second decoded value,  an "-" character was added for the example only.  Pasting the UTF8 character always removes it from Jira editors.



opendj; bin/$ echo U29maWE= | base64 -D ; echo
Sofia
opendj; bin/$ echo U29macKtYQ== | base64 -D ; echo
Sofi­-a



When applying the modification in 2.6.4:



ldapmodify -h localhost -p 1389 -w password -X -D "cn=Directory Manager" --filename user0.ldif
Processing MODIFY request for uid=user.0,ou=people,dc=example,dc=com
MODIFY operation successful for DN uid=user.0,ou=people,dc=example,dc=com



ldapmodify drops the second givenName value with the SOFT HYPHEN character:



./ldapsearch -h localhost -p 1389 -D cn=Directory Manager -w password -b dc=example,dc=com (uid=user.0) dn uid givenName
dn: uid=user.0,ou=People,dc=example,dc=com
uid: user.0
givenName: Sofie

./ldapmodify -h localhost -p 1389 -D cn=Directory Manager -w password -f ./user0.ldif
Processing MODIFY request for uid=user.0,ou=people,dc=example,dc=com
MODIFY operation successful for DN uid=user.0,ou=people,dc=example,dc=com

./ldapsearch -h localhost -p 1389 -D cn=Directory Manager -w password -b dc=example,dc=com (uid=user.0) dn uid givenName
dn: uid=user.0,ou=People,dc=example,dc=com
uid: user.0
givenName: Sofia



However ldapmodify in 3.0.0/4.0.0 drops the first givenName value without the SOFT HYPHEN character.



./ldapsearch -h localhost -p 1389 -D cn=Directory Manager -w password -b dc=example,dc=com (uid=user.0) dn uid givenName
dn: uid=user.0,ou=People,dc=example,dc=com
uid: user.0
givenName: Sofia

./ldapmodify -h localhost -p 1389 -D cn=Directory Manager -w password -f ./user0.ldif
Processing MODIFY request for uid=user.0,ou=people,dc=example,dc=com
MODIFY operation successful for DN uid=user.0,ou=people,dc=example,dc=com

./ldapsearch -h localhost -p 1389 -D cn=Directory Manager -w password -b dc=example,dc=com (uid=user.0) dn uid givenName
dn: uid=user.0,ou=People,dc=example,dc=com
uid: user.0
givenName:: U29macKtYQ==

opendj; bin/$ echo 'U29macKtYQ==' | base64 -D ; echo
Sofi­-a

