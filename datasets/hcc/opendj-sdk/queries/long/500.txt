Fixes very many critical issues.