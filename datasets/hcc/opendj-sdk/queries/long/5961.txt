Found with daily tests using 6.5.1-SNAPSHOT rev. a58d990af40. This issue cause a lot of tests to fail in replication groups. I was able to reproduce this issue only on Windows. To reproduce the issue via test framework run:


python .\run-pybot.py -s replication_group1.Basic -t add_delete_multiple_entries -v opendj


Manual steps to reproduce:

	Setup 4 servers 
	
		DJ1 - only with baseDn = dc=com
		DJ2 - only with baseDn = dc=com
		DJ3 - with baseDn = dc=com and import ldif during setup 
		DJ4 - with different root-dn for instance cn=MyDirectory instead of default cn=Directory Manager
	
	
	Configure replication between DJ3 and DJ4
	
		

.\DJ3\opendj\bat\dsreplication.bat configure --host1 localhost --port1 4446 --bindDN1 "cn=myself" --bindPassword1 "password" --noReplicationServer1 --host2 localhost --port2 4447 --bindDN2 "cn=MyDirectory" --bindPassword2 "password" --replicationPort2 8992 -b dc=com -I admin -w password -X -n

	
	




	Configure replication between DJ3 and DJ2
	
		

.\DJ3\opendj\bat\dsreplication.bat configure --host1 localhost --port1 4446 --bindDN1 "cn=myself" --bindPassword1 "password" --noReplicationServer1 --host2 localhost --port2 4445 --bindDN2 "cn=myself" --bindPassword2 "password" --replicationPort2 8990 -b dc=com -I admin -w password -X -n

	
	




	Configure replication between DJ3 and DJ1
	
		

.\DJ3\opendj\bat\dsreplication.bat configure --host1 localhost --port1 4446 --bindDN1 "cn=myself" --bindPassword1 "password" --noReplicationServer1 --host2 localhost --port2 4444 --bindDN2 "cn=myself" --bindPassword2 "password" --replicationPort2 8989 -b dc=com -I admin -w password -X -n

	
	




	Initialize instances:
	
		

DJ3\opendj\bat\dsreplication.bat initialize-all -h localhost -p 4446 -b dc=com -I admin -w password -X -n

	
	




	After above DJ1 (DSRS) , DJ2 (DSRS), DJ3(DS), DJ4(DSRS)
	Make ldif with makeldif and provided template (see attachment) labs.template^^
	
		

.\DJ1\opendj\bat\makeldif.bat -o E:\tmp\entries.ldif E:\entries.template

	
	




	Add entries with this ldif file on DJ1 server:
	
		

.\DJ1\opendj\bat\ldapmodify.bat -h localhost -p 1389 -D "cn=myself" -w password E:\tmp\entries.ldif

	
	




	The last step fails with rc==53 and saying that:
	
		

The Replication is configured for suffix dc=com but was not able to connect to any Replication Server

	
	




	
	
		or it pass and in the `errors` log is error message:
		
			

[25/Jan/2019:03:11:18 +0000] category=SYNC severity=ERROR msgID=32 msg=An unexpected error happened handling connection with Replica DS(6774) for domain "dc=com" ChangelogException: Could not decode a record from data read in log file 'java.io.RandomAccessFile@436a04f2' (BlockLogReader.java:169 LogFile.java:542 Log.java:1041 Log.java:1209 FileReplicaDBCursor.java:81 CompositeDBCursor.java:143 CompositeDBCursor.java:88 DomainDBCursor.java:25 ServerHandler.java:804 ServerHandler.java:779 ServerWriter.java:89). This connection is going to be closed

		
		
	
	



 