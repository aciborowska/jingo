During our daily tests I notice a lot of tests failed due to problem with enabling replication.

Simple scenario with 2 DSs fails due to following error:

.\dsreplication.bat configure --host1 localhost --port1 4446 --bindDN1 "cn=myself" --bindPassword1 "password" --noReplicationServer1 --host2 ig-robot-windows.internal.forgerock.com --port2 4445 --bindDN2 "cn=myself" --bindPassword2 "password" --replicationPort2 8990 -b dc=com -I admin -w password -X -n

STDOUT:
Establishing connections ..... 
Done Checking registration information ..... 
Done Configuring Replication port on server ig-robot-windows.internal.forgerock.com:4445 .....
Done Updating replication configuration for baseDN dc=com on server ig-robot-windows.internal.forgerock.com:4446 .....
Done Updating replication configuration for baseDN dc=com on server ig-robot-windows.internal.forgerock.com:4447 .....
Done Updating remote references on server ig-robot-windows.internal.forgerock.com:4447 .....

STDERR:
Could not connect to ig-robot-windows.internal.forgerock.com:4447. 
Check that the server is running and that the provided credentials are valid. 
Error details: Undefined See C:\Users\ADMINI~1\AppData\Local\Temp\opendj-replication-1626762459955831351.log for a detailed log of this operation.



In error log is following exception:

[23/Feb/2018:03:00:08 +0000] category=org.opends.messages.external severity=WARNING msgID=1 
msg=GRIZZLY0011: Uncaught exception on thread Thread[Administration Connector 0.0.0.0 port 4447(1) SelectorRunner,5,main] 
exception=UndeliverableException: Other: The Directory Server encountered 
an unexpected error while attempting to add the client request to the work queue: NullPointerException(ReplicationServer.java:856) 
(RxJavaPlugins.java:366 FlowableCreate.java:133 LdapClientConnection.java:838 LdapClientConnection.java:799 
LdapClientConnection.java:646 ModifyRequestImpl.java:54 LdapClientConnection.java:646 LdapClientConnection.java:631 
LdapClientConnection.java:605 FlowableCreate.java:72 Flowable.java:13234 FlowableDoOnLifecycle.java:38 Flowable.java:13234 Flowable.java:13183 
FlowableLift.java:49 Flowable.java:13234 Flowable.java:13180 FlowableLift.java:49 Flowable.java:13234 FlowableDoFinally.java:47 
Flowable.java:13234 ...)

In server.out is:

io.reactivex.exceptions.UndeliverableException: Other: The Directory Server encountered an unexpected error 
while attempting to add the client request to the work queue: NullPointerException(ReplicationServer.java:856)	
Caused by: Other: The Directory Server encountered an unexpected error while attempting to add the client 
request to the work queue: NullPointerException(ReplicationServer.java:856)	
at org.forgerock.opendj.ldap.LdapException.newLdapException(LdapException.java:231)	
Caused by: java.lang.NullPointerException

Marking this issue as impediment, because it cause a lot of failures in tests and most of replication suites fails in setup part.

Â 