Found with OpenDJ-4.0.0 rev 24ccabcd125b7b60e10ff0ba1642938e033cb6d3

We have regression tests which check schema replications when new objectclasses and new attributeTypes are added.

These tests now fail as 99-user.ldif are not totally identical.

scenario:

we have 2 servers, replicated, with some data.
On the first server, we add an objectclass:


./DJ1/opendj/bin/ldapmodify -h localhost -p 1389 -D "cn=myself" -w password <<END_OF_COMMAND_INPUT
dn: cn=schema
changetype: modify
add: objectClasses
objectClasses: ( testobjectclass-oid NAME 'testobjectclass-0' SUP person MAY ( street $ c ) X-ORIGIN 'user defined' )
END_OF_COMMAND_INPUT



We then add a user on second server using that objectclass:

./DJ2/opendj/bin/ldapmodify -h localhost -p 1390 -D "cn=myself" -w password --defaultAdd <<END_OF_COMMAND_INPUT
dn: cn=0-testuser-0,ou=people,dc=example,dc=com
objectclass: top
objectclass: person
objectclass: testobjectclass-0
cn: 0-testuser-0
sn: Test
c: GB
street: Test Lane
END_OF_COMMAND_INPUT



We check that 99-user.ldif are in sync but they are not:

server 1:

dn: cn=schema
objectClass: top
objectClass: ldapSubentry
objectClass: subschema
cn: schema
objectClasses: ( testobjectclass-oid NAME 'testobjectclass-0' SUP person MAY ( street $ c ) X-ORIGIN 'user defined' )
ds-sync-generation-id: 8408
modifiersName: cn=Directory Manager,cn=Root DNs,cn=config
ds-sync-state: 00000152d5ebcb794a2200000001
modifyTimestamp: 20160212143906Z



server 2:

dn: cn=schema
objectClass: top
objectClass: ldapSubentry
objectClass: subschema
cn: schema
objectClasses: ( testobjectclass-oid NAME 'testobjectclass-0' SUP person MAY ( street $ c ) X-ORIGIN 'user defined' )
ds-sync-generation-id: 8408
modifiersName: cn=Directory Manager,cn=Root DNs,cn=config
modifyTimestamp: 20160212143906Z




ds-sync-state: 00000152d5ebcb794a2200000001 only in first server

Any reason these files are not totally in sync?
