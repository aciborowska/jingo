I have set the password policy with ds-cfg-lockout-failure-count and ds-cfg-lockout-duration so that accounts get locked due to too many failed password attempts.

The account gets locked as expected after entering the wrong password X times. However, once it's locked, the result of subsequent bind requests is wrong.

If I attempt a bind with the correct password, this message shows up in the errors log:

[23/Feb/2017:20:52:02 -0500] BIND RES conn=24 op=0 msgID=1 result=49 authFailureID=197126 authFailureReason="Rejecting a bind request because the account has been locked due to too many failed authentication attempts" authDN="cn=user1,dc=example,dc=com" etime=18 


The same is conveyed in the bind result - i.e. the password response control (1.3.6.1.4.1.42.2.27.8.5.1) contains the accountLocked error code.

If I attempt a bind with an incorrect password, this message shows up in the errors log:

[23/Feb/2017:20:52:42 -0500] BIND RES conn=25 op=0 msgID=1 result=49 authFailureID=196887 authFailureReason="The password provided by the user did not match any password(s) stored in the user's entry" authDN="cn=user1,dc=example,dc=com" etime=22 


The password response control doesn't contain the accountLocked error code.

So this defeats the whole point of locking accounts - since the server returns a different response, an 'attacker' can carry out a brute force attack on the password.

This part of the problem did not happen with OpenDJ 2.6. I suspect the change causing it is OPENDJ-1443.

Moreover, pwdFailureTime attribute values continue to get added to the account despite it being locked. This will lead to excessive growth in the user record as the brute force is attempted.
This part of it did happen with OpenDJ 2.6 as well.