Found with OpenDJ 7.0.0 rev a46cf4769e1

Regression found in our groups tests.

We set up a server with some users and some static and dynamic groups.
We enable the retrieval of membership for virtual attributes:


./DJ1/opendj/bin/ldapmodify -h nameserver.example.com -p 1389 -D "cn=Directory Manager" -w password
dn: cn=Virtual Static uniqueMember,cn=Virtual Attributes,cn=config
changetype: modify
replace: ds-cfg-allow-retrieving-membership
ds-cfg-allow-retrieving-membership: true




We add a virtual static group entry:

./DJ1/opendj/bin/ldapmodify -h nameserver.example.com -p 1389 -D "uid=my_application,dc=groups,dc=com" -w pw_my_application
dn:cn=my_newVirtualStaticGroup,dc=groups,dc=com
cn:my_newVirtualStaticGroup
objectclass:top
objectclass:groupOfUniqueNames
objectclass:ds-virtual-static-group
description:this is the description of my_newVirtualStaticGroup
ds-target-group-dn:cn=my_dynamicgroup1,dc=groups,dc=com




We check membership of a user that belongs to cn=my_dynamicgroup1,dc=groups,dc=com


./DJ1/opendj/bin/ldapsearch -h nameserver.example.com -p 1389 -D "cn=Directory Manager" -w password -b "uid=user_02,ou=dynamic,dc=groups,dc=com"  "(objectclass=*)" isMemberOf

dn: uid=user_02,ou=dynamic,dc=groups,dc=com
isMemberOf: cn=my_dynamicgroup1,dc=groups,dc=com




It does not show up the virtual group membership.


To reproduce:


./run-pybot.py -n -v -s groups_group.VirtualStatic -t enable_member_virtual_attribute -t Add_A_Virtual_Static_Group_Entry opendj

