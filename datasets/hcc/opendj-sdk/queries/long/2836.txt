

public DiffOptions replaceSingleValuedAttributes() {
            return replaceMaxValues(1);
}



Using this option with diffEntries to compute changes on a single valued attribute does not result in a replace operation. The outcome will still be the default delete+add.

This unit test encapsulates reproduction instructions and expected outcome:



    @Test
    public void testDiffEntriesReplaceSingleValue() {
        // @formatter:off
        Entry from = new LinkedHashMapEntry(
            "dn: cn=test",
            "description: from");
        Entry to = new LinkedHashMapEntry(
            "dn: cn=test",
            "description: to");
        ModifyRequest expected = Requests.newModifyRequest(
            "dn: cn=test",
            "changetype: modify",
            "replace: description",
            "description: to");
        // @formatter:on
        assertEquals(diffEntries(from, to, diffOptions().replaceSingleValuedAttributes()), expected);
    }

