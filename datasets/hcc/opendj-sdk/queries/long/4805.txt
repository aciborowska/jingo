Version and revision: 



OpenDJ 6.0.0-SNAPSHOT (65b3063724f)





With daily tests I noticed an error message with NPE:

[22/Feb/2018:05:33:48 +0000] severity="ERROR" msgCount=5 msgID=org.opends.messages.config-646 message="org.forgerock.opendj.config.server.ConfigChangeListenerAdaptor.applyConfigurationChange failed for entry ds-cfg-backend-id=userRoot,cn=Backends,cn=config: result code=Other, admin action required=false, messages="NullPointerException (JEStorage.java:713 JEStorage.java:698 TracedStorage.java:443 EntryContainer.java:2371 EntryContainer.java:145 ServerManagedObjectChangeListenerAdaptor.java:50 ConfigChangeListenerAdaptor.java:279 ConfigurationHandler.java:607 ConfigurationBackend.java:371 ModifyOperation.java:644 ModifyOperation.java:475 ModifyOperation.java:393 InternalClientConnection.java:429 InternalClientConnection.java:411 FlowableCreate.java:72 Flowable.java:13234 Flowable.java:13180 FlowableLift.java:49 Flowable.java:13234 FlowableDoFinally.java:47 Flowable.java:13234 ...)"" 
[22/Feb/2018:05:33:48 +0000] severity="ERROR" msgCount=6 msgID=org.opends.messages.config-646 message="org.forgerock.opendj.config.server.ConfigChangeListenerAdaptor$1.applyConfigurationChange failed for entry ds-cfg-backend-id=userRoot,cn=Backends,cn=config: result code=Other, admin action required=false, messages="NullPointerException (JEStorage.java:713 JEStorage.java:698 TracedStorage.java:443 AttributeIndex.java:829 AttributeIndex.java:78 ServerManagedObjectChangeListenerAdaptor.java:50 ConfigChangeListenerAdaptor.java:279 ConfigChangeListenerAdaptor.java:202 ConfigurationHandler.java:607 ConfigurationBackend.java:371 ModifyOperation.java:644 ModifyOperation.java:475 ModifyOperation.java:393 InternalClientConnection.java:429 InternalClientConnection.java:411 FlowableCreate.java:72 Flowable.java:13234 Flowable.java:13180 FlowableLift.java:49 Flowable.java:13234 FlowableDoFinally.java:47 ...)""

The ^^ message is several times in the output and it is followed with message:

[22/Feb/2018:05:33:48 +0000] severity="ERROR" msgCount=22 msgID=null--1 message="Other: The task could not enable a backend: ds-cfg-backend-id=userRoot,cn=Backends,cn=config"

The error comes from a command 

./opendj/bin/rebuild-index -h localhost -p 4445 -D "cn=myself" -w password -X -b dc=com --rebuildAll

In the test right before rebuild index a ttl reaper is enabled with command:

./opendj/bin/dsconfig -h localhost -p 4445 -D "cn=myself" -w password -X set-backend-index-prop --backend-name userRoot --index-name expirationAttr --set ttl-enabled:true -n

Example of entry with this attribute:

dn: uid=user.0,ou=People,dc=example,dc=com 
cn: user 0 
sn: 0 
givenname: user 
objectclass: top 
objectclass: person 
objectclass: organizationalPerson 
objectclass: inetOrgPerson 
objectclass: expirationObj 
expirationAttr: 20180222053239Z 
ou: People 
l: Cupertino 
uid: user.0 
mail: user.0@example.com 
telephonenumber: +1 408 555 1476 
facsimiletelephonenumber: +1 408 555 1992 
roomnumber: 3915 
userpassword: password

The schema definition:

attributeTypes: ( 1.3.6.1.4.1.36733.2.2.1.98 NAME ( 'expirationAttr' ) DESC 'expiration date attr first' SYNTAX 1.3.6.1.4.1.1466.115.121.1.24 SINGLE-VALUE X-ORIGIN 'pyforge' )
objectClasses: ( 1.3.6.1.4.1.36733.2.2.2.27 NAME 'expirationObj' DESC 'new test obj' SUP top AUXILIARY MUST ( expirationAttr ) X-ORIGIN 'pyforge' )

 The created index type is ordering.