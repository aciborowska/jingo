The following snippet of code behaves does not behave intuitively and is inconsistent with the behavior of JNDI APIs:

  // Read in the contents of a photo as a byte array.
  byte[] photoBytes = ...;

  // Add the photo attribute.
  ModifyRequest request = ...;
  request.addModification(ModificationType.ADD, "photo", photoBytes);

This doesn't work as expected because the method calls ByteString.valueOf(Object) which converts its parameter to a String and then back to a byte array containing the UTF-8 encoding of the String. The ByteString.valueOf(Object) method already detects ByteSequence objects and handles those appropriately, but it should also handle byte arrays in a similar manner.