A number of new attributes introduced for the enhanced password policy subentry are defined as strings in the schema, but have their values parsed as integers in the code. This needs correcting, one way or the other.

If we end up with password policy subentries containing a mix of draft attributes and enhanced attributes, I'd suggest keeping everything as INTEGER for consistency. But if we decide that ds-pwp-password-policy should not inherit from pwdPolicy then I'd suggest using Duration syntaxes instead for ease of use.

e.g.



Attribute
Syntax
Parsed as


ds-pwp-idle-lockout-interval
1.3.6.1.4.1.1466.115.121.1.15
Long


ds-pwp-max-password-reset-age
1.3.6.1.4.1.1466.115.121.1.15
Long


ds-pwp-password-history-duration
1.3.6.1.4.1.1466.115.121.1.15
Long





I also note a discrepancy between:



Attribute
Syntax


ds-pwp-last-login-time-format
1.3.6.1.4.1.1466.115.121.1.26


ds-pwp-previous-last-login-time-format
1.3.6.1.4.1.1466.115.121.1.15





Why is one IA5 and the other UTF-8? This is inherited from the underlying ds-cfg-* attribute definitions, but it doesn't make sense. Internally they're just strings passed to java.text.SimpleDateFormat, which doesn't mention it is limited to ASCII/IA5. Suggest we change ds-pwp-last-login-time-format to UTF-8 as well for consistency.