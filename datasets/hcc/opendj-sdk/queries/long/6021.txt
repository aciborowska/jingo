Found with rev 0841ebe7387

We have a test that sets up 4 DJs, in a replication topology with  2 DSs, 2 RSs.
We configure them with a group id DJ1 and RS1 in group 1, DJ2 and RS2 in group 2.
We set up a proxy in front of this replication topology, with a primary group id:


./PROXY1/opendj/setup --profile ds-proxy-server --set ds-proxy-server/rsConnectionSecurity:none --set ds-proxy-server/proxyUserBindDn:"cn=proxy,dc=com" --set ds-proxy-server/proxyUserBindPassword:"password" --set ds-proxy-server/replicationServers:"localhost:4447" --set ds-proxy-server/primaryGroupId:"1" --set ds-proxy-server/rsBindDn:"cn=myself" --set ds-proxy-server/rsBindPassword:"password" --trustAll -h localhost -p 1391 -D "cn=myself" -w password --adminConnectorPort 4446 --monitorUserDn "uid=Monitor" --monitorUserPassword password -O 



When checking the configuration, every server is seen as a secondary server:

./PROXY1/opendj/bin/ldapsearch -h localhost -p 1391 -D "cn=myself" -w password -b "cn=monitor"  "ds-cfg-backend-id=proxyRoot" ds-mon-backend-proxy-shard

dn: ds-cfg-backend-id=proxyRoot,cn=backends,cn=monitor
ds-mon-backend-proxy-shard: {"id":"Replication Service Discovery Mechanism","primaryServers":[],"secondaryServers":[{"hostPort":"localhost:1397","online":true},{"hostPort":"localhost:1398","online":true},{"hostPort":"localhost:1403","online":true},{"hostPort":"localhost:1402","online":true}]}



This is a regression since group id is a global configuration property.

To reproduce:

./run-pybot.py -n -v -s proxy_group.ReplicationDiscovery -t Verify_Preferred_Group_Id_Is_Chosen dj

