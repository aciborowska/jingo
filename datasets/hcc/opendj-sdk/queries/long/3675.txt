The OpenAM team are reporting that certain searches do not seem to be indexed as they first imagined. They have provided sample config, schema, and LDIF to demonstrate. Steps to reproduce:


	install OpenDJ:

$ ./setup directory-server --adminConnectorPort 4444 --rootUserDN cn=directory\ manager --rootUserPassword password --ldapPort 1389 --hostname localhost --doNotStart


	copy the attached config and schema:

$ cp /path/to/99-user.ldif config/schema
$ cp /path/to/config.ldif config


	import the CTS data and start the server and then observe that there are more than 100K entries:

$ ./bin/import-ldif -l /path/to/cts-backup.ldif -n userRoot -F --offline
$ ./bin/start-ds
[03/Feb/2017:17:23:49 +0100] category=CORE severity=NOTICE msgID=134 msg=OpenDJ Server 4.0.0-SNAPSHOT (build 20170203160655, revision number f25c9ddec04166e97aa580476b0ff215aa03659c) starting up
[03/Feb/2017:17:23:51 +0100] category=JVM severity=NOTICE msgID=21 msg=Installation Directory:  /home/matt/opendj-openam-test
[03/Feb/2017:17:23:51 +0100] category=JVM severity=NOTICE msgID=23 msg=Instance Directory:      /home/matt/opendj-openam-test
[03/Feb/2017:17:23:51 +0100] category=JVM severity=NOTICE msgID=17 msg=JVM Information: 1.7.0_80-b15 by Oracle Corporation, 64-bit architecture, 3717201920 bytes heap size
[03/Feb/2017:17:23:51 +0100] category=JVM severity=NOTICE msgID=18 msg=JVM Host: matts-laptop, running Linux 4.8.0-34-generic amd64, 16724770816 bytes physical memory size, number of processors available 8
[03/Feb/2017:17:23:51 +0100] category=JVM severity=NOTICE msgID=19 msg=JVM Arguments: "-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005", "-Dorg.opends.server.scriptName=start-ds"
[03/Feb/2017:17:23:52 +0100] category=BACKEND severity=NOTICE msgID=513 msg=The database backend userRoot containing 102636 entries has started
[03/Feb/2017:17:23:52 +0100] category=EXTENSIONS severity=NOTICE msgID=221 msg=DIGEST-MD5 SASL mechanism using a server fully qualified domain name of: matts-laptop
[03/Feb/2017:17:23:53 +0100] category=PROTOCOL severity=NOTICE msgID=276 msg=Started listening for new connections on Administration Connector 0.0.0.0 port 4444
[03/Feb/2017:17:23:53 +0100] category=PROTOCOL severity=NOTICE msgID=276 msg=Started listening for new connections on LDAP Connection Handler 0.0.0.0 port 1389
[03/Feb/2017:17:23:53 +0100] category=CORE severity=NOTICE msgID=135 msg=The Directory Server has started successfully
[03/Feb/2017:17:23:53 +0100] category=CORE severity=NOTICE msgID=139 msg=The Directory Server has sent an alert notification generated by class org.opends.server.core.DirectoryServer (alert type org.opends.server.DirectoryServerStarted, alert ID org.opends.messages.core-135): The Directory Server has started successfully


	perform a greater than search that is apparently falsely processed as unindexed:

$ ./bin/ldapsearch -h localhost -p 1389 -b "dc=com" -D "cn=directory manager" -w password "(&(&(coreTokenDate04>=20170119135500.223Z)(coreTokenString13=VALID)(coreTokenType=SESSION))(objectClass=frCoreToken))" debugsearchindex
...


	perform a less than search that is apparently falsely processed as unindexed:

$ ./bin/ldapsearch -h localhost -p 1389 -b "dc=com" -D "cn=directory manager" -w password "(&(&(coreTokenDate04<=20170119135500.223Z)(coreTokenString13=VALID)(coreTokenType=SESSION))(objectClass=frCoreToken))" debugsearchindex
...



