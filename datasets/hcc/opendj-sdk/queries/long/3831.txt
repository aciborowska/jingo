org.forgerock.opendj.ldap.ConnectionLoadBalancer#getConnection() uses org.forgerock.opendj.ldap.LoadBalancer#getMonitoredConnectionFactory() to retrieve the ConnectionFactory it will use to get a connection. This will check the isOperational flag of the connection factory, and throw an exception if no servers are found which are operational. However, if a server is offline for any reason, the only way for it to come back online is for org.forgerock.opendj.ldap.LoadBalancer.MonitoredConnectionFactory#notifyOnline() to be called. This happens when a connection is requested and succeeds, or results are handled.

This means that ConnectionLoadBalancer will not be able to recover from a connection factory being marked as non operational without the factory being used elsewhere.

See linked OPENAM-10715 for replication. Note that we have had limited success in replicating this locally, likely due to not doing anything which resulted in the connection factory being used during the disconnect.