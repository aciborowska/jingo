I've setup 2 servers, one with a hard-coded server-id (1) and one with the server id set as an expression (&{server.id}).

When trying to enable replication, there is a NPE error thrown and dsreplication aborts.

$ ./bin/dsreplication configure --host1 `uname -n` --port1 4444 --bindDN1 "cn=directory manager" --bindPassword1 secret12 --replicationPort1 8989 --host2 `uname -n` --port2 5444 --bindDN2 "cn=directory manager" --bindPassword2 secret12 --replicationPort2 9989 --adminUID admin --adminPassword password --baseDN "dc=example,dc=com" -X -n


Establishing connections ..... Done
Checking registration information ..... Done
Configuring Replication port on server lpmbp.local:4444 ..... Done
Configuring Replication port on server lpmbp.local:5444 ..... Exception in thread "main" java.lang.NullPointerException
	at java.util.TreeMap.compare(TreeMap.java:1294)
	at java.util.TreeMap.put(TreeMap.java:538)
	at java.util.TreeSet.add(TreeSet.java:255)
	at java.util.stream.ReduceOps$3ReducingSink.accept(ReduceOps.java:169)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.TreeMap$KeySpliterator.forEachRemaining(TreeMap.java:2746)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.forgerock.opendj.config.client.spi.Driver$DefaultValueFinder.getInheritedProperty(Driver.java:213)
	at org.forgerock.opendj.config.client.spi.Driver$DefaultValueFinder.visitAbsoluteInherited(Driver.java:102)
	at org.forgerock.opendj.config.client.spi.Driver$DefaultValueFinder.visitAbsoluteInherited(Driver.java:76)
	at org.forgerock.opendj.config.AbsoluteInheritedDefaultBehaviorProvider.accept(AbsoluteInheritedDefaultBehaviorProvider.java:59)
	at org.forgerock.opendj.config.client.spi.Driver$DefaultValueFinder.find(Driver.java:153)
	at org.forgerock.opendj.config.client.spi.Driver$DefaultValueFinder.access$100(Driver.java:76)
	at org.forgerock.opendj.config.client.spi.Driver.findDefaultValues(Driver.java:553)
	at org.forgerock.opendj.config.client.spi.AbstractManagedObject.createProperty(AbstractManagedObject.java:716)
	at org.forgerock.opendj.config.client.spi.AbstractManagedObject.createNewManagedObject(AbstractManagedObject.java:694)
	at org.forgerock.opendj.config.client.spi.AbstractManagedObject.createChild(AbstractManagedObject.java:336)
	at org.forgerock.opendj.server.config.meta.ReplicationSynchronizationProviderCfgDefn$ReplicationSynchronizationProviderCfgClientImpl.createReplicationServer(ReplicationSynchronizationProviderCfgDefn.java:341)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.configureAsReplicationServer(ReplicationCliMain.java:4927)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.configureServer(ReplicationCliMain.java:4125)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.updateConfiguration(ReplicationCliMain.java:3928)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.configureReplication(ReplicationCliMain.java:2976)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.configureReplication(ReplicationCliMain.java:703)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.execute(ReplicationCliMain.java:541)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.execute(ReplicationCliMain.java:499)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.mainCLI(ReplicationCliMain.java:420)
	at org.opends.server.tools.dsreplication.ReplicationCliMain.main(ReplicationCliMain.java:380) 