There heartbeat messages are not serialized with respect to updates in RS to RS communication. This results in change numbers being indexed differently across RSs.

For this issue to be fixed, RS must send heartbeat messages serialized with updates, i.e. updates / heartbeats must be sent in CSN increasing order.
 It looks like this issue can be reproduced easily as demonstrated by functional tests when adding a log message when updates are inserted out-of-order in the change number index DB.