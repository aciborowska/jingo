Those methods change the inner state of Packet, work on Packet so they should better be methods of class Packet. This may help to clarify synchronization.