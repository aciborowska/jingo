Leader election recipe originally contributed to ZOOKEEPER-1080.