we have developed a large scale pub/sub system based on ZooKeeper and BookKeeper.