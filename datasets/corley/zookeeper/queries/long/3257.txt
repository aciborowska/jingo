There is duplication of effort when updating the stats. Merge the count update and the byte update into one call and simplify the logic.