Cnxns is currently stored as a HashSet but may be accessed by multiple threads concurrently. Instead of doing our own sync we should investigate using a proper concurrent data structure for this.