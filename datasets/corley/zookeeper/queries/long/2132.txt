If multiple leader elections occur before SyncRequestProcessor takes a snapshot and rolls logs (at least 50000 transactions by default). PurgeTxnLog may inadvertently delete the current transaction log file.

Follower::syncWithLeader currently takes a snapshot after it is synced with the leader but does not roll logs. If a zookeeper restart of a quorum of nodes occurs, the cluster may silently revert back to the last snapshot, loosing all transactions in the log!