the leader and follower code need to be modified to correctly handle and log epoch changes