isvalidsnapshot should handle the case of 0 snapshot files better.