significant cleanup of existing tests