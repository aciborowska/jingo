Inconsistent truncation logic and out of sync logging and comments in recovery code