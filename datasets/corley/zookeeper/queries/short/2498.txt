Potential resource leak in C client when processing unexpected / out of order response