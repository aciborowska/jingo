snapshotting doesn't handle runtime exceptions (like out of memory) well