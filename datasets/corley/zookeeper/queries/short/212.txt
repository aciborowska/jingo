snapshot is synchronous in 3.0