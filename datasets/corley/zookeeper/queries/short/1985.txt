Memory leak in C client