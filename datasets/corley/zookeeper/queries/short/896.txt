Improve client to support dynamic authentication schemes