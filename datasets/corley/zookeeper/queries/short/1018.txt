The connection permutation in get_addrs uses a weak and inefficient shuffle