Error handling issues in truncation code