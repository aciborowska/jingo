Snapshot serialization race condition can lead to partial transaction and inoperable data node