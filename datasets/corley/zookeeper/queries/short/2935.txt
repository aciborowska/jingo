[QP MutualAuth]: Port ZOOKEEPER-1045 implementation from branch-3.5 to trunk