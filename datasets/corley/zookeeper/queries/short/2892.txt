Improve lazy initialize and close stream for `PrepRequestProcessor`