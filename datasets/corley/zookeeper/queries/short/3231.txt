 Purge task may lost data when we have many invalid snapshots.