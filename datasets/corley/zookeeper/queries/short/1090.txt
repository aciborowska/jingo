Race condition while taking snapshot can lead to not restoring data tree correctly