Fix the cnxns to use a concurrent data structures