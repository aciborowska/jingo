Bookie id generation (InetAddress.getLocalHost().getHostAddress() + ":" + port) is scattered all over the place. It would be better to have it centrallized somewhere in a static call.