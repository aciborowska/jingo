As in BOOKKEEPER-191, we changed ledgers to let consumed messages be garbage collected. But introduced latency in publishing, when changing ledgers, the published messages would be queued until finished created ledger and update ledger ranges. All the queued messages's latency would be affected by the metadata operations.