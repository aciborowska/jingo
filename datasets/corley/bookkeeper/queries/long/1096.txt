Currently when we delete a ledger, we delete just the leaf node in the ZK but we ignore about the branch nodes. This is ok for FlatLedgerManager, but for HierarchicalLedgerManagers, especially for LongHierarchicalLedgerManager, the number of internal nodes gets blown up over time and we would get into ZK capacity limitations. When ZK reaches the capacity limits, it will manifest in very severe performance and stability issues of cluster. So for HierarchicalLedgerManagers, when we delete a ledger we should optimistically recursively delete the parent znodes as well if they donâ€™t have anymore child znodes. 