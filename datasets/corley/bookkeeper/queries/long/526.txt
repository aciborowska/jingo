similar as BOOKKEEPER-461. there is only one thread running processing delivery, which would be bottleneck when sub/closesub or throttle became frequently.