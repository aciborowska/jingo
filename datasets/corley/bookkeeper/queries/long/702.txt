HDFS is using BK for the shared memory approach through BKJM plugin. Presently HDFS is using Bookkeeper4.0.0 version and when tries to upgrade to latest 4.2.2 version, there is a conflicts in protobuf versions between the components. Latest HDFS 2.1 branch is using protobuf-java-2.5.0 version, but BK has protobuf-java-2.4.1 version.