When a bookie is disconnected from the zk server, zk does not know about this immediately. As a result, if I try to restart the bookie, meanwhile, it will not be able to. Zk server believes that the server trying to reconnect already has a connection. Instead of throwing KeeperException for existing node, zk server should wait until the pre-existing connection times out and tries to reconnect. Or zk server should ignore the old metadata about this node, and re-connect immediately (but I guess this solution may cause security issues).