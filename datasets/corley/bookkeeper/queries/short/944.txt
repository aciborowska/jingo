Multiple issues and improvements to BK Compaction.