Refactor garbage collection code for ease to plugin different GC algorithm.