TODO: handle session disconnects and expires