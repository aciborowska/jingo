Merge PerChannelBookieClient goodness from trunk to 4.2 branch