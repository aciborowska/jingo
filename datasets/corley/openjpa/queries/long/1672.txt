I have a testcase which still had a 1.0 persistence.xml[1], but is running against a 2.0 driver. Calling em.detach(...) doesn't actually detach my Entity. I did some debugging and it appears that we try to do something tricky and revert back to an "old" way of doing things via a Compatibility flag... unfortunately this flag is incorrect. As far as I can tell we set this flag (Compatibility.CopyOnDetach), but since em.detach(...) doesn't have a return type with 2.0, my Entity never gets detached. To work around this problem I updated my p.xml and everything now works as expected.

Opening this issue so we don't lose track of it.

[1] <persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">