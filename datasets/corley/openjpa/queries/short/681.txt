Subquery generates SQL with syntax error