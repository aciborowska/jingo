use of getFetchPlan().setMaxDepth(x) puts DISTINCT in the SQL