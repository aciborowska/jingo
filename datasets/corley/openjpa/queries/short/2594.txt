Deleting an object with embedded field causes exception under some circumstances