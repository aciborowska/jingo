If a zero length BZIp file is created as a result of a store, the resulting BZIp file will be invalid: it will have part of the BZip header, but it will be missing everything else. The BZip library does not behave correctly when a BZip file is created and nothing is written before the close.