TEZ-3983 fixes vertex groups to work properly with 1-1 edges. So we should switch to that instead of  using unordered partitioned shuffle edge in https://github.com/apache/pig/blob/5b0a0bfaefad0d57c6c9fbbc09d709d13ea9af93/src/org/apache/pig/backend/hadoop/executionengine/tez/plan/optimizer/UnionOptimizer.java#L635-L642). The current logic of partitioning based on hashcode of values is slightly expensive. For backward compatibility with older Tez versions, have to support both modes possibly via configuration setting or Tez version check.