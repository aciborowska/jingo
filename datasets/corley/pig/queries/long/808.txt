See PIG-804 for a use case which exposes this bug. We should probably be setting up lineage information outside getFieldSchema() through a visitor at a point where we know it is safe - (just before TypeCheckingVisitor?). 