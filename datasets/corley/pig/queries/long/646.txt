We have seen the case where if a bag passed to distinct UDF is too large to fit into main memory the job fails with a time out because no progress is reported.