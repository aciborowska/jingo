The TypeCastInserter inserts a LOForeach into a logical plan even if it doesn't need to make any casts. The attached patch adds a special case to the TypeCastInserter to skip this behaviour if possible. The patch also refactors some of the if-instanceof-x-else-if-instanceof-y behaviour into subclasses.