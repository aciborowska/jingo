We came across a bug that happens when you have a distinct operator immediately followed by a union where the result of the union has at least one column that will be pruned by ColumnMapKeyPrune.  There's a test showing an example script in the submitted patch.