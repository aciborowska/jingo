Currently, once we spill the bag, if no additional memory becomes available, we would be spilling 1 record at a time because of the problem with the logic. Short term, we will make a change to spill 100 records at a time. Longer term, we need to try and drain the memory before doing so.