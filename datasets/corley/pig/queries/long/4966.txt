Hive refactored their RecordReader code in Hive 2.1. This patch maintains compatibility with Hive 2.1 and previous versions.