EvalFunc ctor uses reference equality instead of value equality when verifying return type of "final" UDF and parent Algebraic UDF are equal. This is fine in the case when both values are Class instances, but breaks when return types are ParameterizedType instances. This prohibits the creation of an Algebraic UDF whose return type is Map<String, Long>, for instance. Please see the included unit test for an example along these lines.