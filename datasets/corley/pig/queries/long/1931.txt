Currently Macro expansion is implemented as a preprocessor (PIG-1793) so that it can work with the old parser. Now the new parser replaced old parser in trunk and we can integrate macro expansion into the new parser. This has many advantages such as better error reporting, less code and making Macro part of Pig Latin.

To aid debugging, Pig command line option -r (dryrun) will produce a script with expanded macros (in addition to the script with substituted parameters).