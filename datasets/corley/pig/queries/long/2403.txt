The current type-specific implementations of Max, Min, and Sum have a lot of duplicated code. We can reduce this significantly.