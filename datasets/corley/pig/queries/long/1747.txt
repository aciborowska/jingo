Map-reduce plan optimization phase of query planning in pig uses several visitors. Each of these visitors use custom code to identify patterns in physical plan to determine if the optimization should be applied. Having pattern match utility classes that works with physical plan will make writing new visitors easier.