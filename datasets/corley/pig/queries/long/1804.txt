Currently Python UDFs can only be simple functions. For performance improvements in advanced use cases it should be possible to extend Algebraic and/or Accumulator interfaces