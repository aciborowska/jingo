Calling Distinct(NULL) throws NPEs - it should handle this more gracefully. The attached patch makes Distinct(NULL) == {}, although it could return NULL.