I think the root problem was that I forget to specify the configuration using -Djunit.hadoop.conf=hadoop-site.xml while running the tests.
But the error could be clearer...

The logs are big so I will provide them in a separate file...

But the core problem is:

    [junit] java.lang.NullPointerException
    [junit] 	at org.apache.pig.impl.logicalLayer.parser.QueryParser.Alias(QueryParser.java:471)
    [junit] 	at org.apache.pig.impl.logicalLayer.parser.QueryParser.NestedExpr(QueryParser.java:411)
    [junit] 	at org.apache.pig.impl.logicalLayer.parser.QueryParser.NestedExpr(QueryParser.java:417)
    [junit] 	at org.apache.pig.impl.logicalLayer.parser.QueryParser.GroupItem(QueryParser.java:1027)
...
    [junit] org.apache.pig.impl.logicalLayer.parser.ParseException: Encountered "group" at line 1, column 9.
    [junit] Was expecting one of:
    [junit]     <IDENTIFIER> ...
    [junit]     "(" ...
    [junit]     
    [junit] 	at org.apache.pig.impl.logicalLayer.parser.QueryParser.generateParseException(QueryParser.java:4142)
...
    [junit] org.apache.pig.impl.logicalLayer.parser.ParseException: Encountered "generate" at line 1, column 1.
    [junit] Was expecting one of:
    [junit]     "load" ...
    [junit]     "filter" ...

