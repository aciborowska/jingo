In order to make Pig work with hadoop security, we need to set "mapreduce.job.credentials.binary" in the JobConf before we call getSplit() in the backend. We need to change code in merge join.