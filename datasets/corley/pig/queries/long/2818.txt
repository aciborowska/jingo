According to https://issues.apache.org/jira/browse/PIG-2815?focusedCommentId=13415430&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13415430 there are still few corner cases.