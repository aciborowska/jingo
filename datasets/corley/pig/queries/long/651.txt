POForEach has lot of code to handle flattening (cross product) of the fields in the generate. This is relevant only when atleast one field in the generate needs to be flattened. If all fields in the generate do not need to be flattened, a more simplified and hopefully more efficient POForEach can be used.