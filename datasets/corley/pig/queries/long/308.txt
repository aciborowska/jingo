Queries that use the JOIN keyword are returning incorrect results because the flatten values are not being set to true for the foreach that is put after the cogroup.