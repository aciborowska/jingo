There are some issues in the original implementation of PIG-4066. Since the fix will touch most part of the patch, I'd like to rollback PIG-4066 and reimplement here.