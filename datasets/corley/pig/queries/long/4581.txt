NodeIdGenerator use an HashMap without any synchronization. In multithreaded environment it may lead to concurrent access to the HashMap which, in some case, triggers an infinite loop inside the HashMap implementation => the parsing of the pig request never ends so the job will never run + it eats a threads in the JVM that just keep burning CPU cycles.

since it is hard to reproduce and it is not a deterministic bug it is impossible to provide a viable unit tests for it to demonstrate both the bug and the fix.