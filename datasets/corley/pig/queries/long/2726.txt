Look into SQL/Oracle server for how they are handling legitimate NULL values in the input while performing operations like roll-up, filtering etc. Current implementation outputs NULL string which should be replaced by actual null value.