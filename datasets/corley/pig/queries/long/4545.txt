It seems to be an HBase bug (HBASE-10029). I'd like to fix it by upgrading HBase to a newer version, which anyway we'd like to do.