Pig currently uses the Hadoop mini-cluster to run the queries in local mode. That patch above uses the physical layer to do the evaluations without using map-reduce. The patch also addresses a bug in the local implementation of POCogroup that resulted in erroneous output for inner cogroups.