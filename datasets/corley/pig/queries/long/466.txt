Currently, each operator carries all the data until foreach is encountered. This can cause significant performance degradation.