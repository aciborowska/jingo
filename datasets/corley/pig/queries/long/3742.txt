Classify whether a vertex is a map or reduce and set java.opts (mapreduce.map.java.opts or mapreduce.reduce.java.opts), memory.mb (mapreduce.map.memory.mb or mapreduce.reduce.memory.mb) and env (mapreduce.map.env or mapreduce.reduce.env) accordingly on the vertex. A simple thing would be to assume all root vertexes to be map vertexes and intermediate or leaf vertexes to be reduce vertexes.