Our profiling shows that for large (multi-K line) scripts, a lot of time is spent trying to find common UDFs in resolveClassName(). This is trivial to cache.