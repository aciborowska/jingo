As part of starting to rewrite the DataStorage APIs, I wrote some unit tests for the existing DataStorage implementations to make sure I wasn't breaking anything.  In testing the open code, I found that LocalFile doesn't respect the active container you set you LocalDataStorage, so if you open a relative file, it's relative to wherever you're running the code.  Similarly, while testing the copy operations, I found that HFile doesn't allow copying to anything other than other HFiles and that HDirectory's copy operation was never used because it had the wrong signature.

The attached patch fixes these issues and adds tests for much of the DataStorage API for both of the existing backends.  There are no tests for the sopen code as I'm planning on changing that significantly in rewriting these.