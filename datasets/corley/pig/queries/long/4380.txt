The current ruby UDF implementation does a lot of conversion from java types to native ruby types. While this makes it easy to write and test UDFs in plain ruby without any Pig dependencies, the performance leaves something to be desired. There should be a jruby-specific implementation that uses the java types without conversion.