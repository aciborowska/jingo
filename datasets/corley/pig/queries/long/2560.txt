getHadoopStats() returns the counters object which is never set. This appears to be due to the addition of Counters counters = null; at the start of the addCounters(..) method and the lack of this.counter syntax below it.