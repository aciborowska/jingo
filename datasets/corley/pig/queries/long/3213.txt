It seems like we shouldn't need to duplicate the existing TFile code since it's already in Hadoop (in Hadoop 2, it's in hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/io/file/tfile/TFile.java; in Hadoop 1, it's in src/core/org/apache/hadoop/io/file/tfile/TFile.java).