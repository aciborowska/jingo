New logical plan fails when I have complex data types from udf