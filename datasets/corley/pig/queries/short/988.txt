Better implementation of distinct aggs