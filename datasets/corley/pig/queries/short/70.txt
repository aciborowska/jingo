Improve PigContext code by using Factory Pattern