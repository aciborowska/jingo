LogicalPlan and Optimizer are too complex and hard to work with