Refactor SparkLauncher for spark engine