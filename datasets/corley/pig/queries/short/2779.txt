Refactoring the code for setting number of reducers