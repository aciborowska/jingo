Case expression fails with an even number of when branches