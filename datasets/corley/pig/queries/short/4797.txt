Optimization for join/group case for spark mode