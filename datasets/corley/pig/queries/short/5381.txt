Extra foreach in nested-foreach preventing Accumulator usage