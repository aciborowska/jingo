implement typechecking and lineage tracking on new logical plan