exception is thrown when there is bincond in foreach after group by