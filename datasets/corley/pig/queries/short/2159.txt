New logical plan uses incorrect class for  SUM causing for ClassCastException