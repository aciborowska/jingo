Make combiners, custom partitioners and secondary key sort work for multiple outputs