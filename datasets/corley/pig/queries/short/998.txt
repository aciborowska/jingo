revisit frontend logic and pig-latin semantics