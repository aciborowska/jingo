[zebra] Data sanity check should be performed at the end  of writing instead of later at query time