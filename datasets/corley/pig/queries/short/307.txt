flatten logic assumes that anything to be flattened is a bag, when it could be a tuple.