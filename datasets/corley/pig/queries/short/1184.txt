PruneColumns optimization does not handle the case of foreach flatten correctly if flattened bag is not used later