Nested foreach returns the wrong schema when using renaming relation