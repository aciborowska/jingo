Inconsistent behaviour of FilterFunc UDF when used in the Filter and ForEach statements