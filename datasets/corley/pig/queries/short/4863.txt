Re-design Spark plan to optimize the RDD pipeline