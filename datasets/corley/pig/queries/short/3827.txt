Custom partitioner is not picked up with secondary sort optimization