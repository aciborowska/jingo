New logical plan: self-join fail for some queries