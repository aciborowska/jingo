Refactor PPNL for non-MR execution engine