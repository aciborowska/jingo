Optimizer throw error on self-joins