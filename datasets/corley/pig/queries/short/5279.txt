Bytecode generation optimizer in MR and Spark mode