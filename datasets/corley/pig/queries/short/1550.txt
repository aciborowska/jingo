better error handling in casting relations to scalars