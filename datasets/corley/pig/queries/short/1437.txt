[Optimization] Rewrite GroupBy-Foreach-flatten(group) to Distinct