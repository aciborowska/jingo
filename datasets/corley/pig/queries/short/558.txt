Distinct followed by a Join results in Invalid size 0 for a tuple error