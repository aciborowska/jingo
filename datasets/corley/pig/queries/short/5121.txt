Backport PIG-4916, PIG-4921 and PIG-4957 to 0.16 branch