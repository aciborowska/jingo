Limit produce wrong number of records after foreach flatten