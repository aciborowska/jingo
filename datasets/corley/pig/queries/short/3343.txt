Refactor DataType.compare api to handle NULLs and reflection