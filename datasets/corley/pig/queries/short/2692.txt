Make the Pig unit faciliities more generalizable and update javadocs