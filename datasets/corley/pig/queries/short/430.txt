Projections in nested filter and inside foreach do not work