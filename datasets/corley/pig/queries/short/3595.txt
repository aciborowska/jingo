Port Package refactoring to Tez branch