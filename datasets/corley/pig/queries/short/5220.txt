Improve NestedLimitOptimizer to handle general limit push up