Expressions in foreach lead to errors