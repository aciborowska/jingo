Pipeline optimization for multiple reduces