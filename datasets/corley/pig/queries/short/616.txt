Casts to complex types do not work as expected