Refactor Pig's logical plan to be immutable